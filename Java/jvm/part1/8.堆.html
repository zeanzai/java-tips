<!DOCTYPE html>
<html lang="zh-CN" data-theme="light">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <meta name="generator" content="VuePress 2.0.0-beta.61" />
    <meta name="theme" content="VuePress Theme Hope" />
    <meta property="og:url" content="https://zeanzai.github.io/java-tips/java-tips/Java/jvm/part1/8.%E5%A0%86.html"><meta property="og:site_name" content="java-tips"><meta property="og:title" content="å †"><meta property="og:description" content="[toc] è®¤è¯†å †å†…å­˜ ä¸€ä¸ªè¿›ç¨‹å¯¹åº”ä¸€ä¸ªJVMå®ä¾‹; ä¸€ä¸ªJVMå®ä¾‹å¯¹åº”ä¸€ä¸ªå †ç©ºé—´; è¿›ç¨‹åŒ…å«å¤šä¸ªçº¿ç¨‹ï¼Œæ‰€ä»¥çº¿ç¨‹ä¹‹é—´å…±äº«åŒä¸€ä¸ªå †ç©ºé—´; image ä¸€ä¸ªJVMå®ä¾‹åªå­˜åœ¨ä¸€ä¸ªå †å†…å­˜ï¼Œå †ä¹Ÿæ˜¯Javaå†…å­˜ç®¡ç†çš„æ ¸å¿ƒåŒºåŸŸã€‚; Javaå †åŒºåœ¨JVMå¯åŠ¨çš„æ—¶å€™å³è¢«åˆ›å»ºï¼Œå…¶ç©ºé—´å¤§å°ä¹Ÿå°±ç¡®å®šäº†ï¼Œå †æ˜¯JVMç®¡ç†çš„æœ€å¤§ä¸€å—å†…å­˜ç©ºé—´ã€‚; å †å†…å­˜çš„å¤§å°æ˜¯å¯ä»¥è°ƒèŠ‚çš„ã€‚; ã€ŠJa..."><meta property="og:type" content="article"><meta property="og:image" content="https://zeanzai.github.io/java-tips/java-tips/"><meta property="og:locale" content="zh-CN"><meta property="og:updated_time" content="2024-09-02T00:27:02.000Z"><meta name="twitter:card" content="summary_large_image"><meta name="twitter:image:alt" content="å †"><meta property="article:author" content="zeanzai"><meta property="article:tag" content="JVMä¸Šç¯‡"><meta property="article:modified_time" content="2024-09-02T00:27:02.000Z"><script type="application/ld+json">{"@context":"https://schema.org","@type":"Article","headline":"å †","image":["https://zeanzai.github.io/java-tips/java-tips/"],"dateModified":"2024-09-02T00:27:02.000Z","author":[{"@type":"Person","name":"zeanzai","url":"https://github.com/zeanzai"}]}</script><link rel="manifest" href="/java-tips/manifest.webmanifest" crossorigin="use-credentials"><meta name="theme-color" content="#46bd87"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover"><title>å † | java-tips</title><meta name="description" content="[toc] è®¤è¯†å †å†…å­˜ ä¸€ä¸ªè¿›ç¨‹å¯¹åº”ä¸€ä¸ªJVMå®ä¾‹; ä¸€ä¸ªJVMå®ä¾‹å¯¹åº”ä¸€ä¸ªå †ç©ºé—´; è¿›ç¨‹åŒ…å«å¤šä¸ªçº¿ç¨‹ï¼Œæ‰€ä»¥çº¿ç¨‹ä¹‹é—´å…±äº«åŒä¸€ä¸ªå †ç©ºé—´; image ä¸€ä¸ªJVMå®ä¾‹åªå­˜åœ¨ä¸€ä¸ªå †å†…å­˜ï¼Œå †ä¹Ÿæ˜¯Javaå†…å­˜ç®¡ç†çš„æ ¸å¿ƒåŒºåŸŸã€‚; Javaå †åŒºåœ¨JVMå¯åŠ¨çš„æ—¶å€™å³è¢«åˆ›å»ºï¼Œå…¶ç©ºé—´å¤§å°ä¹Ÿå°±ç¡®å®šäº†ï¼Œå †æ˜¯JVMç®¡ç†çš„æœ€å¤§ä¸€å—å†…å­˜ç©ºé—´ã€‚; å †å†…å­˜çš„å¤§å°æ˜¯å¯ä»¥è°ƒèŠ‚çš„ã€‚; ã€ŠJa...">
    <style>
      :root {
        --bg-color: #fff;
      }

      html[data-theme="dark"] {
        --bg-color: #1d1e1f;
      }

      html,
      body {
        background: var(--bg-color);
      }
    </style>
    <script>
      const userMode = localStorage.getItem("vuepress-theme-hope-scheme");
      const systemDarkMode =
        window.matchMedia &&
        window.matchMedia("(prefers-color-scheme: dark)").matches;

      if (userMode === "dark" || (userMode !== "light" && systemDarkMode)) {
        document.documentElement.setAttribute("data-theme", "dark");
      }
    </script>
    <link rel="preload" href="/java-tips/assets/style-9c23f834.css" as="style"><link rel="stylesheet" href="/java-tips/assets/style-9c23f834.css">
    <link rel="modulepreload" href="/java-tips/assets/app-67da51a1.js"><link rel="modulepreload" href="/java-tips/assets/framework-c8643d23.js"><link rel="modulepreload" href="/java-tips/assets/8.å †.html-e9b6ffdb.js"><link rel="modulepreload" href="/java-tips/assets/8.å †.html-1e5e4dcb.js">
  </head>
  <body>
    <div id="app"><!--[--><!--[--><!--[--><span tabindex="-1"></span><a href="#main-content" class="skip-link sr-only">è·³è‡³ä¸»è¦å…§å®¹</a><!--]--><div class="theme-container no-sidebar has-toc"><!--[--><header class="navbar" id="navbar"><div class="navbar-start"><button type="button" class="toggle-sidebar-button" title="Toggle Sidebar"><span class="icon"></span></button><!--[--><!----><!--]--><a href="/java-tips/" class="brand"><img class="logo" src="/java-tips/logo.svg" alt="java-tips"><!----><span class="site-name hide-in-pad">java-tips</span></a><!--[--><!----><!--]--></div><div class="navbar-center"><!--[--><!----><!--]--><nav class="nav-links"><div class="nav-item hide-in-mobile"><a href="/java-tips/" class="nav-link" aria-label="ä¸»é¡µ"><span class="font-icon icon iconfont icon-home" style=""></span>ä¸»é¡µ<!----></a></div><div class="nav-item hide-in-mobile"><a href="/java-tips/intro/" class="nav-link" aria-label="å¯¼è¯»"><span class="font-icon icon iconfont icon-discover" style=""></span>å¯¼è¯»<!----></a></div><div class="nav-item hide-in-mobile"><a href="/java-tips/docs/" class="nav-link" aria-label="ä»“åº“"><span class="font-icon icon iconfont icon-discover" style=""></span>ä»“åº“<!----></a></div><div class="nav-item hide-in-mobile"><a href="/java-tips/notes/" class="nav-link" aria-label="ç¬”è®°"><span class="font-icon icon iconfont icon-discover" style=""></span>ç¬”è®°<!----></a></div><div class="nav-item hide-in-mobile"><a href="https://github.com/zeanzai/java-tips/issues" rel="noopener noreferrer" target="_blank" aria-label="é—®é¢˜åé¦ˆ" class="nav-link"><span class="font-icon icon iconfont icon-note" style=""></span>é—®é¢˜åé¦ˆ<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!----></a></div></nav><!--[--><!----><!--]--></div><div class="navbar-end"><!--[--><!----><!--]--><!----><div class="nav-item"><a class="repo-link" href="https://github.com/zeanzai/java-tips" target="_blank" rel="noopener noreferrer" aria-label="GitHub"><svg xmlns="http://www.w3.org/2000/svg" class="icon github-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="github icon" style="width:1.25rem;height:1.25rem;vertical-align:middle;"><path d="M511.957 21.333C241.024 21.333 21.333 240.981 21.333 512c0 216.832 140.544 400.725 335.574 465.664 24.49 4.395 32.256-10.07 32.256-23.083 0-11.69.256-44.245 0-85.205-136.448 29.61-164.736-64.64-164.736-64.64-22.315-56.704-54.4-71.765-54.4-71.765-44.587-30.464 3.285-29.824 3.285-29.824 49.195 3.413 75.179 50.517 75.179 50.517 43.776 75.008 114.816 53.333 142.762 40.79 4.523-31.66 17.152-53.377 31.19-65.537-108.971-12.458-223.488-54.485-223.488-242.602 0-53.547 19.114-97.323 50.517-131.67-5.035-12.33-21.93-62.293 4.779-129.834 0 0 41.258-13.184 134.912 50.346a469.803 469.803 0 0 1 122.88-16.554c41.642.213 83.626 5.632 122.88 16.554 93.653-63.488 134.784-50.346 134.784-50.346 26.752 67.541 9.898 117.504 4.864 129.834 31.402 34.347 50.474 78.123 50.474 131.67 0 188.586-114.73 230.016-224.042 242.09 17.578 15.232 33.578 44.672 33.578 90.454v135.85c0 13.142 7.936 27.606 32.854 22.87C862.25 912.597 1002.667 728.747 1002.667 512c0-271.019-219.648-490.667-490.71-490.667z"></path></svg></a></div><div class="nav-item hide-in-mobile"><button type="button" id="appearance-switch"><svg xmlns="http://www.w3.org/2000/svg" class="icon auto-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="auto icon" style="display:block;"><path d="M512 992C246.92 992 32 777.08 32 512S246.92 32 512 32s480 214.92 480 480-214.92 480-480 480zm0-840c-198.78 0-360 161.22-360 360 0 198.84 161.22 360 360 360s360-161.16 360-360c0-198.78-161.22-360-360-360zm0 660V212c165.72 0 300 134.34 300 300 0 165.72-134.28 300-300 300z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" class="icon dark-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="dark icon" style="display:none;"><path d="M524.8 938.667h-4.267a439.893 439.893 0 0 1-313.173-134.4 446.293 446.293 0 0 1-11.093-597.334A432.213 432.213 0 0 1 366.933 90.027a42.667 42.667 0 0 1 45.227 9.386 42.667 42.667 0 0 1 10.24 42.667 358.4 358.4 0 0 0 82.773 375.893 361.387 361.387 0 0 0 376.747 82.774 42.667 42.667 0 0 1 54.187 55.04 433.493 433.493 0 0 1-99.84 154.88 438.613 438.613 0 0 1-311.467 128z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" class="icon light-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="light icon" style="display:none;"><path d="M952 552h-80a40 40 0 0 1 0-80h80a40 40 0 0 1 0 80zM801.88 280.08a41 41 0 0 1-57.96-57.96l57.96-58a41.04 41.04 0 0 1 58 58l-58 57.96zM512 752a240 240 0 1 1 0-480 240 240 0 0 1 0 480zm0-560a40 40 0 0 1-40-40V72a40 40 0 0 1 80 0v80a40 40 0 0 1-40 40zm-289.88 88.08-58-57.96a41.04 41.04 0 0 1 58-58l57.96 58a41 41 0 0 1-57.96 57.96zM192 512a40 40 0 0 1-40 40H72a40 40 0 0 1 0-80h80a40 40 0 0 1 40 40zm30.12 231.92a41 41 0 0 1 57.96 57.96l-57.96 58a41.04 41.04 0 0 1-58-58l58-57.96zM512 832a40 40 0 0 1 40 40v80a40 40 0 0 1-80 0v-80a40 40 0 0 1 40-40zm289.88-88.08 58 57.96a41.04 41.04 0 0 1-58 58l-57.96-58a41 41 0 0 1 57.96-57.96z"></path></svg></button></div><!--[--><button type="button" class="search-pro-button" role="search" aria-label="æœç´¢"><svg xmlns="http://www.w3.org/2000/svg" class="icon search-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="search icon"><path d="M192 480a256 256 0 1 1 512 0 256 256 0 0 1-512 0m631.776 362.496-143.2-143.168A318.464 318.464 0 0 0 768 480c0-176.736-143.264-320-320-320S128 303.264 128 480s143.264 320 320 320a318.016 318.016 0 0 0 184.16-58.592l146.336 146.368c12.512 12.48 32.768 12.48 45.28 0 12.48-12.512 12.48-32.768 0-45.28"></path></svg><div class="placeholder">æœç´¢</div><div class="key-hints"><kbd class="key">Ctrl</kbd><kbd class="key">K</kbd></div></button><!--]--><!--[--><!----><!--]--><button type="button" class="toggle-navbar-button" aria-label="Toggle Navbar" aria-expanded="false" aria-controls="nav-screen"><span class="button-container"><span class="button-top"></span><span class="button-middle"></span><span class="button-bottom"></span></span></button></div></header><!----><!--]--><!----><div class="toggle-sidebar-wrapper"><span class="arrow start"></span></div><aside class="sidebar" id="sidebar"><!--[--><!----><!--]--><ul class="sidebar-links"></ul><!--[--><!----><!--]--></aside><!--[--><main class="page" id="main-content"><!--[--><!----><nav class="breadcrumb disable"></nav><div class="page-title"><h1><!---->å †</h1><div class="page-info"><span class="page-author-info" aria-label="ä½œè€…ğŸ–Š" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon author-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="author icon"><path d="M649.6 633.6c86.4-48 147.2-144 147.2-249.6 0-160-128-288-288-288s-288 128-288 288c0 108.8 57.6 201.6 147.2 249.6-121.6 48-214.4 153.6-240 288-3.2 9.6 0 19.2 6.4 25.6 3.2 9.6 12.8 12.8 22.4 12.8h704c9.6 0 19.2-3.2 25.6-12.8 6.4-6.4 9.6-16 6.4-25.6-25.6-134.4-121.6-240-243.2-288z"></path></svg><span><a class="page-author-item" href="https://github.com/zeanzai" target="_blank" rel="noopener noreferrer">zeanzai</a></span><span property="author" content="zeanzai"></span></span><!----><span class="page-date-info" aria-label="å†™ä½œæ—¥æœŸğŸ“…" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon calendar-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="calendar icon"><path d="M716.4 110.137c0-18.753-14.72-33.473-33.472-33.473-18.753 0-33.473 14.72-33.473 33.473v33.473h66.993v-33.473zm-334.87 0c0-18.753-14.72-33.473-33.473-33.473s-33.52 14.72-33.52 33.473v33.473h66.993v-33.473zm468.81 33.52H716.4v100.465c0 18.753-14.72 33.473-33.472 33.473a33.145 33.145 0 01-33.473-33.473V143.657H381.53v100.465c0 18.753-14.72 33.473-33.473 33.473a33.145 33.145 0 01-33.473-33.473V143.657H180.6A134.314 134.314 0 0046.66 277.595v535.756A134.314 134.314 0 00180.6 947.289h669.74a134.36 134.36 0 00133.94-133.938V277.595a134.314 134.314 0 00-133.94-133.938zm33.473 267.877H147.126a33.145 33.145 0 01-33.473-33.473c0-18.752 14.72-33.473 33.473-33.473h736.687c18.752 0 33.472 14.72 33.472 33.473a33.145 33.145 0 01-33.472 33.473z"></path></svg><span><!----></span><meta property="datePublished" content="2024-09-02T00:27:02.000Z"></span><span class="page-pageview-info" aria-label="è®¿é—®é‡ğŸ”¢" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon eye-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="eye icon"><path d="M992 512.096c0-5.76-.992-10.592-1.28-11.136-.192-2.88-1.152-8.064-2.08-10.816-.256-.672-.544-1.376-.832-2.08-.48-1.568-1.024-3.104-1.6-4.32C897.664 290.112 707.104 160 512 160c-195.072 0-385.632 130.016-473.76 322.592-1.056 2.112-1.792 4.096-2.272 5.856a55.512 55.512 0 00-.64 1.6c-1.76 5.088-1.792 8.64-1.632 7.744-.832 3.744-1.568 11.168-1.568 11.168-.224 2.272-.224 4.032.032 6.304 0 0 .736 6.464 1.088 7.808.128 1.824.576 4.512 1.12 6.976h-.032c.448 2.08 1.12 4.096 1.984 6.08.48 1.536.992 2.976 1.472 4.032C126.432 733.856 316.992 864 512 864c195.136 0 385.696-130.048 473.216-321.696 1.376-2.496 2.24-4.832 2.848-6.912.256-.608.48-1.184.672-1.728 1.536-4.48 1.856-8.32 1.728-8.32l-.032.032c.608-3.104 1.568-7.744 1.568-13.28zM512 672c-88.224 0-160-71.776-160-160s71.776-160 160-160 160 71.776 160 160-71.776 160-160 160z"></path></svg><span class="waline-pageview-count" id="ArtalkPV" data-path="/java-tips/Java/jvm/part1/8.%E5%A0%86.html">...</span></span><span class="page-reading-time-info" aria-label="é˜…è¯»æ—¶é—´âŒ›" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon timer-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="timer icon"><path d="M799.387 122.15c4.402-2.978 7.38-7.897 7.38-13.463v-1.165c0-8.933-7.38-16.312-16.312-16.312H256.33c-8.933 0-16.311 7.38-16.311 16.312v1.165c0 5.825 2.977 10.874 7.637 13.592 4.143 194.44 97.22 354.963 220.201 392.763-122.204 37.542-214.893 196.511-220.2 389.397-4.661 5.049-7.638 11.651-7.638 19.03v5.825h566.49v-5.825c0-7.379-2.849-13.981-7.509-18.9-5.049-193.016-97.867-351.985-220.2-389.527 123.24-37.67 216.446-198.453 220.588-392.892zM531.16 450.445v352.632c117.674 1.553 211.787 40.778 211.787 88.676H304.097c0-48.286 95.149-87.382 213.728-88.676V450.445c-93.077-3.107-167.901-81.297-167.901-177.093 0-8.803 6.99-15.793 15.793-15.793 8.803 0 15.794 6.99 15.794 15.793 0 80.261 63.69 145.635 142.01 145.635s142.011-65.374 142.011-145.635c0-8.803 6.99-15.793 15.794-15.793s15.793 6.99 15.793 15.793c0 95.019-73.789 172.82-165.96 177.093z"></path></svg><span>å¤§çº¦ 36 åˆ†é’Ÿ</span><meta property="timeRequired" content="PT36M"></span><span class="page-category-info" aria-label="åˆ†ç±»ğŸŒˆ" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon category-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="category icon"><path d="M148.41 106.992h282.176c22.263 0 40.31 18.048 40.31 40.31V429.48c0 22.263-18.047 40.31-40.31 40.31H148.41c-22.263 0-40.311-18.047-40.311-40.31V147.302c0-22.263 18.048-40.31 40.311-40.31zM147.556 553.478H429.73c22.263 0 40.311 18.048 40.311 40.31v282.176c0 22.263-18.048 40.312-40.31 40.312H147.555c-22.263 0-40.311-18.049-40.311-40.312V593.79c0-22.263 18.048-40.311 40.31-40.311zM593.927 106.992h282.176c22.263 0 40.31 18.048 40.31 40.31V429.48c0 22.263-18.047 40.31-40.31 40.31H593.927c-22.263 0-40.311-18.047-40.311-40.31V147.302c0-22.263 18.048-40.31 40.31-40.31zM730.22 920.502H623.926c-40.925 0-74.22-33.388-74.22-74.425V623.992c0-41.038 33.387-74.424 74.425-74.424h222.085c41.038 0 74.424 33.226 74.424 74.067v114.233c0 10.244-8.304 18.548-18.547 18.548s-18.548-8.304-18.548-18.548V623.635c0-20.388-16.746-36.974-37.33-36.974H624.13c-20.585 0-37.331 16.747-37.331 37.33v222.086c0 20.585 16.654 37.331 37.126 37.331H730.22c10.243 0 18.547 8.304 18.547 18.547 0 10.244-8.304 18.547-18.547 18.547z"></path></svg><span class="page-category-item category1" role>JVM</span><meta property="articleSection" content="JVM"></span><span class="page-tag-info" aria-label="æ ‡ç­¾ğŸ·" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon tag-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="tag icon"><path d="M939.902 458.563L910.17 144.567c-1.507-16.272-14.465-29.13-30.737-30.737L565.438 84.098h-.402c-3.215 0-5.726 1.005-7.634 2.913l-470.39 470.39a10.004 10.004 0 000 14.164l365.423 365.424c1.909 1.908 4.42 2.913 7.132 2.913s5.223-1.005 7.132-2.913l470.39-470.39c2.01-2.11 3.014-5.023 2.813-8.036zm-240.067-72.121c-35.458 0-64.286-28.828-64.286-64.286s28.828-64.285 64.286-64.285 64.286 28.828 64.286 64.285-28.829 64.286-64.286 64.286z"></path></svg><span class="page-tag-item tag7" role>JVMä¸Šç¯‡</span><meta property="keywords" content="JVMä¸Šç¯‡"></span></div><hr></div><div class="toc-place-holder"><aside id="toc"><!--[--><!----><!--]--><div class="toc-header">æ­¤é¡µå†…å®¹<button type="button" class="print-button" title="æ‰“å°"><svg xmlns="http://www.w3.org/2000/svg" class="icon print-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="print icon"><path d="M819.2 364.8h-44.8V128c0-17.067-14.933-32-32-32H281.6c-17.067 0-32 14.933-32 32v236.8h-44.8C145.067 364.8 96 413.867 96 473.6v192c0 59.733 49.067 108.8 108.8 108.8h44.8V896c0 17.067 14.933 32 32 32h460.8c17.067 0 32-14.933 32-32V774.4h44.8c59.733 0 108.8-49.067 108.8-108.8v-192c0-59.733-49.067-108.8-108.8-108.8zM313.6 160h396.8v204.8H313.6V160zm396.8 704H313.6V620.8h396.8V864zM864 665.6c0 25.6-19.2 44.8-44.8 44.8h-44.8V588.8c0-17.067-14.933-32-32-32H281.6c-17.067 0-32 14.933-32 32v121.6h-44.8c-25.6 0-44.8-19.2-44.8-44.8v-192c0-25.6 19.2-44.8 44.8-44.8h614.4c25.6 0 44.8 19.2 44.8 44.8v192z"></path></svg></button></div><div class="toc-wrapper"><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/java-tips/Java/jvm/part1/8.%E5%A0%86.html#è®¤è¯†å †å†…å­˜" class="router-link-active router-link-exact-active toc-link level2">è®¤è¯†å †å†…å­˜</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/java-tips/Java/jvm/part1/8.%E5%A0%86.html#ä»£ç ç¤ºä¾‹" class="router-link-active router-link-exact-active toc-link level2">ä»£ç ç¤ºä¾‹</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/java-tips/Java/jvm/part1/8.%E5%A0%86.html#æŸ¥çœ‹å †å†…å­˜" class="router-link-active router-link-exact-active toc-link level2">æŸ¥çœ‹å †å†…å­˜</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/java-tips/Java/jvm/part1/8.%E5%A0%86.html#å †å†…å­˜åˆ†åŒº" class="router-link-active router-link-exact-active toc-link level2">å †å†…å­˜åˆ†åŒº</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/java-tips/Java/jvm/part1/8.%E5%A0%86.html#è®¾ç½®å †ç©ºé—´å¤§å°" class="router-link-active router-link-exact-active toc-link level2">è®¾ç½®å †ç©ºé—´å¤§å°</a></li><li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/java-tips/Java/jvm/part1/8.%E5%A0%86.html#å¦‚ä½•éªŒè¯" class="router-link-active router-link-exact-active toc-link level3">å¦‚ä½•éªŒè¯ï¼Ÿ</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/java-tips/Java/jvm/part1/8.%E5%A0%86.html#oomä¸¾ä¾‹" class="router-link-active router-link-exact-active toc-link level2">OOMä¸¾ä¾‹</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/java-tips/Java/jvm/part1/8.%E5%A0%86.html#é…ç½®æ–°è€æ¯”ä¾‹" class="router-link-active router-link-exact-active toc-link level2">é…ç½®æ–°è€æ¯”ä¾‹</a></li><li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/java-tips/Java/jvm/part1/8.%E5%A0%86.html#æ–°ç”ŸåŒºä¸­çš„æ¯”ä¾‹" class="router-link-active router-link-exact-active toc-link level3">æ–°ç”ŸåŒºä¸­çš„æ¯”ä¾‹</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/java-tips/Java/jvm/part1/8.%E5%A0%86.html#æ¦‚è¿°" class="router-link-active router-link-exact-active toc-link level2">æ¦‚è¿°</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/java-tips/Java/jvm/part1/8.%E5%A0%86.html#å›¾è§£å¯¹è±¡åˆ†é…-é‡è¦" class="router-link-active router-link-exact-active toc-link level2">å›¾è§£å¯¹è±¡åˆ†é…(é‡è¦)</a></li><li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/java-tips/Java/jvm/part1/8.%E5%A0%86.html#åˆ†è§£" class="router-link-active router-link-exact-active toc-link level3">åˆ†è§£</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/java-tips/Java/jvm/part1/8.%E5%A0%86.html#ç‰¹æ®Šæƒ…å†µè¯´æ˜" class="router-link-active router-link-exact-active toc-link level3">ç‰¹æ®Šæƒ…å†µè¯´æ˜</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/java-tips/Java/jvm/part1/8.%E5%A0%86.html#jvmå¸¸ç”¨è°ƒä¼˜å·¥å…·" class="router-link-active router-link-exact-active toc-link level3">JVMå¸¸ç”¨è°ƒä¼˜å·¥å…·</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/java-tips/Java/jvm/part1/8.%E5%A0%86.html#æ€»ç»“" class="router-link-active router-link-exact-active toc-link level3">æ€»ç»“</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/java-tips/Java/jvm/part1/8.%E5%A0%86.html#åˆ†ä»£æ”¶é›†æ€æƒ³-é¢è¯•å¿…é—®" class="router-link-active router-link-exact-active toc-link level2">åˆ†ä»£æ”¶é›†æ€æƒ³(é¢è¯•å¿…é—®)</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/java-tips/Java/jvm/part1/8.%E5%A0%86.html#young-minor-gc" class="router-link-active router-link-exact-active toc-link level2">Young/Minor GC</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/java-tips/Java/jvm/part1/8.%E5%A0%86.html#major-gc" class="router-link-active router-link-exact-active toc-link level2">Major GC</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/java-tips/Java/jvm/part1/8.%E5%A0%86.html#full-gc" class="router-link-active router-link-exact-active toc-link level2">Full GC</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/java-tips/Java/jvm/part1/8.%E5%A0%86.html#gc-æ—¥å¿—åˆ†æ" class="router-link-active router-link-exact-active toc-link level2">GC æ—¥å¿—åˆ†æ</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/java-tips/Java/jvm/part1/8.%E5%A0%86.html#ä¸ºä»€ä¹ˆæœ‰-tlab" class="router-link-active router-link-exact-active toc-link level2">ä¸ºä»€ä¹ˆæœ‰ TLAB</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/java-tips/Java/jvm/part1/8.%E5%A0%86.html#ä»€ä¹ˆæ˜¯-tlab" class="router-link-active router-link-exact-active toc-link level2">ä»€ä¹ˆæ˜¯ TLAB</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/java-tips/Java/jvm/part1/8.%E5%A0%86.html#tlab-åˆ†é…è¿‡ç¨‹" class="router-link-active router-link-exact-active toc-link level2">TLAB åˆ†é…è¿‡ç¨‹</a></li><li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/java-tips/Java/jvm/part1/8.%E5%A0%86.html#æµ‹è¯•æ˜¯å¦æ˜¯é¦–é€‰" class="router-link-active router-link-exact-active toc-link level3">æµ‹è¯•æ˜¯å¦æ˜¯é¦–é€‰</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/java-tips/Java/jvm/part1/8.%E5%A0%86.html#è¿‡ç¨‹è¯¦è§£" class="router-link-active router-link-exact-active toc-link level3">è¿‡ç¨‹è¯¦è§£</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/java-tips/Java/jvm/part1/8.%E5%A0%86.html#å¸¸ç”¨å‚æ•°è®¾ç½®" class="router-link-active router-link-exact-active toc-link level2">å¸¸ç”¨å‚æ•°è®¾ç½®</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/java-tips/Java/jvm/part1/8.%E5%A0%86.html#ç©ºé—´åˆ†é…æ‹…ä¿" class="router-link-active router-link-exact-active toc-link level2">ç©ºé—´åˆ†é…æ‹…ä¿</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/java-tips/Java/jvm/part1/8.%E5%A0%86.html#å †æ˜¯åˆ†é…å¯¹è±¡å­˜å‚¨çš„å”¯ä¸€é€‰æ‹©å—" class="router-link-active router-link-exact-active toc-link level2">å †æ˜¯åˆ†é…å¯¹è±¡å­˜å‚¨çš„å”¯ä¸€é€‰æ‹©å—ï¼Ÿ</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/java-tips/Java/jvm/part1/8.%E5%A0%86.html#é€ƒé€¸åˆ†æ" class="router-link-active router-link-exact-active toc-link level2">é€ƒé€¸åˆ†æ</a></li><li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/java-tips/Java/jvm/part1/8.%E5%A0%86.html#ä¸¾ä¾‹è¯´æ˜" class="router-link-active router-link-exact-active toc-link level3">ä¸¾ä¾‹è¯´æ˜</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/java-tips/Java/jvm/part1/8.%E5%A0%86.html#å‚æ•°è®¾ç½®" class="router-link-active router-link-exact-active toc-link level3">å‚æ•°è®¾ç½®</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/java-tips/Java/jvm/part1/8.%E5%A0%86.html#ç»“è®º" class="router-link-active router-link-exact-active toc-link level3">ç»“è®º</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/java-tips/Java/jvm/part1/8.%E5%A0%86.html#ä»£ç ä¼˜åŒ–" class="router-link-active router-link-exact-active toc-link level3">ä»£ç ä¼˜åŒ–</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/java-tips/Java/jvm/part1/8.%E5%A0%86.html#æ ˆä¸Šåˆ†é…" class="router-link-active router-link-exact-active toc-link level2">æ ˆä¸Šåˆ†é…</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/java-tips/Java/jvm/part1/8.%E5%A0%86.html#åŒæ­¥çœç•¥" class="router-link-active router-link-exact-active toc-link level2">åŒæ­¥çœç•¥</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/java-tips/Java/jvm/part1/8.%E5%A0%86.html#åˆ†ç¦»å¯¹è±¡æˆ–æ ‡é‡æ›¿æ¢" class="router-link-active router-link-exact-active toc-link level2">åˆ†ç¦»å¯¹è±¡æˆ–æ ‡é‡æ›¿æ¢</a></li><li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/java-tips/Java/jvm/part1/8.%E5%A0%86.html#é€ƒé€¸åˆ†æå‚æ•°è®¾ç½®æ€»ç»“" class="router-link-active router-link-exact-active toc-link level3">é€ƒé€¸åˆ†æå‚æ•°è®¾ç½®æ€»ç»“</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/java-tips/Java/jvm/part1/8.%E5%A0%86.html#é€ƒé€¸åˆ†æçš„ä¸è¶³" class="router-link-active router-link-exact-active toc-link level3">é€ƒé€¸åˆ†æçš„ä¸è¶³</a></li><!----><!--]--></ul></li><!--]--></ul></div><!--[--><!----><!--]--></aside></div><!----><div class="theme-hope-content"><p>[toc]</p><h1 id="å †çš„æ ¸å¿ƒæ¦‚è¿°" tabindex="-1"><a class="header-anchor" href="#å †çš„æ ¸å¿ƒæ¦‚è¿°" aria-hidden="true">#</a> å †çš„æ ¸å¿ƒæ¦‚è¿°</h1><h2 id="è®¤è¯†å †å†…å­˜" tabindex="-1"><a class="header-anchor" href="#è®¤è¯†å †å†…å­˜" aria-hidden="true">#</a> è®¤è¯†å †å†…å­˜</h2><ul><li>ä¸€ä¸ªè¿›ç¨‹å¯¹åº”ä¸€ä¸ªJVMå®ä¾‹</li><li>ä¸€ä¸ªJVMå®ä¾‹å¯¹åº”ä¸€ä¸ªå †ç©ºé—´</li><li>è¿›ç¨‹åŒ…å«å¤šä¸ªçº¿ç¨‹ï¼Œæ‰€ä»¥çº¿ç¨‹ä¹‹é—´å…±äº«åŒä¸€ä¸ªå †ç©ºé—´</li></ul><figure><img src="/java-tips/assets/5xuChryJu80-Tkpdbi27ng63nUeL8pXiawMLcxKCII8-27fc678d.webp" alt="image" tabindex="0" loading="lazy"><figcaption>image</figcaption></figure><ul><li>ä¸€ä¸ªJVMå®ä¾‹åªå­˜åœ¨ä¸€ä¸ªå †å†…å­˜ï¼Œå †ä¹Ÿæ˜¯Javaå†…å­˜ç®¡ç†çš„æ ¸å¿ƒåŒºåŸŸã€‚</li><li>Javaå †åŒº<strong>åœ¨JVMå¯åŠ¨çš„æ—¶å€™å³è¢«åˆ›å»º</strong>ï¼Œå…¶ç©ºé—´å¤§å°ä¹Ÿå°±ç¡®å®šäº†ï¼Œ<code>å †æ˜¯JVMç®¡ç†çš„æœ€å¤§ä¸€å—å†…å­˜ç©ºé—´</code>ã€‚ <ul><li><strong>å †å†…å­˜çš„å¤§å°æ˜¯å¯ä»¥è°ƒèŠ‚çš„</strong>ã€‚</li></ul></li><li>ã€ŠJavaè™šæ‹Ÿæœºè§„èŒƒã€‹è§„å®šï¼Œ<strong>å †å¯ä»¥å¤„äºç‰©ç†ä¸Šä¸è¿ç»­çš„å†…å­˜ç©ºé—´ä¸­ï¼Œä½†åœ¨é€»è¾‘ä¸Šå®ƒåº”è¯¥è¢«è§†ä¸ºè¿ç»­çš„</strong>ã€‚</li><li>æ‰€æœ‰çš„çº¿ç¨‹å…±äº«Javaå †ï¼Œåœ¨è¿™é‡Œè¿˜å¯ä»¥åˆ’åˆ†<strong>çº¿ç¨‹ç§æœ‰çš„ç¼“å†²åŒº</strong>ï¼ˆThread Local Allocation Bufferï¼ŒTLABï¼‰ã€‚</li><li>ã€ŠJavaè™šæ‹Ÿæœºè§„èŒƒã€‹ä¸­å¯¹Javaå †çš„æè¿°æ˜¯ï¼š<strong>æ‰€æœ‰çš„å¯¹è±¡å®ä¾‹ä»¥åŠæ•°ç»„éƒ½åº”å½“åœ¨è¿è¡Œæ—¶åˆ†é…åœ¨å †ä¸Š</strong>ã€‚ï¼ˆThe heap is the run-time data area from which memory for all class instances and arrays is allocatedï¼‰</li><li>ä»å®é™…ä½¿ç”¨è§’åº¦çœ‹çš„ï¼šâ€œå‡ ä¹â€æ‰€æœ‰çš„å¯¹è±¡å®ä¾‹éƒ½åœ¨è¿™é‡Œåˆ†é…å†…å­˜ã€‚å› ä¸ºè¿˜æœ‰ä¸€äº›å¯¹è±¡æ˜¯åœ¨æ ˆä¸Šåˆ†é…çš„ï¼ˆé€ƒé€¸åˆ†æï¼Œæ ‡é‡æ›¿æ¢ï¼‰</li><li>æ•°ç»„å’Œå¯¹è±¡å¯èƒ½æ°¸è¿œä¸ä¼šå­˜å‚¨åœ¨æ ˆä¸Šï¼Œå› ä¸ºæ ˆå¸§ä¸­ä¿å­˜å¼•ç”¨ï¼Œè¿™ä¸ªå¼•ç”¨æŒ‡å‘å¯¹è±¡æˆ–è€…æ•°ç»„åœ¨å †ä¸­çš„ä½ç½®ã€‚</li><li>åœ¨æ–¹æ³•ç»“æŸåï¼Œ<code>å †ä¸­çš„å¯¹è±¡ä¸ä¼šé©¬ä¸Šè¢«ç§»é™¤</code>ï¼Œä»…ä»…åœ¨åƒåœ¾æ”¶é›†çš„æ—¶å€™æ‰ä¼šè¢«ç§»é™¤ã€‚ <ul><li>ä¹Ÿå°±æ˜¯è§¦å‘äº†GCçš„æ—¶å€™ï¼Œæ‰ä¼šè¿›è¡Œå›æ”¶</li><li>å¦‚æœå †ä¸­å¯¹è±¡é©¬ä¸Šè¢«å›æ”¶ï¼Œé‚£ä¹ˆç”¨æˆ·çº¿ç¨‹å°±ä¼šæ”¶åˆ°å½±å“ï¼Œå› ä¸ºæœ‰ stop the word</li></ul></li><li><code>å †ï¼Œæ˜¯GCï¼ˆGarbage Collectionï¼Œåƒåœ¾æ”¶é›†å™¨ï¼‰æ‰§è¡Œåƒåœ¾å›æ”¶çš„é‡ç‚¹åŒºåŸŸ</code>ã€‚</li></ul><figure><img src="/java-tips/assets/HWKQ4tQz6gnsZPZ4RK449Y7D97KfYIr_6UhwQj5yPso-b195ded1.webp" alt="image" tabindex="0" loading="lazy"><figcaption>image</figcaption></figure><h2 id="ä»£ç ç¤ºä¾‹" tabindex="-1"><a class="header-anchor" href="#ä»£ç ç¤ºä¾‹" aria-hidden="true">#</a> ä»£ç ç¤ºä¾‹</h2><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">SimpleHeap</span> <span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token keyword">int</span> id<span class="token punctuation">;</span><span class="token comment">//å±æ€§ã€æˆå‘˜å˜é‡</span>

    <span class="token keyword">public</span> <span class="token class-name">SimpleHeap</span><span class="token punctuation">(</span><span class="token keyword">int</span> id<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>id <span class="token operator">=</span> id<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">show</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;My ID is &quot;</span> <span class="token operator">+</span> id<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">SimpleHeap</span> sl <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SimpleHeap</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">SimpleHeap</span> s2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SimpleHeap</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> arr <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token class-name">Object</span><span class="token punctuation">[</span><span class="token punctuation">]</span> arr1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Object</span><span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å¯¹åº”å…¶å­—èŠ‚ç ä¸ºï¼š</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code> <span class="token number">0</span> <span class="token keyword">new</span> #<span class="token number">11</span> <span class="token operator">&lt;</span>cn<span class="token operator">/</span>zhiyucs<span class="token operator">/</span>java<span class="token operator">/</span><span class="token class-name">SimpleHeap</span><span class="token operator">&gt;</span>
 <span class="token number">3</span> dup
 <span class="token number">4</span> iconst_1
 <span class="token number">5</span> invokespecial #<span class="token number">12</span> <span class="token operator">&lt;</span>cn<span class="token operator">/</span>zhiyucs<span class="token operator">/</span>java<span class="token operator">/</span><span class="token class-name">SimpleHeap</span><span class="token punctuation">.</span><span class="token generics"><span class="token punctuation">&lt;</span>init<span class="token punctuation">&gt;</span></span> <span class="token operator">:</span> <span class="token punctuation">(</span><span class="token class-name">I</span><span class="token punctuation">)</span><span class="token class-name">V</span><span class="token operator">&gt;</span>
 <span class="token number">8</span> astore_1
 <span class="token number">9</span> <span class="token keyword">new</span> #<span class="token number">11</span> <span class="token operator">&lt;</span>cn<span class="token operator">/</span>zhiyucs<span class="token operator">/</span>java<span class="token operator">/</span><span class="token class-name">SimpleHeap</span><span class="token operator">&gt;</span>
<span class="token number">12</span> dup
<span class="token number">13</span> iconst_2
<span class="token number">14</span> invokespecial #<span class="token number">12</span> <span class="token operator">&lt;</span>cn<span class="token operator">/</span>zhiyucs<span class="token operator">/</span>java<span class="token operator">/</span><span class="token class-name">SimpleHeap</span><span class="token punctuation">.</span><span class="token generics"><span class="token punctuation">&lt;</span>init<span class="token punctuation">&gt;</span></span> <span class="token operator">:</span> <span class="token punctuation">(</span><span class="token class-name">I</span><span class="token punctuation">)</span><span class="token class-name">V</span><span class="token operator">&gt;</span>
<span class="token number">17</span> astore_2
<span class="token number">18</span> bipush <span class="token number">10</span>
<span class="token number">20</span> newarray <span class="token number">10</span> <span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span>
<span class="token number">22</span> astore_3
<span class="token number">23</span> bipush <span class="token number">10</span>
<span class="token number">25</span> anewarray #<span class="token number">13</span> <span class="token operator">&lt;</span>java<span class="token operator">/</span>lang<span class="token operator">/</span><span class="token class-name">Object</span><span class="token operator">&gt;</span>
<span class="token number">28</span> astore <span class="token number">4</span>
<span class="token number">30</span> retur
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><blockquote><p>ä¸€ä¸ªJVMå®ä¾‹åªå­˜åœ¨ä¸€ä¸ªå †å†…å­˜ï¼Œå¹¶ä¸”å †å†…å­˜çš„å¤§å°æ˜¯å¯ä»¥è°ƒèŠ‚çš„</p></blockquote><p>ç¤ºä¾‹2ï¼š</p><p>Demoçš„VMé€‰é¡¹ä¸ºï¼š-Xms10m -Xmx10m</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">HeapDemo</span> <span class="token punctuation">{</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;start....&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            <span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">1000000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">InterruptedException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;end...&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Demo1çš„VMå‚æ•°ä¸ºï¼š-Xms20m -Xmx20m</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">HeapDemo1</span> <span class="token punctuation">{</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;start....&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            <span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">1000000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">InterruptedException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;end...&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="æŸ¥çœ‹å †å†…å­˜" tabindex="-1"><a class="header-anchor" href="#æŸ¥çœ‹å †å†…å­˜" aria-hidden="true">#</a> æŸ¥çœ‹å †å†…å­˜</h2><p>åœ¨JDKæ–‡ä»¶Binå†…ï¼šæ‰“å¼€jvisualvm.exe</p><p>åˆæ¬¡ä½¿ç”¨æ²¡æœ‰GCæŸ¥çœ‹å™¨ï¼Œæ‰€ä»¥å¯ä»¥ç‚¹å‡» å·¥å…·--æ’ä»¶ ä¸‹è½½</p><p>Demoï¼ˆçº¢è‰²æ ‡è®°ä¸ºæŠŠè¿™äº›åŠ åœ¨ä¸€èµ·çš„å¤§å°å°±æ˜¯è®¾ç½®çš„å †å†…å­˜å¤§å°ï¼‰</p><figure><img src="/java-tips/assets/y3pml_XolV6nSlmW2_u2zaIGs0CD6U5eDil18u8uvQE-e5ba57c4.webp" alt="image" tabindex="0" loading="lazy"><figcaption>image</figcaption></figure><p>Demo1</p><figure><img src="/java-tips/assets/SnU1fTcg78I0zLGk9y8ML8TcoZlowF53QBWga1oAO0Q-93ebd8e0.webp" alt="image" tabindex="0" loading="lazy"><figcaption>image</figcaption></figure><h2 id="å †å†…å­˜åˆ†åŒº" tabindex="-1"><a class="header-anchor" href="#å †å†…å­˜åˆ†åŒº" aria-hidden="true">#</a> å †å†…å­˜åˆ†åŒº</h2><p>ç°ä»£åƒåœ¾æ”¶é›†å™¨å¤§éƒ¨åˆ†éƒ½åŸºäºåˆ†ä»£æ”¶é›†ç†è®ºè®¾è®¡ï¼Œå †ç©ºé—´ç»†åˆ†ä¸ºï¼š</p><ul><li>Java 7åŠä¹‹å‰å †å†…å­˜é€»è¾‘ä¸Šåˆ†ä¸ºä¸‰éƒ¨åˆ†ï¼š<code>æ–°ç”ŸåŒº + å…»è€åŒº + </code><strong>æ°¸ä¹…åŒº</strong><ul><li>Young Generation Space æ–°ç”ŸåŒº Young/New</li><li>åˆè¢«åˆ’åˆ†ä¸º <code>EdenåŒº</code> å’Œ <code>SurvivoråŒº</code></li><li>Tenure generation space å…»è€åŒº Old/Tenure</li><li>Permanent Spaceæ°¸ä¹…åŒº Perm</li></ul></li></ul><figure><img src="/java-tips/assets/woLT-5i5UU7iWKwZNZ33OWrBZFqylmoIBHG8OXEuF6g-89b95c24.webp" alt="image" tabindex="0" loading="lazy"><figcaption>image</figcaption></figure><ul><li>Java 8åŠä¹‹åå †å†…å­˜é€»è¾‘ä¸Šåˆ†ä¸ºä¸‰éƒ¨åˆ†ï¼š<code>æ–°ç”ŸåŒº + å…»è€åŒº + </code><strong>å…ƒç©ºé—´</strong><ul><li>Young/New Generation Space æ–°ç”ŸåŒºï¼Œåˆè¢«åˆ’åˆ†ä¸ºEdenåŒºå’ŒSurvivoråŒº</li><li>Old/Tenure generation space å…»è€åŒº</li><li>Meta Space å…ƒç©ºé—´ Meta</li></ul></li></ul><figure><img src="/java-tips/assets/-9AEN_je35csLbssE4spcOctd8SIZnrzS_sSs57zA30-14a3d1ae.webp" alt="image" tabindex="0" loading="lazy"><figcaption>image</figcaption></figure><p>ä»Jvisualvmä¸­å¯ä»¥çœ‹</p><figure><img src="/java-tips/assets/8pk0Fs8hxBrNERdk_r7XM0aM3vfqgbDClfVrkdO3jVU-abef2359.webp" alt="image" tabindex="0" loading="lazy"><figcaption>image</figcaption></figure><ul><li>çº¦å®šï¼š<code>æ–°ç”ŸåŒº = æ–°ç”Ÿä»£ = å¹´è½»ä»£</code>ã€Â <code>å…»è€åŒº = è€å¹´åŒº = è€å¹´ä»£</code>ã€Â <code>æ°¸ä¹…åŒº = æ°¸ä¹…ä»£</code></li><li>å †ç©ºé—´å†…éƒ¨ç»“æ„ï¼ŒJDK1.8ä¹‹å‰ä»<code>æ°¸ä¹…ä»£</code>Â æ›¿æ¢æˆÂ <code>å…ƒç©ºé—´</code></li><li>å †ç©ºé—´é€»è¾‘ä¸ŠåŒ…æ‹¬Â <code>æ°¸ä¹…ä»£/å…ƒç©ºé—´</code>ï¼Œå®é™…ä¸Šæ§åˆ¶ä¸åˆ°</li></ul><figure><img src="/java-tips/assets/5wFnckgq2e5bTL9ziAQzLijRZgFh2FGB8kJkhHu7EFk-81bf96d8.webp" alt="image" tabindex="0" loading="lazy"><figcaption>image</figcaption></figure><p>ç¤ºä¾‹ä»£ç ï¼š</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">SimpleHeap</span> <span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token keyword">int</span> id<span class="token punctuation">;</span><span class="token comment">//å±æ€§ã€æˆå‘˜å˜é‡</span>

    <span class="token keyword">public</span> <span class="token class-name">SimpleHeap</span><span class="token punctuation">(</span><span class="token keyword">int</span> id<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>id <span class="token operator">=</span> id<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">show</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;My ID is &quot;</span> <span class="token operator">+</span> id<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">SimpleHeap</span> sl <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SimpleHeap</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">SimpleHeap</span> s2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SimpleHeap</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> arr <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token class-name">Object</span><span class="token punctuation">[</span><span class="token punctuation">]</span> arr1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Object</span><span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åŠ å…¥VMå‚æ•°</p><blockquote><p>-Xms10m -Xmx10m -XX:+PrintGCDetails</p></blockquote><p>åœ¨Java8çš„æ¡ä»¶ä¸‹å¯ä»¥çœ‹åˆ°</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token class-name">Heap</span>
 <span class="token class-name">PSYoungGen</span>      total <span class="token number">2560</span>K<span class="token punctuation">,</span> used <span class="token number">1623</span>K <span class="token punctuation">[</span><span class="token number">0x00000000ffd00000</span><span class="token punctuation">,</span> <span class="token number">0x0000000100000000</span><span class="token punctuation">,</span> <span class="token number">0x0000000100000000</span><span class="token punctuation">)</span>
  eden space <span class="token number">2048</span>K<span class="token punctuation">,</span> <span class="token number">79</span><span class="token operator">%</span> used <span class="token punctuation">[</span><span class="token number">0x00000000ffd00000</span><span class="token punctuation">,</span><span class="token number">0x00000000ffe95f48</span><span class="token punctuation">,</span><span class="token number">0x00000000fff00000</span><span class="token punctuation">)</span>
  from space <span class="token number">512</span>K<span class="token punctuation">,</span> <span class="token number">0</span><span class="token operator">%</span> used <span class="token punctuation">[</span><span class="token number">0x00000000fff80000</span><span class="token punctuation">,</span><span class="token number">0x00000000fff80000</span><span class="token punctuation">,</span><span class="token number">0x0000000100000000</span><span class="token punctuation">)</span>
  <span class="token keyword">to</span>   <span class="token namespace">space</span> <span class="token number">512</span>K<span class="token punctuation">,</span> <span class="token number">0</span><span class="token operator">%</span> used <span class="token punctuation">[</span><span class="token number">0x00000000fff00000</span><span class="token punctuation">,</span><span class="token number">0x00000000fff00000</span><span class="token punctuation">,</span><span class="token number">0x00000000fff80000</span><span class="token punctuation">)</span>
 <span class="token class-name">ParOldGen</span>       total <span class="token number">7168</span>K<span class="token punctuation">,</span> used <span class="token number">0</span>K <span class="token punctuation">[</span><span class="token number">0x00000000ff600000</span><span class="token punctuation">,</span> <span class="token number">0x00000000ffd00000</span><span class="token punctuation">,</span> <span class="token number">0x00000000ffd00000</span><span class="token punctuation">)</span>
  object space <span class="token number">7168</span>K<span class="token punctuation">,</span> <span class="token number">0</span><span class="token operator">%</span> used <span class="token punctuation">[</span><span class="token number">0x00000000ff600000</span><span class="token punctuation">,</span><span class="token number">0x00000000ff600000</span><span class="token punctuation">,</span><span class="token number">0x00000000ffd00000</span><span class="token punctuation">)</span>
 <span class="token class-name">Metaspace</span>       used <span class="token number">3194</span>K<span class="token punctuation">,</span> capacity <span class="token number">4496</span>K<span class="token punctuation">,</span> committed <span class="token number">4864</span>K<span class="token punctuation">,</span> reserved <span class="token number">1056768</span>K
  <span class="token keyword">class</span> space    used <span class="token number">348</span>K<span class="token punctuation">,</span> capacity <span class="token number">388</span>K<span class="token punctuation">,</span> committed <span class="token number">512</span>K<span class="token punctuation">,</span> reserved <span class="token number">1048576</span>K
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>java7ç¯å¢ƒä¸‹æ˜¯</p><figure><img src="/java-tips/assets/Wg50jd0w8msymHYP187QyvijPDVeR1k3u_QYW2w0_1o-32429ead.webp" alt="image" tabindex="0" loading="lazy"><figcaption>image</figcaption></figure><h1 id="è®¾ç½®å †å†…å­˜å¤§å°ä¸oom" tabindex="-1"><a class="header-anchor" href="#è®¾ç½®å †å†…å­˜å¤§å°ä¸oom" aria-hidden="true">#</a> è®¾ç½®å †å†…å­˜å¤§å°ä¸OOM</h1><h2 id="è®¾ç½®å †ç©ºé—´å¤§å°" tabindex="-1"><a class="header-anchor" href="#è®¾ç½®å †ç©ºé—´å¤§å°" aria-hidden="true">#</a> è®¾ç½®å †ç©ºé—´å¤§å°</h2><ul><li>Javaå †åŒºç”¨äºå­˜å‚¨Javaå¯¹è±¡å®ä¾‹ï¼Œé‚£ä¹ˆå †çš„å¤§å°åœ¨JVMå¯åŠ¨æ—¶å°±å·²ç»è®¾å®šå¥½äº†ï¼Œå¤§å®¶å¯ä»¥é€šè¿‡é€‰é¡¹&quot;-Xms&quot;å’Œ&quot;-Xmx&quot;æ¥è¿›è¡Œè®¾ç½®ã€‚ <ul><li><strong>-Xms</strong> ç”¨äºè¡¨ç¤ºå †åŒºçš„åˆå§‹å†…å­˜ï¼Œç­‰ä»·äº <strong>-XX:InitialHeapSize</strong></li><li><strong>-Xmx</strong> åˆ™ç”¨äºè¡¨ç¤ºå †åŒºçš„æœ€å¤§å†…å­˜ï¼Œç­‰ä»·äº -<strong>XX:MaxHeapSize</strong>* ä¸€æ—¦å †åŒºä¸­çš„å†…å­˜å¤§å°è¶…è¿‡â€œ-Xmxâ€æ‰€æŒ‡å®šçš„æœ€å¤§å†…å­˜æ—¶ï¼Œå°†ä¼šæŠ›å‡ºOutofMemoryErrorå¼‚å¸¸ã€‚</li></ul></li><li>é€šå¸¸ä¼šå°†-Xmså’Œ-Xmxä¸¤ä¸ªå‚æ•°é…ç½®ç›¸åŒçš„å€¼ï¼Œå…¶ç›®çš„æ˜¯ä¸ºäº†èƒ½å¤Ÿåœ¨Javaåƒåœ¾å›æ”¶æœºåˆ¶æ¸…ç†å®Œå †åŒºåä¸éœ€è¦é‡æ–°åˆ†éš”è®¡ç®—å †åŒºçš„å¤§å°ï¼Œä»è€Œæé«˜æ€§èƒ½ã€‚</li><li>é»˜è®¤æƒ…å†µä¸‹: <ul><li>åˆå§‹å†…å­˜å¤§å°ï¼š<code>ç‰©ç†ç”µè„‘å†…å­˜å¤§å°/64</code></li><li>æœ€å¤§å†…å­˜å¤§å°ï¼š<code>ç‰©ç†ç”µè„‘å†…å­˜å¤§å°/4</code></li></ul></li></ul><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token doc-comment comment">/**
 * 1. è®¾ç½®å †ç©ºé—´å¤§å°çš„å‚æ•°
 * -Xms ç”¨æ¥è®¾ç½®å †ç©ºé—´ï¼ˆå¹´è½»ä»£+è€å¹´ä»£ï¼‰çš„åˆå§‹å†…å­˜å¤§å°
 *      -X æ˜¯jvmçš„è¿è¡Œå‚æ•°
 *      ms æ˜¯memory start
 * -Xmx ç”¨æ¥è®¾ç½®å †ç©ºé—´ï¼ˆå¹´è½»ä»£+è€å¹´ä»£ï¼‰çš„æœ€å¤§å†…å­˜å¤§å°
 *
 * 2. é»˜è®¤å †ç©ºé—´çš„å¤§å°
 *      åˆå§‹å†…å­˜å¤§å°ï¼šç‰©ç†ç”µè„‘å†…å­˜å¤§å° / 64
 *      æœ€å¤§å†…å­˜å¤§å°ï¼šç‰©ç†ç”µè„‘å†…å­˜å¤§å° / 4
 *
 * 3. æ‰‹åŠ¨è®¾ç½®ï¼š-Xms600m -Xmx600m
 *     å¼€å‘ä¸­å»ºè®®å°†åˆå§‹å †å†…å­˜å’Œæœ€å¤§çš„å †å†…å­˜è®¾ç½®æˆç›¸åŒçš„å€¼ã€‚
 *
 * 4. æŸ¥çœ‹è®¾ç½®çš„å‚æ•°ï¼šæ–¹å¼ä¸€ï¼š jps   /  jstat -gc è¿›ç¨‹id
 *                  æ–¹å¼äºŒï¼š-XX:+PrintGCDetails
 */</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">HeapSpaceInitial</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>

        <span class="token comment">//è¿”å›Javaè™šæ‹Ÿæœºä¸­çš„å †å†…å­˜æ€»é‡</span>
        <span class="token keyword">long</span> initialMemory <span class="token operator">=</span> <span class="token class-name">Runtime</span><span class="token punctuation">.</span><span class="token function">getRuntime</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">totalMemory</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">1024</span> <span class="token operator">/</span> <span class="token number">1024</span><span class="token punctuation">;</span>
        <span class="token comment">//è¿”å›Javaè™šæ‹Ÿæœºè¯•å›¾ä½¿ç”¨çš„æœ€å¤§å †å†…å­˜é‡</span>
        <span class="token keyword">long</span> maxMemory <span class="token operator">=</span> <span class="token class-name">Runtime</span><span class="token punctuation">.</span><span class="token function">getRuntime</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">maxMemory</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">1024</span> <span class="token operator">/</span> <span class="token number">1024</span><span class="token punctuation">;</span>

        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;-Xms : &quot;</span> <span class="token operator">+</span> initialMemory <span class="token operator">+</span> <span class="token string">&quot;M&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;-Xmx : &quot;</span> <span class="token operator">+</span> maxMemory <span class="token operator">+</span> <span class="token string">&quot;M&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="å¦‚ä½•éªŒè¯" tabindex="-1"><a class="header-anchor" href="#å¦‚ä½•éªŒè¯" aria-hidden="true">#</a> å¦‚ä½•éªŒè¯ï¼Ÿ</h3><p>ä½¿ç”¨ä¸Šè¿°ä»£ç ï¼šHeapSpaceInitial</p><blockquote><p>jpsï¼šæŸ¥çœ‹å½“å‰ç¨‹åºè¿è¡Œçš„è¿›ç¨‹</p></blockquote><blockquote><p>jstatï¼šJVMåœ¨GCçš„æ˜¾ç¤ºä¿¡æ¯</p></blockquote><figure><img src="/java-tips/assets/q-BsvloTprgm1FJzbpXyDsiGHUiV5G8XucWWMPP359M-268a4e27.webp" alt="image" tabindex="0" loading="lazy"><figcaption>image</figcaption></figure><ul><li>OC æ€»é‡</li><li>OU ä½¿ç”¨é‡</li><li>EC / EU ä¼Šç”¸å›­åŒº</li><li>S0 / S1</li></ul><p>åˆæ¬¡è®¡ç®—ï¼š</p><figure><img src="/java-tips/assets/cnnTi09WTD_rXlIob1ynTxn9MKVBh-KXAjEzqHESAGY-72d79649.webp" alt="image" tabindex="0" loading="lazy"><figcaption>image</figcaption></figure><p>æ€»çš„åŠ èµ·æ¥æ˜¯ï¼š614400ï¼Œå†é™¤ä»¥1024ï¼Œå¾—åˆ°575</p><p>ä½†æ˜¯æ˜¾ç¤ºçš„æ˜¯ï¼š</p><figure><img src="data:image/webp;base64,UklGRnYEAABXRUJQVlA4IGoEAABwGgCdASqLADwAPm0wlUakIyIhKdXbMIANiWUA0jOiCkqFzrSD/9Cn//6f+22brN6hXoS+eJ6t3+xwQDr1/wng71gn5PZ3/OeMXe37aP3byZ7oP3rzL+nvoW/lXFQUAP5P/a/+r9wHxg/Q3nf+gfYH/W7rS+i8a5/Wb5NErqUBmpxgcD+BAKXbeRVwa5hcIlWymy3bv0f0JYUxaMULqYxaexja1TjkKZYyw9eD3pe8Y9n3pbnjtaGM66aM+m+9mAFVj2Vzf95EJAVHNB3Zyi+RJXsE979E08vqB3XwAP7s81UluFIdEn6tB6cnV02xNRLcg1kHOBG7yaL9U6lYbKna0LnP283Z0v4arvXE4qUdhuN0ZMUC0Zk87F9KFc9fTebZO+dsFVysS679S4UaKjHzVoBb343eZWPC/7XvylOjBCchlNgQr0gvi/I0V1gdr4NcflBIUrMJCWdmj0GBJNLaESw8D+54TAAFJ/IWeSVI5J80TnXw8j6Wo7Ut3GUUumlKW/3+GoLd5Imm8hp8coshu2Ew1GVRUVF6GGgUObl1WiAVpEY4knFpuyPwPex7wquj1SL1Q9w43/Yfzok5FS2kxslhpWYlsrzBMZDNsDbT4yWtFOS0tWuDLWUZ7Y5baRcXhHHEKx2c7wi701oHq8GJfPZOKb+Oz1vu7EgZjGl8iP8Cdi18oB2y1fCiWBn50OAL2nN8ELnX+0Qe4CI5czWzqGez1oSMxg14XK8WhfwhTJPanCuJNQYtWfGyHol0EssZJJO2apOraL/W47TfwylXo6y4uiUSsrbo0ZzKmG4IRQiL0sAeI2+/LV9bEtEdfNotYfHg8JcOFj6DMlmVhgWpOxLibc8xATcAFbN8aJXZjkLpAJa4rqWxSgivQoZAVbTDUNhe+ZWv+YH3yPBBh1Ja1sGtvRgqa33b7DdfELipA1ZGNeWqQ38VNK54aiqy0oBaei433aU/lCPJJWfwdrhTpf/6K4t+oih8DTyysBb8pyoDBHuknGoeceI7hJcTEzT+x92PL/nPrzrK5oQFebk6b9YiFfkdDMzjo8D4V+NaWK1ylOxfyOiuXTrAG+IoonrUsM9RpC/G1CBgJlE5ZJcbQ3p+3f/WK9dJXI+DC2DWyTK3OkE0ucpQe7L3GpgLc1/l1r0Q4/W2BLFPanVeR1VIRX7PM6iuivnSoeFxUJ4U9rKggLecKJ7cIjqblh6Egk1HYbcWFgnFeXy3/5k0/VzRJL65/pT2R0Fjigyx5eFIwh99F0C0cr9raL65ND3FQeNsydW97SItFLKslcT+HfxHHu+Q1McPNzDxvaiR2fU+5FeYIKLrZLuBsJCSWI80FqfESCwgq2ejFkfr0vP+/g4UiDH9sDvI3IrtRyWf/7I2yRSjAgjt6OQVvrG80wWZgRWoEKpgdySljvTVb0UVRnSykvj7coKlwvvcKVUqkEOBo5eWRWz+4QqLWHkZ8Zg14iS0ktDxy3Xq4NLkZQ6uvysxbgzwMAAAAAAAAA==" alt="image" tabindex="0" loading="lazy"><figcaption>image</figcaption></figure><p>è¿™æ˜¯å¦‚ä½•è®¡ç®—çš„ï¼Ÿ</p><p>S0Cå’ŒS1Cé€‰æ‹©ä¸€ä¸ªå³å¯ï¼Œç›¸å½“äºï¼š</p><blockquote><p>( 25600 + 153600 + 409600 ) / 1024 = 575</p></blockquote><h2 id="oomä¸¾ä¾‹" tabindex="-1"><a class="header-anchor" href="#oomä¸¾ä¾‹" aria-hidden="true">#</a> OOMä¸¾ä¾‹</h2><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token doc-comment comment">/**
 * -Xms600m -Xmx600m
 */</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">OOMTest</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Picture</span><span class="token punctuation">&gt;</span></span> list <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">while</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            <span class="token keyword">try</span> <span class="token punctuation">{</span>
                <span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">InterruptedException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            list<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Picture</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Random</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">nextInt</span><span class="token punctuation">(</span><span class="token number">1024</span> <span class="token operator">*</span> <span class="token number">1024</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name">Picture</span> <span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> pixels<span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token class-name">Picture</span><span class="token punctuation">(</span><span class="token keyword">int</span> length<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>pixels <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">byte</span><span class="token punctuation">[</span>length<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>ç›‘æ§å †å†…å­˜å˜åŒ–ï¼šOld åŒºåŸŸä¸€ç‚¹ä¸€ç‚¹åœ¨å˜å¤§ï¼Œç›´åˆ°æœ€åä¸€æ¬¡åƒåœ¾å›æ”¶å™¨æ— æ³•å›æ”¶åƒåœ¾æ—¶ï¼Œå †å†…å­˜è¢«æ’‘çˆ†ï¼ŒæŠ›å‡º OutOfMemoryError é”™è¯¯</li></ul><figure><img src="/java-tips/assets/Z90oAGxEpLhxH0CBTP0jqIDIDZGc2fyS5k9h37p_no8-67dd2800.gif" alt="image" tabindex="0" loading="lazy"><figcaption>image</figcaption></figure><p>æœ€åè¶…è¿‡å †ç©ºé—´é€ æˆOOMé”™è¯¯</p><figure><img src="/java-tips/assets/AU2yQ9wTfybOR29KkNbPHvUxUMn_5R-przkfr7lrz78-9a21d6ab.webp" alt="image" tabindex="0" loading="lazy"><figcaption>image</figcaption></figure><h1 id="å¹´è½»ä»£ä¸è€å¹´ä»£" tabindex="-1"><a class="header-anchor" href="#å¹´è½»ä»£ä¸è€å¹´ä»£" aria-hidden="true">#</a> å¹´è½»ä»£ä¸è€å¹´ä»£</h1><ul><li><strong>å­˜å‚¨åœ¨JVMä¸­çš„Javaå¯¹è±¡å¯ä»¥è¢«åˆ’åˆ†ä¸ºä¸¤ç±»ï¼š</strong><ul><li>ä¸€ç±»æ˜¯ç”Ÿå‘½å‘¨æœŸè¾ƒçŸ­çš„ç¬æ—¶å¯¹è±¡ï¼Œè¿™ç±»å¯¹è±¡çš„åˆ›å»ºå’Œæ¶ˆäº¡éƒ½éå¸¸è¿…é€Ÿ</li><li>å¦å¤–ä¸€ç±»å¯¹è±¡çš„ç”Ÿå‘½å‘¨æœŸå´éå¸¸é•¿ï¼Œåœ¨æŸäº›æç«¯çš„æƒ…å†µä¸‹è¿˜èƒ½å¤Ÿä¸JVMçš„ç”Ÿå‘½å‘¨æœŸä¿æŒä¸€è‡´</li></ul></li><li>Javaå †åŒºè¿›ä¸€æ­¥ç»†åˆ†çš„è¯ï¼Œå¯ä»¥åˆ’åˆ†ä¸º<strong>å¹´è½»ä»£</strong>ï¼ˆYoungGenï¼‰å’Œ<strong>è€å¹´ä»£</strong>ï¼ˆoldGenï¼‰</li><li>å…¶ä¸­å¹´è½»ä»£åˆå¯ä»¥åˆ’åˆ†ä¸ºEdenç©ºé—´ã€Survivor0ç©ºé—´å’ŒSurvivor1ç©ºé—´ï¼ˆæœ‰æ—¶ä¹Ÿå«åšfromåŒºã€toåŒºï¼‰</li></ul><figure><img src="/java-tips/assets/cqNus0vKUjlAduaNYEEUtjxyLhagiC6f_la1d_ZglPI-0257bb66.webp" alt="image" tabindex="0" loading="lazy"><figcaption>image</figcaption></figure><h2 id="é…ç½®æ–°è€æ¯”ä¾‹" tabindex="-1"><a class="header-anchor" href="#é…ç½®æ–°è€æ¯”ä¾‹" aria-hidden="true">#</a> é…ç½®æ–°è€æ¯”ä¾‹</h2><p>é…ç½®æ–°ç”Ÿä»£ä¸è€å¹´ä»£åœ¨å †ç»“æ„çš„å æ¯”ï¼ˆä¸‹é¢è¿™äº›å‚æ•°åœ¨å¼€å‘ä¸­ä¸€èˆ¬ä¸ä¼šè°ƒï¼‰</p><ul><li>é»˜è®¤**-XX:NewRatio**=2ï¼Œè¡¨ç¤ºæ–°ç”Ÿä»£å 1ï¼Œè€å¹´ä»£å 2ï¼Œæ–°ç”Ÿä»£å æ•´ä¸ªå †çš„1/3</li><li>å¯ä»¥ä¿®æ”¹**-XX:NewRatio**=4ï¼Œè¡¨ç¤ºæ–°ç”Ÿä»£å 1ï¼Œè€å¹´ä»£å 4ï¼Œæ–°ç”Ÿä»£å æ•´ä¸ªå †çš„1/5</li><li>å½“å‘ç°åœ¨æ•´ä¸ªé¡¹ç›®ä¸­ï¼Œç”Ÿå‘½å‘¨æœŸé•¿çš„å¯¹è±¡åå¤šï¼Œé‚£ä¹ˆå°±å¯ä»¥é€šè¿‡è°ƒæ•´è€å¹´ä»£çš„å¤§å°ï¼Œæ¥è¿›è¡Œè°ƒä¼˜</li></ul><p>ä¸‹é¢è¿™ä¸ªå‚æ•°å¼€å‘ä¸­ä¸€èˆ¬ä¸ä¼šè°ƒï¼š</p><figure><img src="/java-tips/assets/gl7PulTEyXi9t998zDd828pDB2mCE3-6eYvs9ZqRhfM-b85d306e.webp" alt="image" tabindex="0" loading="lazy"><figcaption>image</figcaption></figure><h3 id="æ–°ç”ŸåŒºä¸­çš„æ¯”ä¾‹" tabindex="-1"><a class="header-anchor" href="#æ–°ç”ŸåŒºä¸­çš„æ¯”ä¾‹" aria-hidden="true">#</a> æ–°ç”ŸåŒºä¸­çš„æ¯”ä¾‹</h3><ul><li>åœ¨HotSpotä¸­ï¼ŒEdenç©ºé—´å’Œå¦å¤–ä¸¤ä¸ªsurvivorç©ºé—´ç¼ºçœæ‰€å çš„æ¯”ä¾‹æ˜¯8 : 1 : 1</li><li>å½“ç„¶å¼€å‘äººå‘˜å¯ä»¥é€šè¿‡é€‰é¡¹**-XX:SurvivorRatio**è°ƒæ•´è¿™ä¸ªç©ºé—´æ¯”ä¾‹ã€‚æ¯”å¦‚-XX:SurvivorRatio=8</li><li><code>å‡ ä¹æ‰€æœ‰</code>çš„Javaå¯¹è±¡éƒ½æ˜¯åœ¨EdenåŒºè¢«newå‡ºæ¥çš„ã€‚</li><li>ç»å¤§éƒ¨åˆ†çš„Javaå¯¹è±¡çš„é”€æ¯éƒ½åœ¨æ–°ç”Ÿä»£è¿›è¡Œäº†ï¼ˆæœ‰äº›å¤§çš„å¯¹è±¡åœ¨EdenåŒºæ— æ³•å­˜å‚¨æ—¶å€™ï¼Œå°†ç›´æ¥è¿›å…¥è€å¹´ä»£ï¼‰ <ul><li>IBMå…¬å¸çš„ä¸“é—¨ç ”ç©¶è¡¨æ˜ï¼Œæ–°ç”Ÿä»£ä¸­80%çš„å¯¹è±¡éƒ½æ˜¯â€œæœç”Ÿå¤•æ­»â€çš„ã€‚</li></ul></li><li>å¯ä»¥ä½¿ç”¨é€‰é¡¹&quot;-Xmn&quot;è®¾ç½®æ–°ç”Ÿä»£æœ€å¤§å†…å­˜å¤§å°ï¼Œä½†è¿™ä¸ªå‚æ•°ä¸€èˆ¬ä½¿ç”¨é»˜è®¤å€¼å°±å¯ä»¥äº†ã€‚</li><li>æ–°ç”ŸåŒºçš„å¯¹è±¡é»˜è®¤ç”Ÿå‘½å‘¨æœŸè¶…è¿‡ 15 ï¼Œå°†è¿›å…¥è€å¹´ä»£</li></ul><figure><img src="/java-tips/assets/if14UlfNEFM6CxKJwBHC430lWvlJ9x2S1oFh3g60cwk-6d6419e5.webp" alt="image" tabindex="0" loading="lazy"><figcaption>image</figcaption></figure><p>ä»£ç ç¤ºä¾‹ï¼š</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token doc-comment comment">/**
 * -Xms600m -Xmx600m
 *
 * -XX:NewRatio ï¼š è®¾ç½®æ–°ç”Ÿä»£ä¸è€å¹´ä»£çš„æ¯”ä¾‹ã€‚é»˜è®¤å€¼æ˜¯2.
 * -XX:SurvivorRatio ï¼šè®¾ç½®æ–°ç”Ÿä»£ä¸­EdenåŒºä¸SurvivoråŒºçš„æ¯”ä¾‹ã€‚é»˜è®¤å€¼æ˜¯8
 * -XX:-UseAdaptiveSizePolicy ï¼šå…³é—­è‡ªé€‚åº”çš„å†…å­˜åˆ†é…ç­–ç•¥  ï¼ˆæš‚æ—¶ç”¨ä¸åˆ°ï¼‰
 * -Xmn:è®¾ç½®æ–°ç”Ÿä»£çš„ç©ºé—´çš„å¤§å°ã€‚ ï¼ˆä¸€èˆ¬ä¸è®¾ç½®ï¼‰
 */</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">EdenSurvivorTest</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;æˆ‘åªæ˜¯æ¥æ‰“ä¸ªé…±æ²¹~&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            <span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">1000000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">InterruptedException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>é€šè¿‡å‘½ä»¤è¡ŒæŸ¥çœ‹å„ç§æ¯”ä¾‹ <ul><li>æŸ¥çœ‹æ–°ç”Ÿä»£ä¸è€å¹´ä»£çš„æ¯”ä¾‹</li></ul></li></ul><div class="language-Plain line-numbers-mode" data-ext="Plain"><pre class="language-Plain"><code>jps
jinfo -flag NewRatios è¿›ç¨‹id 
12
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>æŸ¥çœ‹æ–°ç”ŸåŒºä¸­ä¼Šç”¸å›­åŒºä¸å¹¸å­˜è€…åŒºçš„æ¯”ä¾‹</li></ul><div class="language-Plain line-numbers-mode" data-ext="Plain"><pre class="language-Plain"><code>jps
jinfo -flag SurvivorRatio è¿›ç¨‹id 
12
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>è®¾ç½® JVM å‚æ•°</li></ul><div class="language-Plain line-numbers-mode" data-ext="Plain"><pre class="language-Plain"><code>-Xms600m -Xmx600m -XX:NewRatio=2 -XX:SurvivorRatio=8
1
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>æ–°ç”ŸåŒºä¸­ï¼šä¼Šç”¸å›­åŒº : å¹¸å­˜è€… 0 åŒº : å¹¸å­˜è€… 1 åŒº = 8 : 1 : 1</li><li>æ–°ç”ŸåŒº : è€å¹´åŒº = 1 : 2</li></ul><p>æ€è€ƒï¼šè®¾ç½®çš„600Mçš„å †ç©ºé—´ï¼Œé¦–å…ˆæŒ‰ç…§æ–°ç”Ÿä»£ï¼šè€å¹´ä»£=1:2ï¼Œæ–°ç”Ÿä»£å°±ä¸º200Mï¼Œè€å¹´ä»£ä¸º400Mï¼›å†æŒ‰ç…§æ–°ç”Ÿä»£8:1:1çš„æ–¹å¼è®¡ç®—ï¼Œæ¯ä¸ªå¹¸å­˜è€…åŒºåº”è¯¥æ˜¯20Mï¼Ÿè¿™å°±æ˜¯å› ä¸ºå­˜åœ¨ä¸€ä¸ªè‡ªé€‚åº”çš„æœºåˆ¶ï¼ˆä¸‹å›¾çš„å¹¸å­˜è€…åŒºä¸º25Mï¼Œå¦‚ä½•è§£å†³è¿™ä¸ªé—®é¢˜ï¼Ÿï¼‰</p><figure><img src="/java-tips/assets/-s2rVc30UvQL2JBJvpmQT88PZnMMUy4nEtqCjp0WIxU-aaab3b18.webp" alt="image" tabindex="0" loading="lazy"><figcaption>image</figcaption></figure><blockquote><p>åŠ ä¸Šå‚æ•°ï¼š-XX:-UseAdaptiveSizePolicy ï¼šå…³é—­è‡ªé€‚åº”çš„å†…å­˜åˆ†é…ç­–ç•¥</p></blockquote><p>æ•ˆæœè¿˜æ˜¯å’Œä»¥å‰ä¸€æ ·</p><figure><img src="/java-tips/assets/7-22jaKigah4tHvxBIX-qJHna1XbxXKy_JC_B3H5pGw-3cf4f7c7.webp" alt="image" tabindex="0" loading="lazy"><figcaption>image</figcaption></figure><blockquote><p>æ¢VMå‚æ•°ä¸ºï¼š-XX:SurvivorRatio=8</p></blockquote><figure><img src="/java-tips/assets/vVb9bpYPmnpsteUhSEIrIfI7XDPaPi9qYZyd9W2pba8-30666b83.webp" alt="image" tabindex="0" loading="lazy"><figcaption>image</figcaption></figure><figure><img src="/java-tips/assets/cCFpiEe2sRj4WiaVIV8M1cxCjBQfDm_2bU37o5AA8LI-f0ac8420.webp" alt="image" tabindex="0" loading="lazy"><figcaption>image</figcaption></figure><p>å°±å¯ä»¥è¾¾åˆ°å…³é—­è‡ªé€‚åº”çš„æ•ˆæœ</p><h1 id="å›¾è§£å¯¹è±¡åˆ†é…è¿‡ç¨‹" tabindex="-1"><a class="header-anchor" href="#å›¾è§£å¯¹è±¡åˆ†é…è¿‡ç¨‹" aria-hidden="true">#</a> å›¾è§£å¯¹è±¡åˆ†é…è¿‡ç¨‹</h1><h2 id="æ¦‚è¿°" tabindex="-1"><a class="header-anchor" href="#æ¦‚è¿°" aria-hidden="true">#</a> æ¦‚è¿°</h2><p>ä¸ºæ–°å¯¹è±¡åˆ†é…å†…å­˜æ˜¯ä¸€ä»¶éå¸¸ä¸¥è°¨å’Œå¤æ‚çš„ä»»åŠ¡ï¼ŒJVMçš„è®¾è®¡è€…ä»¬ä¸ä»…éœ€è¦è€ƒè™‘å†…å­˜å¦‚ä½•åˆ†é…ã€åœ¨å“ªé‡Œåˆ†é…ç­‰é—®é¢˜ï¼Œå¹¶ä¸”ç”±äºå†…å­˜åˆ†é…ç®—æ³•ä¸å†…å­˜å›æ”¶ç®—æ³•å¯†åˆ‡ç›¸å…³ï¼Œæ‰€ä»¥è¿˜éœ€è¦è€ƒè™‘GCæ‰§è¡Œå®Œå†…å­˜å›æ”¶åæ˜¯å¦ä¼šåœ¨å†…å­˜ç©ºé—´ä¸­äº§ç”Ÿå†…å­˜ç¢ç‰‡ã€‚</p><ul><li>newçš„å¯¹è±¡å…ˆæ”¾ä¼Šç”¸å›­åŒºã€‚æ­¤åŒºæœ‰å¤§å°é™åˆ¶ã€‚</li><li>å½“ä¼Šç”¸å›­çš„ç©ºé—´å¡«æ»¡æ—¶ï¼Œç¨‹åºåˆéœ€è¦åˆ›å»ºå¯¹è±¡ï¼ŒJVMçš„åƒåœ¾å›æ”¶å™¨å°†å¯¹ä¼Šç”¸å›­åŒºè¿›è¡Œåƒåœ¾å›æ”¶ï¼ˆMinorGCï¼‰ï¼Œå°†ä¼Šç”¸å›­åŒºä¸­çš„ä¸å†è¢«å…¶ä»–å¯¹è±¡æ‰€å¼•ç”¨çš„å¯¹è±¡è¿›è¡Œé”€æ¯ã€‚å†åŠ è½½æ–°çš„å¯¹è±¡æ”¾åˆ°ä¼Šç”¸å›­åŒºã€‚</li><li>ç„¶åå°†ä¼Šç”¸å›­ä¸­çš„å‰©ä½™å¯¹è±¡ç§»åŠ¨åˆ°å¹¸å­˜è€…0åŒºã€‚</li><li>å¦‚æœå†æ¬¡è§¦å‘åƒåœ¾å›æ”¶ï¼Œæ­¤æ—¶å°†ä¼Šç”¸å›­åŒºå’Œå¹¸å­˜è€…0åŒºè¿›è¡Œåƒåœ¾å›æ”¶ï¼Œå‰©ä¸‹çš„å¯¹è±¡å°±ä¼šæ”¾åˆ°å¹¸å­˜è€…1åŒºã€‚</li><li>å¦‚æœå†æ¬¡ç»å†åƒåœ¾å›æ”¶ï¼Œæ­¤æ—¶ä¼šé‡æ–°æ”¾å›å¹¸å­˜è€…0åŒºï¼Œæ¥ç€å†å»å¹¸å­˜è€…1åŒºã€‚</li><li>å•¥æ—¶å€™èƒ½å»å…»è€åŒºå‘¢ï¼Ÿå¯ä»¥è®¾ç½®æ¬¡æ•°ã€‚<strong>é»˜è®¤æ˜¯15æ¬¡</strong>ã€‚å¯ä»¥è®¾ç½®æ–°ç”ŸåŒºè¿›å…¥å…»è€åŒºçš„å¹´é¾„é™åˆ¶ï¼Œ <ul><li>è®¾ç½® JVM å‚æ•°ï¼š<strong>-XX:MaxTenuringThreshold</strong>=N è¿›è¡Œè®¾ç½®</li></ul></li><li>åœ¨å…»è€åŒºï¼Œç›¸å¯¹æ‚ é—²ã€‚å½“å…»è€åŒºå†…å­˜ä¸è¶³æ—¶ï¼Œå†æ¬¡è§¦å‘GCï¼šMajor GCï¼Œè¿›è¡Œå…»è€åŒºçš„å†…å­˜æ¸…ç†</li><li>è‹¥å…»è€åŒºæ‰§è¡Œäº†Major GCä¹‹åï¼Œå‘ç°ä¾ç„¶æ— æ³•è¿›è¡Œå¯¹è±¡çš„ä¿å­˜ï¼Œå°±ä¼šäº§ç”ŸOOMå¼‚å¸¸ã€‚</li></ul><h2 id="å›¾è§£å¯¹è±¡åˆ†é…-é‡è¦" tabindex="-1"><a class="header-anchor" href="#å›¾è§£å¯¹è±¡åˆ†é…-é‡è¦" aria-hidden="true">#</a> å›¾è§£å¯¹è±¡åˆ†é…(é‡è¦)</h2><figure><img src="/java-tips/assets/bXj1AaMZ1N4kfaoUSUTWVcZxnniZ_ZgBMBeiTUIrF1k-1afc3445.webp" alt="image" tabindex="0" loading="lazy"><figcaption>image</figcaption></figure><p><a href="https://player.bilibili.com/player.html?bvid=1PJ411n7xZ&amp;page=72" target="_blank" rel="noopener noreferrer">webpage<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><h3 id="åˆ†è§£" tabindex="-1"><a class="header-anchor" href="#åˆ†è§£" aria-hidden="true">#</a> åˆ†è§£</h3><ol><li>æˆ‘ä»¬åˆ›å»ºçš„å¯¹è±¡ï¼Œä¸€èˆ¬éƒ½æ˜¯å­˜æ”¾åœ¨EdenåŒºçš„ï¼Œå½“æˆ‘ä»¬çš„EdenåŒºæ»¡äº†åï¼Œå°±ä¼šè§¦å‘GCæ“ä½œï¼Œä¸€èˆ¬è¢«ç§°ä¸º YGC / Minor GCæ“ä½œ</li></ol><figure><img src="/java-tips/assets/-rdu3VlMcNQ4i-qfbHHHQkgJ1U5oQMEELHINFawwd2k-b4007b96.webp" alt="image" tabindex="0" loading="lazy"><figcaption>image</figcaption></figure><ol start="2"><li>å½“æˆ‘ä»¬è¿›è¡Œä¸€æ¬¡åƒåœ¾æ”¶é›†åï¼Œçº¢è‰²çš„å¯¹è±¡å°†ä¼šè¢«å›æ”¶ï¼Œè€Œç»¿è‰²çš„ç‹¬äº«è¿˜è¢«å ç”¨ç€ï¼Œå­˜æ”¾åœ¨S0(Survivor From)åŒºã€‚åŒæ—¶æˆ‘ä»¬ç»™æ¯ä¸ªå¯¹è±¡è®¾ç½®äº†ä¸€ä¸ªå¹´é¾„è®¡æ•°å™¨ï¼Œç»è¿‡ä¸€æ¬¡å›æ”¶åè¿˜å­˜åœ¨çš„å¯¹è±¡ï¼Œå°†å…¶å¹´é¾„åŠ  1ã€‚</li></ol><ul><li>åŒæ—¶EdenåŒºç»§ç»­å­˜æ”¾å¯¹è±¡ï¼Œå½“EdenåŒºå†æ¬¡å­˜æ»¡çš„æ—¶å€™ï¼Œåˆä¼šè§¦å‘ä¸€ä¸ªMinorGCæ“ä½œï¼Œæ­¤æ—¶GCå°†ä¼šæŠŠ Edenå’ŒSurvivor Fromä¸­çš„å¯¹è±¡è¿›è¡Œä¸€æ¬¡åƒåœ¾æ”¶é›†ï¼ŒæŠŠå­˜æ´»çš„å¯¹è±¡æ”¾åˆ° Survivor ToåŒºï¼ŒåŒæ—¶è®©å­˜æ´»çš„å¯¹è±¡å¹´é¾„ + 1</li></ul><figure><img src="/java-tips/assets/N9cDFrsI1wDWJQPO_xcCO-lD3NJZz59lfbcJh9s2t-c-91037742.webp" alt="image" tabindex="0" loading="lazy"><figcaption>image</figcaption></figure><ol start="3"><li>æˆ‘ä»¬ç»§ç»­ä¸æ–­çš„è¿›è¡Œå¯¹è±¡ç”Ÿæˆå’Œåƒåœ¾å›æ”¶ï¼Œå½“Survivorä¸­çš„å¯¹è±¡çš„å¹´é¾„è¾¾åˆ°15çš„æ—¶å€™ï¼Œå°†ä¼šè§¦å‘ä¸€æ¬¡ Promotion æ™‹å‡çš„æ“ä½œï¼Œä¹Ÿå°±æ˜¯å°†å¹´è½»ä»£ä¸­çš„å¯¹è±¡æ™‹å‡åˆ°è€å¹´ä»£ä¸­</li></ol><figure><img src="/java-tips/assets/3M8xNtOIscxDTOnXfxnUs48NzLLbq9mRC5nNSfX_Vus-854bbaa1.webp" alt="image" tabindex="0" loading="lazy"><figcaption>image</figcaption></figure><blockquote><p>æ³¨æ„ï¼šä¼Šç”¸å›­åŒºæ»¡äº†ä¼šè§¦å‘YGC/Minor GCï¼Œå¹¸å­˜è€…åŒºæ»¡äº†ä¸ä¼šè§¦å‘YGC</p></blockquote><h3 id="ç‰¹æ®Šæƒ…å†µè¯´æ˜" tabindex="-1"><a class="header-anchor" href="#ç‰¹æ®Šæƒ…å†µè¯´æ˜" aria-hidden="true">#</a> ç‰¹æ®Šæƒ…å†µè¯´æ˜</h3><blockquote><p>æ€è€ƒï¼šå¹¸å­˜åŒºæ»¡äº†å’‹åŠï¼Ÿ</p></blockquote><ul><li>ç‰¹åˆ«æ³¨æ„ï¼Œåœ¨EdenåŒºæ»¡äº†çš„æ—¶å€™ï¼Œæ‰ä¼šè§¦å‘MinorGCï¼Œè€Œ<strong>å¹¸å­˜è€…åŒºæ»¡äº†åï¼Œä¸ä¼šè§¦å‘MinorGCæ“ä½œ</strong></li><li>å¦‚æœSurvivoråŒºæ»¡äº†åï¼Œå°†ä¼šè§¦å‘ä¸€äº›ç‰¹æ®Šçš„è§„åˆ™ï¼Œä¹Ÿå°±æ˜¯å¯èƒ½ç›´æ¥æ™‹å‡è€å¹´ä»£</li></ul><blockquote><p>å¯¹è±¡åˆ†é…çš„ç‰¹æ®Šæƒ…å†µ</p></blockquote><ul><li>å¦‚æœæ¥äº†ä¸€ä¸ªæ–°å¯¹è±¡ï¼Œå…ˆçœ‹çœ‹ Eden æ˜¯å¦æ”¾çš„ä¸‹ï¼Ÿ <ul><li>å¦‚æœ Eden æ”¾å¾—ä¸‹ï¼Œåˆ™ç›´æ¥æ”¾åˆ° Eden åŒº</li><li>å¦‚æœ Eden æ”¾ä¸ä¸‹ï¼Œåˆ™è§¦å‘ YGC ï¼Œæ‰§è¡Œåƒåœ¾å›æ”¶ï¼Œçœ‹çœ‹è¿˜èƒ½ä¸èƒ½æ”¾ä¸‹ï¼Ÿæ”¾å¾—ä¸‹æœ€å¥½å½“ç„¶æœ€å¥½å’¯~~~</li></ul></li><li>å°†å¯¹è±¡æ”¾åˆ°è€å¹´åŒºåˆæœ‰ä¸¤ç§æƒ…å†µï¼š <ul><li>å¦‚æœ Eden æ‰§è¡Œäº† YGC è¿˜æ˜¯æ— æ³•æ”¾ä¸ä¸‹è¯¥å¯¹è±¡ï¼Œé‚£æ²¡å¾—åŠæ³•ï¼Œåªèƒ½è¯´æ˜æ˜¯è¶…å¤§å¯¹è±¡ï¼Œåªèƒ½ç›´æ¥æ€¼åˆ°è€å¹´ä»£</li><li>é‚£ä¸‡ä¸€è€å¹´ä»£éƒ½æ”¾ä¸ä¸‹ï¼Œåˆ™å…ˆè§¦å‘é‡ GC ï¼Œå†çœ‹çœ‹èƒ½ä¸èƒ½æ”¾ä¸‹ï¼Œæ”¾å¾—ä¸‹æœ€å¥½ï¼Œä½†å¦‚æœè¿˜æ˜¯æ”¾ä¸ä¸‹ï¼Œé‚£åªèƒ½æŠ¥ OOM å•¦~~~</li></ul></li><li>å¦‚æœ Eden åŒºæ»¡äº†ï¼Œå°†å¯¹è±¡å¾€å¹¸å­˜åŒºæ‹·è´æ—¶ï¼Œå‘ç°å¹¸å­˜åŒºæ”¾ä¸ä¸‹å•¦ï¼Œé‚£åªèƒ½ä¾¿å®œäº†æŸäº›æ–°å¯¹è±¡ï¼Œè®©ä»–ä»¬ç›´æ¥æ™‹å‡è‡³è€å¹´åŒº</li></ul><figure><img src="/java-tips/assets/-ZYwK6WBVSnoJ_cniXSPy8M06fNaTMKbC28e5Zf9dvU-d52ec7c1.webp" alt="image" tabindex="0" loading="lazy"><figcaption>image</figcaption></figure><h3 id="jvmå¸¸ç”¨è°ƒä¼˜å·¥å…·" tabindex="-1"><a class="header-anchor" href="#jvmå¸¸ç”¨è°ƒä¼˜å·¥å…·" aria-hidden="true">#</a> JVMå¸¸ç”¨è°ƒä¼˜å·¥å…·</h3><ul><li>JDKå‘½ä»¤è¡Œ</li><li>Eclipseï¼šMemory Analyzer Tool</li><li>Jconsole</li><li>Visual VMï¼ˆå®æ—¶ç›‘æ§ æ¨è~ï¼‰</li><li>Jprofilerï¼ˆæ¨è~ï¼‰</li><li>Java Flight Recorderï¼ˆå®æ—¶ç›‘æ§ï¼‰</li><li>GCViewer</li><li>GCEasy</li></ul><h4 id="jprofiler-åŸºæœ¬ä½¿ç”¨" tabindex="-1"><a class="header-anchor" href="#jprofiler-åŸºæœ¬ä½¿ç”¨" aria-hidden="true">#</a> Jprofiler åŸºæœ¬ä½¿ç”¨</h4><p>åœ¨ IDEA ä¸­å¯åŠ¨ Jprofiler</p><figure><img src="data:image/webp;base64,UklGRtAMAABXRUJQVlA4IMQMAAAQSQCdASo1AkIAPm02lkikIqIhIlJ6oIANiWdu/HyYpts+8f0u8B8X/nMOO1o5h/3XsX/k/6d+4/86ewB+mPSZ8wH8e/tn6de756P/QA/sH+Z9I72N/2x9gD9HfTS/ZL4U/7Z/0vSC//+tA+O/7t2yf5Lwn8cXtP249UDEv10alnWX+k/t3t2/cv9f+Rnm3wAvVP+o31OyPoEezH0Pv0P8v0Q+tXsAfx3+z/q7yelAD+d/37/ienj/4+WX6e/Zz4Dv55/afTO9if7t+0J+2BC0QBI+kH+AkfSD/ASPmZGnoaOENjyOWAv3iEJvfDE1KBISoMEl3/B8fTj81gqSENt+FlvURUCEiujp/VWUo9QX/OyuQSJ9EVZaNYftn0rTMVBXN8/gCoSVKMBJfMaOvxzEeNWYPT+zgmNYSC7bflF0X8V2XCYkzFmsZFxMG24g6wkL6iIHNbzfx58GArcBQWAwWKBTXQSs96+i3a2GeW7EFW5ko+oivUjIucHx2ZP3lad6YdrsIHEEdHyj64lGNvfnpdT4CoqYRSMA8SCERfnQJPT+3uBGTZDg0VTIhhFfew3ZS+X/zoFbZOfohFb14d12apfAFQ6mBUmBgupgTKrfydLMAkFMoYJruIokOD9cYNPb5f6TQyT7n6x48T2eLuRuc9SYY4bm75CyZ5B8L9R0j+Pl4VG0TaQIyG4ySjk2guv159y0dezMKdkdcfXfwSFwpMbuya4Uwx5bnwYpnqvNPSryTyxQVCmLVww26ub84bdXN+cDPYvQC1W9EfwForcgAAD+/p8VD0K3jQdEAAAAkqehUnruhefeGPqJHHQ14VQfD18HxCtviGNUdA44GX3peWf4jON4WIMoo7hJtlRtNb0TfaCAligjLDsDfzAMPvMFpQlEemCH9+r983OH19vIaoWuKvFr6eBM51IqUFCAXs7xonzCcw17uFK+xhMao0N3PRrAqrYOxYcQYP4hA49WvyLHSqTW9Xd1tj867m9xGiHbAzwsyfH1JGUNbHrbp3Opyn5I/hkbS+XGfmgDiHaFLe+6W/MnLcZ0Up/l86pLerFERdUoV/qhQIVrOjtSqYgRcn00xjfgQ0BqjWSdpXDYQGDifpqy0Uy/WTDXp1pkN07eAFpAqwOcKAm/e5/ZzvPIcyuWtguGuy0NnBGpgQ8REsTBbHRMVyuYIKP3lGrV8bLUM36ViyympnUjWTJ+fFID4F4SqbpIMjaMPekb8u4DECkpG0t7P8UOOysBEPxf1B3/k+5o6v41gCa6D2WmTnevoXAqaQTT/1TjFHQduF/EIcfi9A0rwCWuBSjeocqhUT1Uv8+HC6HfHHFQ6eoAAltryIm2oWsklkjjkmoyo3jzIFb0vkLOw1ru8FP9piVdjzP49bUPgLKycqfpedDCrrH+7zov4uaJkHYm7Ng7JjlMhbaXYpIzvJpH6Zx3Nx3kHFdbEbP58f4+ktMlMgjM7FShUlAOiNmXDC71n7Jy7bS357SMZHyOgoODjwoS4RPi587ry5+9qAr2ENDqrtTDgZ1asnqda4C1Z0Qrku8i9s71UAtQnXZXZczj0xOQGhvEVOA2nqWySqmVSNGJKIrsL1ApjFAYV/94p6UzUwMs3FtEY7xRqCoh4zsvRa10NGId9ud3qsc/3D7Zzig2zee+xXdvQbhM+QWmbqevqUzygywe+75Kj/Ls8atagAhyRikl7flvHBUS764YxD2A0E96zQFiXVuTFLHF7wnRLiQOZl8OcVM4BRKRlL5G1//hHSsjPitElOz+/sO3tXRnu596QLBxWqdLZRFEX+8D6nKhtENpO+zXXooDpaD2CgW7J7z3Y5UdoYbmO/fWMe/U0t6ragE9KOKe1dCPLNre//cLDRGCmzR+Z5A2rPZtDzqSbVRgfi/MBGX2RaIbSjHRzzR6HOoFnfB9OEBlKZg/nAKTHJ3hXcRmne981/1fGZh3/xcK8tXh/Ktv2dxmkWQkDSvLWvJ5XiqurJ2hJFGZEx6P0QYxtOsMb8g1m7tuZ+sFo3B5t7Hn/MLVqMvv9/uhzrDvMqoxJVb3kigB0hflWP+3cJgDXolisH7Vl4mEFec6OdG7cmHdPDVHcc1xqpYec+p8/cWuKMDEyaa1AbTGQryk9BOe0Xuwq3umUm8cQulqjeO8p1byC8tmWYyRYb1KHifUESPR1cr7Ad7HNar4CqqTzSOsr9iO4k/k6hD+kh5SAeVx1sFZVWFNImlC1kqP99jR5CKKFq/Fh8yXVeXsRuVnQWMKg3NjNji6M4ILcQdgeeb+4AnvD+219dmjFRQ+v2kcW1z8zk3m4R2O3hv/m8xjGn6Qx+LMHuv4N1OJ2vcFx07T/byKYXTUao2/+hKsqqPu/qMaGc5vYQEePKkkQcL1Q4RCsAmFADDC0xaYGDKPF/Wp2sV0ZGix6eLH6iMtEgUtOOWWPk1n0z2pvwer4ljyNSths0PCNH6ToMcUE+/FP9lfNMog8oWI963AM79Rco+ys/c4+PtE3l1pMNWTi8hEI2Tsa3KpbZHdP/w2ScCxSy0zp2AUJsg9CMnTHFJd3vbnF1l/B+XqN+xmejKTEm1C5vXkxj0ioPotJ7Qcu/9ml1EQpQBfZlrm55Xt378W9zVzJXAEMV2d04oeyD6iOtThZ2xGe1+4YAzqyJRLqjw4LMoD+qKnEIlRJ4CwPWMkvRozOdNAhQq1DAJeXnALuL21kycBoUNx76XE+8i3C41NSIJndvJAOkl2Bb0PDHR3KVMrNeXoC2CMGxJXC/jL3Y78G6Bzr7n3q1gOsKw0zEdv3JQxR57JoYZDfq+xxjQrkrclWUid1BZ167Kx9YefNbj421ClwLcAtWbPTb8Iv0bBTdHQyDn+0UsMpATSs7jg2PvpkxHpn4pXrHa25x8DmSebqWsAqSVOLh3aJUeJGmM5c1V6jKrTlFm9BQcIqFiKkU8Okt62bEnwHTsE/99YSQi3cI3QAfe2ZKXE6GYmKlDdvxxfXnw+Id45ShUcz0S4AlaBfa70Blq0k8AwGaYy3CrF9yZaSA0BCV6B/a+Dmdsn4tITaigyFBx6VRxQJouuGvaCnfeYAFiXFtFrTSwQFOqN9AP+R4poGUnvaYo00M8xxmEG6wyOmv3nBfsaYEqM5e7vqmNPsnJyfR3+BbbYHOQa0zF4tAPhtzmDdBRL/BlSPtqFCS42x/WIAsPeuX+8FdthgDJE2K+84Bd7nzTJODqA6LUoe9bxMKy6D16/+3b9g5DJdSb9ikgS5h9rkuI2q/gFIym6xa34Lik7lGbUjv58+PWW6CBYSmhceSeTLIOKeeDuoe5mtg20Pk788nIh9oQhPObrufk9dwc9wqr9F7Vg/INq6lE7tvPKjgH/cu2I4jXi70bmgMPNU1zKvbjdg6UVeu6pbeKUlqIx4oOqkWEPKZ13eijW91aQKk5cxwZoSprxuEGvoTNaCLFHfcnSPnWEOc3ui0Klr2vEK3C4zysAqoxBI+Vh0ON8mCKNpggVccrJ2FFtg203N8YUl+xOUD6UtuViN1VXG9ac6IkTv3USwgrvJC1M3Adzdzu3Gbz43rw3+ssf5vNsnTxh6nbdqny6/qBVIE+1CLbLjrn5bc/J6Ee2+/PDgoLPBDpA7SOEa1UAWCwedGluCScR1z4EB+M4CR/59D3P1PnNG7SqRJO68d08R5uTtU1QjBklXUhxSP6YIHPDQMgTx+3xeTnARNT7eX4TwdRtDq6rNMlOMd38ILsuWsTVHfFMbzA5luO7idlNpx7v4XKp9Zwp/e0rfu9alavpIbyGkXTkFwN2Yl2es8lDRrztvkplKgC6y7IeIyGoeyX4zlV71FhXodLz7+yL8lhFXTVqPbp+SgJsIO0XEUy6BkaAkVvC64JLDp7xlTQ61GL0wl/RV/LTyk7saEJ/fiGs+7wdzzxTEvHz9X0UwfpiWzDYtRifhB2iJh9go2tNGPi/W5JGvOeWKIqYK26R4aPGG1LFnNTFNU/5L0Wki4bYzls+5OQCuLJriyGLmU24zJkW6UFtkk2Oj6UoRYVSvvmd6d5qwBElM+Dxjwd4b31wkbJ1E26Ax5abP3xMy4bxOay3ZdpCCc7yrqYFec+1DYdQ5tilH81FbolTZYvJYVebcqhgilxyQy5SeXB85ZrR8oaz5idKPR2QK/uiMNOEhXh+IpTb2rabJmqnAr0Cx6neqqe9jzfZ+1WaO8sO06wtBmU+QD1MpQgmOwcJ/u5j9kyPRUwmt36WaCh7/fNbIJS5fKzzx3IZXVBbGB/IAAAAAAAJ8EfB7NLgJJAyVw/tsogUXr2DfhmxvlAAVbYzXcoFq2xmdX2CtDZ0JpV/ssB8Iu2pHPEqB0biwR1Uf+EvsKc3NAAA" alt="image" tabindex="0" loading="lazy"><figcaption>image</figcaption></figure><ul><li>ç‚¹å‡» Instrumentation</li></ul><figure><img src="/java-tips/assets/IHk51nmXSpQsxnjMeCCYKQe6cJK-AX3ZasyKa-p4XDQ-312f3b76.webp" alt="image" tabindex="0" loading="lazy"><figcaption>image</figcaption></figure><h3 id="æ€»ç»“" tabindex="-1"><a class="header-anchor" href="#æ€»ç»“" aria-hidden="true">#</a> æ€»ç»“</h3><ul><li>é’ˆå¯¹å¹¸å­˜è€…åŒºs0, s1ï¼šå¤åˆ¶ä¹‹åæœ‰äº¤æ¢ï¼Œè°ç©ºè°æ˜¯to</li><li>å…³äºåƒåœ¾å›æ”¶ï¼šé¢‘ç¹åœ¨æ–°ç”ŸåŒºæ”¶é›†ï¼Œå¾ˆå°‘åœ¨å…»è€åŒºæ”¶é›†ï¼Œå‡ ä¹ä¸åœ¨æ°¸ä¹…åŒº/å…ƒç©ºé—´æ”¶é›†</li><li>æ–°ç”Ÿä»£é‡‡ç”¨å¤åˆ¶ç®—æ³•çš„ç›®çš„ï¼šæ˜¯ä¸ºäº†å‡å°‘å†…ç¢ç‰‡</li></ul><h1 id="gcåƒåœ¾å›æ”¶å™¨" tabindex="-1"><a class="header-anchor" href="#gcåƒåœ¾å›æ”¶å™¨" aria-hidden="true">#</a> GCåƒåœ¾å›æ”¶å™¨</h1><h2 id="åˆ†ä»£æ”¶é›†æ€æƒ³-é¢è¯•å¿…é—®" tabindex="-1"><a class="header-anchor" href="#åˆ†ä»£æ”¶é›†æ€æƒ³-é¢è¯•å¿…é—®" aria-hidden="true">#</a> åˆ†ä»£æ”¶é›†æ€æƒ³(é¢è¯•å¿…é—®)</h2><blockquote><p>Minor GCã€Major GCã€Full GC</p></blockquote><p>æˆ‘ä»¬éƒ½çŸ¥é“ï¼ŒJVMè°ƒä¼˜çš„ä¸€ä¸ªç¯èŠ‚ï¼Œä¹Ÿå°±æ˜¯åƒåœ¾æ”¶é›†ï¼Œæˆ‘ä»¬éœ€è¦å°½é‡çš„é¿å…åƒåœ¾å›æ”¶ï¼Œå› ä¸ºåœ¨åƒåœ¾å›æ”¶çš„è¿‡ç¨‹ä¸­ï¼Œå®¹æ˜“å‡ºç°STWï¼ˆStop the Worldï¼‰çš„é—®é¢˜ï¼Œ<strong>è€Œ Major GC å’Œ Full GCå‡ºç°STWçš„æ—¶é—´ï¼Œæ˜¯Minor GCçš„10å€ä»¥ä¸Š</strong></p><p>JVMåœ¨è¿›è¡ŒGCæ—¶ï¼Œå¹¶éæ¯æ¬¡éƒ½å¯¹ä¸Šé¢ä¸‰ä¸ªå†…å­˜( æ–°ç”Ÿä»£ã€è€å¹´ä»£ï¼›æ–¹æ³•åŒº )åŒºåŸŸä¸€èµ·å›æ”¶çš„ï¼Œå¤§éƒ¨åˆ†æ—¶å€™å›æ”¶çš„éƒ½æ˜¯æŒ‡<code>æ–°ç”Ÿä»£</code>ã€‚é’ˆå¯¹Hotspot VMçš„å®ç°ï¼Œå®ƒé‡Œé¢çš„GCæŒ‰ç…§å›æ”¶åŒºåŸŸåˆåˆ†ä¸ºä¸¤å¤§ç§ç±»å‹ï¼šä¸€ç§æ˜¯éƒ¨åˆ†æ”¶é›†ï¼ˆPartial GCï¼‰ï¼Œä¸€ç§æ˜¯æ•´å †æ”¶é›†ï¼ˆFullGCï¼‰</p><ul><li>éƒ¨åˆ†æ”¶é›†ï¼šä¸æ˜¯å®Œæ•´æ”¶é›†æ•´ä¸ªJavaå †çš„åƒåœ¾æ”¶é›†ã€‚å…¶ä¸­åˆåˆ†ä¸ºï¼š <ul><li><strong>æ–°ç”Ÿä»£æ”¶é›†</strong>ï¼ˆ Minor GC/Young GC ï¼‰ï¼šåªæ˜¯æ–°ç”Ÿä»£( Edenã€S0/S1 )çš„åƒåœ¾æ”¶é›†</li><li>è€å¹´ä»£æ”¶é›†ï¼ˆ Major GC/Old GC ï¼‰ï¼šåªæ˜¯è€å¹´ä»£çš„åƒåœ¾æ”¶é›†ã€‚ <ul><li>ç›®å‰ï¼Œ<code>åªæœ‰CMS GCä¼šæœ‰å•ç‹¬æ”¶é›†è€å¹´ä»£çš„è¡Œä¸º</code>ã€‚</li><li>æ³¨æ„ï¼Œå¾ˆå¤šæ—¶å€™Major GCä¼šå’ŒFull GCæ··æ·†ä½¿ç”¨ï¼Œéœ€è¦å…·ä½“åˆ†è¾¨æ˜¯<strong>è€å¹´ä»£å›æ”¶è¿˜æ˜¯æ•´å †å›æ”¶</strong>ã€‚</li></ul></li><li>æ··åˆæ”¶é›†ï¼ˆMixed GCï¼‰ï¼šæ”¶é›†æ•´ä¸ªæ–°ç”Ÿä»£ä»¥åŠéƒ¨åˆ†è€å¹´ä»£çš„åƒåœ¾æ”¶é›†ã€‚ <ul><li>ç›®å‰ï¼Œåªæœ‰G1 GCä¼šæœ‰è¿™ç§è¡Œä¸º</li></ul></li></ul></li><li><strong>æ•´å †æ”¶é›†</strong>ï¼ˆFull GCï¼‰ï¼šæ”¶é›†æ•´ä¸ªjavaå †å’Œæ–¹æ³•åŒºçš„åƒåœ¾æ”¶é›†ã€‚</li></ul><h2 id="young-minor-gc" tabindex="-1"><a class="header-anchor" href="#young-minor-gc" aria-hidden="true">#</a> Young/Minor GC</h2><blockquote><p>å¹´è½»ä»£ GCï¼ˆMinor GCï¼‰è§¦å‘æœºåˆ¶</p></blockquote><ul><li>å½“å¹´è½»ä»£ç©ºé—´ä¸è¶³æ—¶ï¼Œå°±ä¼šè§¦å‘Minor GCï¼Œè¿™é‡Œçš„å¹´è½»ä»£æ»¡æŒ‡çš„æ˜¯<code>EdenåŒºæ»¡</code>ï¼ŒSurvivoråŒºæ»¡ä¸ä¼šè§¦å‘GCã€‚ï¼ˆæ¯æ¬¡Minor GCä¼šæ¸…ç†å¹´è½»ä»£çš„å†…å­˜ï¼‰</li><li>å› ä¸ºJavaå¯¹è±¡å¤§å¤šéƒ½å…·å¤‡æœç”Ÿå¤•ç­çš„ç‰¹æ€§ï¼Œæ‰€ä»¥<strong>Minor GCéå¸¸é¢‘ç¹</strong>ï¼Œä¸€èˆ¬å›æ”¶é€Ÿåº¦ä¹Ÿæ¯”è¾ƒå¿«ã€‚è¿™ä¸€å®šä¹‰æ—¢æ¸…æ™°åˆæ˜“äºç†è§£ã€‚</li><li>Minor GCä¼šå¼•å‘<code>STW</code>ï¼Œ<code>æš‚åœå…¶å®ƒç”¨æˆ·çš„çº¿ç¨‹ï¼Œç­‰å¾…åƒåœ¾å›æ”¶çº¿ç¨‹ç»“æŸï¼Œç”¨æˆ·çº¿ç¨‹æ‰æ¢å¤è¿è¡Œ</code></li></ul><figure><img src="/java-tips/assets/3YyIM3EyKSvJ53g6sa-2VKqX3jBdWDKyhp-mFjX2-e4-1c3a477f.webp" alt="image" tabindex="0" loading="lazy"><figcaption>image</figcaption></figure><h2 id="major-gc" tabindex="-1"><a class="header-anchor" href="#major-gc" aria-hidden="true">#</a> Major GC</h2><blockquote><p>è€å¹´ä»£ GCï¼ˆMajorGC/Full GCï¼‰è§¦å‘æœºåˆ¶</p></blockquote><ul><li>æŒ‡å‘ç”Ÿåœ¨è€å¹´ä»£çš„GCï¼Œå¯¹è±¡ä»è€å¹´ä»£æ¶ˆå¤±æ—¶ï¼Œæˆ‘ä»¬è¯´ â€œMajor Gcâ€ æˆ– â€œFull GCâ€ å‘ç”Ÿäº†</li><li>å‡ºç°äº†MajorGcï¼Œç»å¸¸ä¼šä¼´éšè‡³å°‘ä¸€æ¬¡çš„Minor GC <ul><li>ä½†éç»å¯¹çš„ï¼Œåœ¨Parallel Scavengeæ”¶é›†å™¨çš„æ”¶é›†ç­–ç•¥é‡Œå°±æœ‰ç›´æ¥è¿›è¡ŒMajor GCçš„ç­–ç•¥é€‰æ‹©è¿‡ç¨‹</li><li>ä¹Ÿå°±æ˜¯åœ¨è€å¹´ä»£ç©ºé—´ä¸è¶³æ—¶ï¼Œä¼šå…ˆå°è¯•è§¦å‘Minor GCï¼Œå¦‚æœä¹‹åç©ºé—´è¿˜ä¸è¶³ï¼Œåˆ™è§¦å‘Major GC</li></ul></li><li><strong>Major GCçš„é€Ÿåº¦ä¸€èˆ¬ä¼šæ¯”Minor GCæ…¢10å€ä»¥ä¸Š</strong>ï¼ŒSTWçš„æ—¶é—´æ›´é•¿</li><li>å¦‚æœMajor GCåï¼Œå†…å­˜è¿˜ä¸è¶³ï¼Œå°±æŠ¥OOMäº†</li></ul><h2 id="full-gc" tabindex="-1"><a class="header-anchor" href="#full-gc" aria-hidden="true">#</a> Full GC</h2><blockquote><p>Full GC è§¦å‘æœºåˆ¶</p></blockquote><p><strong>è§¦å‘Full GCæ‰§è¡Œçš„æƒ…å†µæœ‰å¦‚ä¸‹äº”ç§ï¼š</strong></p><ul><li>è°ƒç”¨System.gc( )æ—¶ï¼Œç³»ç»Ÿå»ºè®®æ‰§è¡ŒFull GCï¼Œä½†æ˜¯ä¸å¿…ç„¶æ‰§è¡Œ</li><li>è€å¹´ä»£ç©ºé—´ä¸è¶³</li><li>æ–¹æ³•åŒºç©ºé—´ä¸è¶³</li><li><strong>é€šè¿‡Minor GCåè¿›å…¥è€å¹´ä»£çš„å¹³å‡å¤§å° å¤§äº è€å¹´ä»£çš„å¯ç”¨å†…å­˜</strong></li><li>ç”±EdenåŒºã€survivor space0ï¼ˆFrom Spaceï¼‰åŒº å‘survivor space1ï¼ˆTo Spaceï¼‰åŒºå¤åˆ¶æ—¶ï¼Œå¯¹è±¡å¤§å°å¤§äºTo Spaceå¯ç”¨å†…å­˜ï¼Œåˆ™æŠŠè¯¥å¯¹è±¡è½¬å­˜åˆ°è€å¹´ä»£ï¼Œä¸”è€å¹´ä»£çš„å¯ç”¨å†…å­˜ å°äº è¯¥å¯¹è±¡å¤§å°</li></ul><p>è¯´æ˜ï¼š<code>Full GC æ˜¯å¼€å‘æˆ–è°ƒä¼˜ä¸­å°½é‡è¦é¿å…çš„ã€‚è¿™æ ·STWæ—¶é—´ä¼šçŸ­ä¸€äº›</code></p><h2 id="gc-æ—¥å¿—åˆ†æ" tabindex="-1"><a class="header-anchor" href="#gc-æ—¥å¿—åˆ†æ" aria-hidden="true">#</a> GC æ—¥å¿—åˆ†æ</h2><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token doc-comment comment">/**
 * æµ‹è¯•MinorGCã€MajorGCã€FullGC
 * -Xms9m -Xmx9m -XX:+PrintGCDetails
 */</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">GCTest</span> <span class="token punctuation">{</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> list <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">String</span> a <span class="token operator">=</span> <span class="token string">&quot;zhiyucs.cn&quot;</span><span class="token punctuation">;</span>
            <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                list<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">;</span>
                a <span class="token operator">=</span> a <span class="token operator">+</span> a<span class="token punctuation">;</span>
                i<span class="token operator">++</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Throwable</span> t<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            t<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;éå†æ¬¡æ•°ä¸ºï¼š&quot;</span> <span class="token operator">+</span> i<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>VMå‚æ•°è®¾ç½®ï¼š</p><blockquote><p>-Xms9m -Xmx9m -XX:+PrintGCDetails</p></blockquote><figure><img src="/java-tips/assets/q-SgwHuBhDFopoipowGGDQw4kCyJgeIgw3SqsNlVrVI-e6ee5050.webp" alt="image" tabindex="0" loading="lazy"><figcaption>image</figcaption></figure><blockquote><p>[Full GC (Allocation Failure) [PSYoungGen: 460K-&gt;0K(2560K)] [ParOldGen: 5688K-&gt;4468K(7168K)] 6148K-&gt;4468K(9728K), [Metaspace: 3312K-&gt;3312K(1056768K)], 0.0056846 secs] [Times: user=0.00 sys=0.00, real=0.01 secs]</p></blockquote><ul><li>[PSYoungGen: 460K-&gt;0K(2560K)] ï¼šå¹´è½»ä»£æ€»ç©ºé—´ä¸º 2560K ï¼Œå½“å‰å ç”¨ 460K ï¼Œç»è¿‡åƒåœ¾å›æ”¶åå ç”¨ 0K</li><li>[ParOldGen: 5688K-&gt;4468K(7168K)] ï¼šè€å¹´ä»£æ€»ç©ºé—´ä¸º 7168K ï¼Œå½“å‰å ç”¨ 5688K ï¼Œç»è¿‡åƒåœ¾å›æ”¶åå ç”¨ 4468K</li><li>8102K-&gt;4864K(9728K)ï¼šå †å†…å­˜æ€»ç©ºé—´ä¸º 9728K ï¼Œå½“å‰å ç”¨ 8102K ï¼Œç»è¿‡åƒåœ¾å›æ”¶åå ç”¨ 4864K</li><li>[Metaspace: 3312K-&gt;3312K(1056768K)] ï¼šå…ƒç©ºé—´æ€»ç©ºé—´ä¸º 1056768K ï¼Œå½“å‰å ç”¨ 3312Kï¼Œç»è¿‡åƒåœ¾å›æ”¶åå ç”¨ 3312K</li><li>0.0050464 secs ï¼šåƒåœ¾å›æ”¶ç”¨æ—¶ 0.0050464 secs</li></ul><h1 id="å †ç©ºé—´åˆ†é…æ€æƒ³" tabindex="-1"><a class="header-anchor" href="#å †ç©ºé—´åˆ†é…æ€æƒ³" aria-hidden="true">#</a> å †ç©ºé—´åˆ†é…æ€æƒ³</h1><blockquote><p>ä¸ºä»€ä¹ˆè¦æŠŠJavaå †åˆ†ä»£ï¼Ÿä¸åˆ†ä»£å°±ä¸èƒ½æ­£å¸¸å·¥ä½œäº†å—ï¼Ÿ</p></blockquote><ul><li>ç»ç ”ç©¶ï¼Œä¸åŒå¯¹è±¡çš„ç”Ÿå‘½å‘¨æœŸä¸åŒã€‚70%-99%çš„å¯¹è±¡æ˜¯ä¸´æ—¶å¯¹è±¡ã€‚ <ul><li>æ–°ç”Ÿä»£ï¼šæœ‰Edenã€ä¸¤å—å¤§å°ç›¸åŒçš„Survivorï¼ˆåˆç§°ä¸ºfrom/toï¼Œs0/s1ï¼‰æ„æˆï¼Œtoæ€»ä¸ºç©ºã€‚</li><li>è€å¹´ä»£ï¼šå­˜æ”¾æ–°ç”Ÿä»£ä¸­ç»å†å¤šæ¬¡GCä¹‹åä»ç„¶å­˜æ´»çš„å¯¹è±¡ã€‚</li></ul></li><li>å…¶å®ä¸åˆ†ä»£å®Œå…¨å¯ä»¥ï¼Œ<strong>åˆ†ä»£çš„å”¯ä¸€ç†ç”±<strong><strong>å°±æ˜¯</strong></strong>ä¼˜åŒ–GCæ€§èƒ½</strong>ã€‚ <ul><li>å¦‚æœæ²¡æœ‰åˆ†ä»£ï¼Œé‚£æ‰€æœ‰çš„å¯¹è±¡éƒ½åœ¨ä¸€å—ï¼Œå°±å¦‚åŒæŠŠä¸€ä¸ªå­¦æ ¡çš„äººéƒ½å…³åœ¨ä¸€ä¸ªæ•™å®¤ã€‚GCçš„æ—¶å€™è¦æ‰¾åˆ°å“ªäº›å¯¹è±¡æ²¡ç”¨ï¼Œè¿™æ ·å°±ä¼šå¯¹å †çš„æ‰€æœ‰åŒºåŸŸè¿›è¡Œæ‰«æã€‚</li><li>è€Œå¾ˆå¤šå¯¹è±¡éƒ½æ˜¯æœç”Ÿå¤•æ­»çš„ï¼Œå¦‚æœåˆ†ä»£çš„è¯ï¼ŒæŠŠæ–°åˆ›å»ºçš„å¯¹è±¡æ”¾åˆ°æŸä¸€åœ°æ–¹ï¼Œå½“GCçš„æ—¶å€™å…ˆæŠŠè¿™å—å­˜å‚¨â€œæœç”Ÿå¤•æ­»â€å¯¹è±¡çš„åŒºåŸŸè¿›è¡Œå›æ”¶ï¼Œè¿™æ ·å°±ä¼šè…¾å‡ºå¾ˆå¤§çš„ç©ºé—´å‡ºæ¥ã€‚</li></ul></li></ul><h1 id="å†…å­˜åˆ†é…ç­–ç•¥" tabindex="-1"><a class="header-anchor" href="#å†…å­˜åˆ†é…ç­–ç•¥" aria-hidden="true">#</a> å†…å­˜åˆ†é…ç­–ç•¥</h1><blockquote><p>å†…å­˜åˆ†é…ç­–ç•¥æˆ–å¯¹è±¡æå‡ï¼ˆPromotionï¼‰è§„åˆ™</p></blockquote><ul><li>å¦‚æœå¯¹è±¡åœ¨Edenå‡ºç”Ÿå¹¶ç»è¿‡ç¬¬ä¸€æ¬¡Minor GCåä»ç„¶å­˜æ´»ï¼Œå¹¶ä¸”èƒ½è¢«Survivorå®¹çº³çš„è¯ï¼Œå°†è¢«ç§»åŠ¨åˆ°Survivorç©ºé—´ä¸­ï¼Œå¹¶å°†å¯¹è±¡å¹´é¾„è®¾ä¸º1ã€‚</li><li>å¯¹è±¡åœ¨SurvivoråŒºä¸­æ¯ç†¬è¿‡ä¸€æ¬¡MinorGCï¼Œå¹´é¾„å°±å¢åŠ 1å²ï¼Œå½“å®ƒçš„å¹´é¾„å¢åŠ åˆ°ä¸€å®šç¨‹åº¦ï¼ˆé»˜è®¤ä¸º15å²ï¼Œå…¶å®æ¯ä¸ªJVMã€æ¯ä¸ªGCéƒ½æœ‰æ‰€ä¸åŒï¼‰æ—¶ï¼Œå°±ä¼šè¢«æ™‹å‡åˆ°è€å¹´ä»£</li><li>å¯¹è±¡æ™‹å‡è€å¹´ä»£çš„å¹´é¾„é˜€å€¼ï¼Œå¯ä»¥é€šè¿‡é€‰é¡¹**-XX:MaxTenuringThreshold**æ¥è®¾ç½®</li></ul><hr><p>é’ˆå¯¹ä¸åŒå¹´é¾„æ®µçš„å¯¹è±¡åˆ†é…åŸåˆ™å¦‚ä¸‹æ‰€ç¤ºï¼š</p><ul><li><strong>ä¼˜å…ˆåˆ†é…åˆ°Eden</strong></li><li><strong>å¤§å¯¹è±¡ç›´æ¥åˆ†é…åˆ°è€å¹´ä»£</strong>ï¼š <ul><li>å°½é‡é¿å…ç¨‹åºä¸­å‡ºç°è¿‡å¤šçš„å¤§å¯¹è±¡</li></ul></li><li><strong>é•¿æœŸå­˜æ´»çš„å¯¹è±¡åˆ†é…åˆ°è€å¹´ä»£</strong></li><li>åŠ¨æ€å¯¹è±¡å¹´é¾„åˆ¤æ–­ï¼š <ul><li>å¦‚æœSurvivoråŒºä¸­ç›¸åŒå¹´é¾„çš„æ‰€æœ‰å¯¹è±¡å¤§å°çš„æ€»å’Œ <code>å¤§äº</code> Survivorç©ºé—´çš„ä¸€åŠï¼Œå¹´é¾„å¤§äºæˆ–ç­‰äºè¯¥å¹´é¾„çš„å¯¹è±¡å¯ä»¥ç›´æ¥è¿›å…¥è€å¹´ä»£ï¼Œæ— é¡»ç­‰åˆ°<code>MaxTenuringThreshold</code>ä¸­è¦æ±‚çš„å¹´é¾„ã€‚</li></ul></li><li>ç©ºé—´åˆ†é…æ‹…ä¿ï¼š <ul><li>-XX:HandlePromotionFailure ï¼Œä¹Ÿå°±æ˜¯ç»è¿‡Minor GCåï¼Œæ‰€æœ‰çš„å¯¹è±¡éƒ½å­˜æ´»ï¼Œå› ä¸ºSurvivoræ¯”è¾ƒå°ï¼Œæ‰€ä»¥å°±éœ€è¦å°†Survivoræ— æ³•å®¹çº³çš„å¯¹è±¡ï¼Œå­˜æ”¾åˆ°è€å¹´ä»£ä¸­ã€‚</li></ul></li></ul><blockquote><p>ä»£ç å¦‚ä¸‹</p></blockquote><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token doc-comment comment">/**
 * æµ‹è¯•ï¼šå¤§å¯¹è±¡ç›´æ¥è¿›å…¥è€å¹´ä»£
 * -Xms60m -Xmx60m -XX:NewRatio=2 -XX:SurvivorRatio=8 -XX:+PrintGCDetails
 */</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">YoungOldAreaTest</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> buffer <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token number">1024</span> <span class="token operator">*</span> <span class="token number">1024</span> <span class="token operator">*</span> <span class="token number">20</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">//20m</span>

    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><blockquote><p>VMå‚æ•°</p></blockquote><p>-Xms60m -Xmx60m -XX:NewRatio=2 -XX:SurvivorRatio=8 -XX:+PrintGCDetails</p><blockquote><p>ç»“æœ</p></blockquote><p>æ•´ä¸ªè¿‡ç¨‹å¹¶æ²¡æœ‰è¿›è¡Œåƒåœ¾å›æ”¶ï¼Œå¹¶ä¸” ParOldGen åŒºç›´æ¥å ç”¨äº† 20MB çš„ç©ºé—´ï¼Œè¯´æ˜å¤§å¯¹è±¡ç›´æ¥æ€¼åˆ°äº†è€å¹´ä»£ä¸­</p><figure><img src="/java-tips/assets/SBzMAqDvFgz1bOFw2k53PcAe52ICJ6E7vo-raqopZBg-c51a9ae3.webp" alt="image" tabindex="0" loading="lazy"><figcaption>image</figcaption></figure><h1 id="ä¸ºå¯¹è±¡åˆ†é…å†…å­˜-tlab" tabindex="-1"><a class="header-anchor" href="#ä¸ºå¯¹è±¡åˆ†é…å†…å­˜-tlab" aria-hidden="true">#</a> ä¸ºå¯¹è±¡åˆ†é…å†…å­˜: TLAB</h1><h2 id="ä¸ºä»€ä¹ˆæœ‰-tlab" tabindex="-1"><a class="header-anchor" href="#ä¸ºä»€ä¹ˆæœ‰-tlab" aria-hidden="true">#</a> ä¸ºä»€ä¹ˆæœ‰ TLAB</h2><blockquote><p>é—®é¢˜ï¼šå †ç©ºé—´éƒ½æ˜¯å…±äº«çš„ä¹ˆï¼Ÿ</p></blockquote><p>ä¸ä¸€å®šï¼Œå› ä¸ºè¿˜æœ‰TLABè¿™ä¸ªæ¦‚å¿µï¼Œåœ¨å †ä¸­åˆ’åˆ†å‡ºä¸€å—åŒºåŸŸï¼Œä¸ºæ¯ä¸ªçº¿ç¨‹æ‰€ç‹¬å </p><blockquote><p>ä¸ºä»€ä¹ˆæœ‰TLABï¼ˆThread Local Allocation Bufferï¼‰ï¼Ÿ</p></blockquote><ul><li>TLABï¼šThread Local Allocation Bufferï¼Œä¹Ÿå°±æ˜¯ä¸ºæ¯ä¸ªçº¿ç¨‹å•ç‹¬åˆ†é…äº†ä¸€ä¸ªç¼“å†²åŒº</li><li>å †åŒºæ˜¯çº¿ç¨‹å…±äº«åŒºåŸŸï¼Œä»»ä½•çº¿ç¨‹éƒ½å¯ä»¥è®¿é—®åˆ°å †åŒºä¸­çš„å…±äº«æ•°æ®</li><li>ç”±äºå¯¹è±¡å®ä¾‹çš„åˆ›å»ºåœ¨JVMä¸­éå¸¸é¢‘ç¹ï¼Œå› æ­¤åœ¨å¹¶å‘ç¯å¢ƒä¸‹ä»å †åŒºä¸­åˆ’åˆ†å†…å­˜ç©ºé—´æ˜¯çº¿ç¨‹ä¸å®‰å…¨çš„</li><li>ä¸ºé¿å…å¤šä¸ªçº¿ç¨‹æ“ä½œåŒä¸€åœ°å€ï¼Œéœ€è¦ä½¿ç”¨<strong>åŠ é”ç­‰æœºåˆ¶</strong>ï¼Œè¿›è€Œå½±å“åˆ†é…é€Ÿåº¦ã€‚</li></ul><h2 id="ä»€ä¹ˆæ˜¯-tlab" tabindex="-1"><a class="header-anchor" href="#ä»€ä¹ˆæ˜¯-tlab" aria-hidden="true">#</a> ä»€ä¹ˆæ˜¯ TLAB</h2><ul><li>ä»å†…å­˜æ¨¡å‹è€Œä¸æ˜¯åƒåœ¾æ”¶é›†çš„è§’åº¦ï¼Œå¯¹EdenåŒºåŸŸç»§ç»­è¿›è¡Œåˆ’åˆ†ï¼Œ<strong>JVMä¸º<strong><strong>æ¯ä¸ªçº¿ç¨‹åˆ†é…äº†ä¸€ä¸ªç§æœ‰ç¼“å­˜åŒºåŸŸ</strong></strong>ï¼Œå®ƒåŒ…å«åœ¨Edenç©ºé—´å†…</strong>ã€‚</li><li>å¤šçº¿ç¨‹åŒæ—¶åˆ†é…å†…å­˜æ—¶ï¼Œ<strong>ä½¿ç”¨TLABå¯ä»¥<strong><strong>é¿å…ä¸€ç³»åˆ—çš„éçº¿ç¨‹å®‰å…¨é—®é¢˜</strong></strong>ï¼ŒåŒæ—¶è¿˜èƒ½å¤Ÿæå‡å†…å­˜åˆ†é…çš„ååé‡</strong>ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥å°†è¿™ç§å†…å­˜åˆ†é…æ–¹å¼ç§°ä¹‹ä¸º<strong>å¿«é€Ÿåˆ†é…ç­–ç•¥</strong>ã€‚</li><li>æ®æˆ‘æ‰€çŸ¥æ‰€æœ‰OpenJDKè¡ç”Ÿå‡ºæ¥çš„JVMéƒ½æä¾›äº†TLABçš„è®¾è®¡ã€‚</li></ul><figure><img src="/java-tips/assets/JgX5ocf5_kqRVoPXSwDwUHKncYw20jpVQLJI-qeQ8OE-aaaf880d.webp" alt="image" tabindex="0" loading="lazy"><figcaption>image</figcaption></figure><h2 id="tlab-åˆ†é…è¿‡ç¨‹" tabindex="-1"><a class="header-anchor" href="#tlab-åˆ†é…è¿‡ç¨‹" aria-hidden="true">#</a> TLAB åˆ†é…è¿‡ç¨‹</h2><ul><li>å°½ç®¡ä¸æ˜¯æ‰€æœ‰çš„å¯¹è±¡å®ä¾‹éƒ½èƒ½å¤Ÿåœ¨TLABä¸­æˆåŠŸåˆ†é…å†…å­˜ï¼Œä½†<strong>JVMç¡®å®æ˜¯å°†TLABä½œä¸ºå†…å­˜åˆ†é…çš„é¦–é€‰</strong>ã€‚</li><li>åœ¨ç¨‹åºä¸­ï¼Œå¼€å‘äººå‘˜å¯ä»¥é€šè¿‡é€‰é¡¹â€œ<strong>-XX:UseTLAB</strong>â€è®¾ç½®æ˜¯å¦å¼€å¯TLABç©ºé—´ã€‚</li><li>é»˜è®¤æƒ…å†µä¸‹ï¼ŒTLABç©ºé—´çš„å†…å­˜éå¸¸å°ï¼Œ<code>ä»…å æœ‰æ•´ä¸ªEdenç©ºé—´çš„1%</code>ï¼Œå½“ç„¶æˆ‘ä»¬å¯ä»¥é€šè¿‡é€‰é¡¹â€œ<strong>-XX:TLABWasteTargetPercent</strong>â€è®¾ç½®TLABç©ºé—´æ‰€å ç”¨Edenç©ºé—´çš„ç™¾åˆ†æ¯”å¤§å°ã€‚</li><li>ä¸€æ—¦å¯¹è±¡åœ¨TLABç©ºé—´åˆ†é…å†…å­˜å¤±è´¥æ—¶ï¼ŒJVMå°±ä¼šå°è¯•ç€é€šè¿‡<strong>ä½¿ç”¨åŠ é”æœºåˆ¶****ç¡®ä¿æ•°æ®æ“ä½œçš„åŸå­æ€§</strong>ï¼Œä»è€Œç›´æ¥åœ¨Edenç©ºé—´ä¸­åˆ†é…å†…å­˜ã€‚</li></ul><h3 id="æµ‹è¯•æ˜¯å¦æ˜¯é¦–é€‰" tabindex="-1"><a class="header-anchor" href="#æµ‹è¯•æ˜¯å¦æ˜¯é¦–é€‰" aria-hidden="true">#</a> æµ‹è¯•æ˜¯å¦æ˜¯é¦–é€‰</h3><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token doc-comment comment">/**
 * æµ‹è¯•-XX:UseTLABå‚æ•°æ˜¯å¦å¼€å¯çš„æƒ…å†µ: é»˜è®¤æƒ…å†µæ˜¯å¼€å¯çš„
 */</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">TLABArgsTest</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;æˆ‘åªæ˜¯æ¥æ‰“ä¸ªé…±æ²¹~&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            <span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">1000000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">InterruptedException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><blockquote><p>è¿è¡Œä¹‹åä½¿ç”¨jps + jinfo -flag UseTLAB</p></blockquote><figure><img src="/java-tips/assets/rJIxzrhBni3Ne9DNOhkblkgwr3jGwEJTJk768bI1saY-0fba8f3d.webp" alt="image" tabindex="0" loading="lazy"><figcaption>image</figcaption></figure><p>å¯ä»¥çœ‹åˆ°é»˜è®¤å¼€å¯TLAB</p><h3 id="è¿‡ç¨‹è¯¦è§£" tabindex="-1"><a class="header-anchor" href="#è¿‡ç¨‹è¯¦è§£" aria-hidden="true">#</a> è¿‡ç¨‹è¯¦è§£</h3><figure><img src="/java-tips/assets/EaidogFnVxfwVHDT-jRxUSOQYYFuduM76dYbTkkDx9g-06cbf2a1.webp" alt="image" tabindex="0" loading="lazy"><figcaption>image</figcaption></figure><ol><li>ä¿è¯å½“å‰ç±»è¦åŠ è½½è¿‡ï¼Œé’ˆå¯¹å­—èŠ‚ç çš„æ•°æ®æœ‰ä¸€ä¸ªåŠ è½½è¿‡ç¨‹ï¼ˆå›¾ç¤ºä¸­çš„ç±»åŠ è½½æ­¥éª¤ï¼‰</li><li>åˆ¤æ–­å½“å‰ç±»æœ‰æ²¡æœ‰åŠ è½½ï¼Œå¦‚æœåŠ è½½äº†ç›´æ¥è¿›å…¥åˆ°ä¼Šç”¸å›­åŒº</li><li>æ¯”å¦‚è¦åˆ›å»ºä¸€ä¸ªå¯¹è±¡ï¼ˆnew Person()ï¼‰,æ­¤æ—¶newå°±ä¼šå¼€è¾Ÿä¸€ä¸ªå †ç©ºé—´ï¼Œå¼€è¾Ÿå®Œä¹‹åé¦–å…ˆå°±ä¼šåœ¨è¿™ä¸ªç‹¬ç«‹çš„çº¿ç¨‹ä¸­æ”¾ä¸€ä¸ªTLABå¯¹è±¡ï¼Œæ¥ç€è®¾è®¡åˆ°å¯¹è±¡çš„èµ‹å€¼å°±æ¥åˆ°å¯¹è±¡çš„å®ä¾‹åŒ–ï¼ˆå›¾ç¤ºTLABåˆ†é… ==&gt; å¯¹è±¡å®ä¾‹åŒ–ï¼‰</li><li>å¦‚æœTLABåˆ†é…æ²¡æœ‰æˆåŠŸï¼Œè¯´æ˜è¿™ä¸ªå¯¹è±¡æ¯”è¾ƒå¤§ï¼Œé‚£ä¹ˆå°±åœ¨å…¬å…±çš„ä¼Šç”¸å›­åŒºè¿›è¡Œåˆ†é…ï¼ˆå›¾ç¤ºTLABåˆ†é… ==&gt; Edenåˆ†é…ï¼‰ï¼Œåˆ†é…æˆåŠŸå°±è¿›å…¥åˆ°å¯¹è±¡çš„å®ä¾‹åŒ–ï¼Œåˆ†é…å¤±è´¥è¯´æ˜ä¼Šç”¸å›­åŒºçš„ç©ºé—´ä¸æ˜¯å¾ˆå¤Ÿï¼Œå°±ä¼šè¿›è¡ŒYGCï¼Œç„¶ååœ¨è¿›è¡Œåˆ†é…ã€‚å¦‚æœYGCä¹‹åè¿˜æ˜¯æ”¾ä¸ä¸‹ï¼Œè¿›å…¥è€å¹´ä»£ã€‚</li></ol><p>æ€»ç»“ï¼š</p><ol><li>å †æ˜¯å…±äº«çš„ï¼Œè®¿é—®éœ€è¦åŠ é”ã€‚è€Œnewå¯¹è±¡æ˜¯ä»¶å¾ˆé¢‘ç¹çš„äº‹æƒ…ï¼Œä¸ºäº†æé«˜æ•ˆç‡ï¼Œæ‰€ä»¥åˆ›å»ºäº†TLABåŒºåŸŸ</li><li>è¿™ä¸ªåŒºåŸŸæ˜¯çº¿ç¨‹ç‹¬å ï¼Œå°±æ— é¡»è€ƒè™‘å¹¶å‘é—®é¢˜ã€‚</li><li>åˆ†é…å¯¹è±¡å°±å…ˆåˆ†é…åˆ°TLABåŒºåŸŸã€‚æ»¡äº†æˆ–å¯¹è±¡è¿‡å¤§ï¼Œå°±è¿˜åˆ†é…åˆ°å¤–è¾¹ã€‚</li><li>è¿™å°±è¦æ±‚æˆ‘ä»¬åˆ›å»ºå¯¹è±¡æ—¶å€™å°½é‡åˆ›å»ºå°å¯¹è±¡ã€‚æé«˜æ•ˆç‡</li></ol><h1 id="å †ç©ºé—´å‚æ•°è®¾ç½®" tabindex="-1"><a class="header-anchor" href="#å †ç©ºé—´å‚æ•°è®¾ç½®" aria-hidden="true">#</a> å †ç©ºé—´å‚æ•°è®¾ç½®</h1><h2 id="å¸¸ç”¨å‚æ•°è®¾ç½®" tabindex="-1"><a class="header-anchor" href="#å¸¸ç”¨å‚æ•°è®¾ç½®" aria-hidden="true">#</a> å¸¸ç”¨å‚æ•°è®¾ç½®</h2><blockquote><p>å®˜æ–¹æ–‡æ¡£</p></blockquote><p>å¤§è‡´600å¤šä¸ª</p><p><a href="https://docs.oracle.com/javase/8/docs/technotes/tools/unix/java.html" target="_blank" rel="noopener noreferrer">webpage<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><blockquote><p>å¸¸ç”¨å‚æ•°è®¾ç½®</p></blockquote><ul><li><strong>-XX:+PrintFlagsInitial</strong>ï¼šæŸ¥çœ‹æ‰€æœ‰çš„å‚æ•°çš„é»˜è®¤åˆå§‹å€¼</li><li><strong>-XX:+PrintFlagsFinal</strong>ï¼šæŸ¥çœ‹æ‰€æœ‰çš„å‚æ•°çš„æœ€ç»ˆå€¼ï¼ˆå¯èƒ½ä¼šå­˜åœ¨ä¿®æ”¹ï¼Œä¸å†æ˜¯åˆå§‹å€¼ï¼‰</li><li>-Xmsï¼šåˆå§‹å †ç©ºé—´å†…å­˜ï¼ˆé»˜è®¤ä¸ºç‰©ç†å†…å­˜çš„1/64ï¼‰</li><li><strong>-Xmx</strong>ï¼šæœ€å¤§å †ç©ºé—´å†…å­˜ï¼ˆé»˜è®¤ä¸ºç‰©ç†å†…å­˜çš„1/4ï¼‰</li><li><strong>-Xmn</strong>ï¼šè®¾ç½®æ–°ç”Ÿä»£çš„å¤§å°ï¼ˆåˆå§‹å€¼åŠæœ€å¤§å€¼ï¼‰</li><li><strong>-XX:NewRatio</strong>ï¼šé…ç½®æ–°ç”Ÿä»£ä¸è€å¹´ä»£åœ¨å †ç»“æ„çš„å æ¯”</li><li><strong>-XX:SurvivorRatio</strong>ï¼šè®¾ç½®æ–°ç”Ÿä»£ä¸­Edenå’ŒS0/S1ç©ºé—´çš„æ¯”ä¾‹</li><li><strong>-XX:MaxTenuringThreshold</strong>ï¼šè®¾ç½®æ–°ç”Ÿä»£åƒåœ¾çš„æœ€å¤§å¹´é¾„</li><li><strong>-XX:+PrintGCDetails</strong>ï¼šè¾“å‡ºè¯¦ç»†çš„GCå¤„ç†æ—¥å¿—</li><li><strong>-XX:+PrintGC</strong> æˆ– -verbose:gc ï¼šæ‰“å°gcç®€è¦ä¿¡æ¯</li><li><strong>-XX:HandlePromotionFalilure</strong>ï¼šæ˜¯å¦è®¾ç½®ç©ºé—´åˆ†é…æ‹…ä¿</li></ul><h2 id="ç©ºé—´åˆ†é…æ‹…ä¿" tabindex="-1"><a class="header-anchor" href="#ç©ºé—´åˆ†é…æ‹…ä¿" aria-hidden="true">#</a> ç©ºé—´åˆ†é…æ‹…ä¿</h2><p><strong>åœ¨å‘ç”ŸMinor GCä¹‹å‰ï¼Œ<strong><strong>è™šæ‹Ÿæœºä¼šæ£€æŸ¥è€å¹´ä»£æœ€å¤§å¯ç”¨çš„è¿ç»­ç©ºé—´æ˜¯å¦å¤§äºæ–°ç”Ÿä»£æ‰€æœ‰å¯¹è±¡çš„æ€»ç©ºé—´</strong></strong>ã€‚</strong></p><ul><li>å¦‚æœå¤§äºï¼Œåˆ™æ­¤æ¬¡Minor GCæ˜¯å®‰å…¨çš„</li><li>å¦‚æœå°äºï¼Œåˆ™è™šæ‹Ÿæœºä¼šæŸ¥çœ‹**-XX:HandlePromotionFailure**è®¾ç½®å€¼æ˜¯å¦å…è®¸æ‹…ä¿å¤±è´¥ã€‚ <ul><li>å¦‚æœHandlePromotionFailure=trueï¼Œé‚£ä¹ˆä¼šç»§ç»­æ£€æŸ¥è€å¹´ä»£æœ€å¤§å¯ç”¨è¿ç»­ç©ºé—´æ˜¯å¦å¤§äºå†æ¬¡æ™‹å‡åˆ°è€å¹´ä»£çš„å¯¹è±¡çš„å¹³å‡å¤§å° <ul><li>å¦‚æœå¤§äºï¼Œåˆ™å°è¯•è¿›è¡Œä¸€æ¬¡Minor GCï¼Œä½†è¿™æ¬¡Minor GCä¾ç„¶æ˜¯æœ‰é£é™©çš„ï¼›</li><li>å¦‚æœå°äºï¼Œåˆ™è¿›è¡Œä¸€æ¬¡Full GCã€‚</li></ul></li></ul></li><li>å¦‚æœHandlePromotionFailure=falseï¼Œåˆ™è¿›è¡Œä¸€æ¬¡Full GCã€‚</li></ul><blockquote><p>å†å²ç‰ˆæœ¬</p></blockquote><ul><li>åœ¨JDK6 Update 24ä¹‹å (JDK 7)ï¼ŒHandlePromotionFailureå‚æ•°ä¸ä¼šå†å½±å“åˆ°è™šæ‹Ÿæœºçš„ç©ºé—´åˆ†é…æ‹…ä¿ç­–ç•¥ï¼Œè§‚å¯ŸopenJDKä¸­çš„æºç å˜åŒ–ï¼Œè™½ç„¶æºç ä¸­è¿˜å®šä¹‰äº†HandlePromotionFailureå‚æ•°ï¼Œä½†æ˜¯åœ¨ä»£ç ä¸­å·²ç»ä¸ä¼šå†ä½¿ç”¨å®ƒã€‚</li><li>JDK6 Update 24ä¹‹åçš„è§„åˆ™å˜ä¸ºåªè¦è€å¹´ä»£çš„è¿ç»­ç©ºé—´<code>å¤§äº</code>æ–°ç”Ÿä»£å¯¹è±¡æ€»å¤§å°æˆ–è€…å†æ¬¡æ™‹å‡çš„å¹³å‡å¤§å°å°±ä¼šè¿›è¡ŒMinor GCï¼Œå¦åˆ™å°†è¿›è¡ŒFull GCã€‚å³ HandlePromotionFailure=true</li></ul><blockquote><p>ä»£ç ç¤ºä¾‹</p></blockquote><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token doc-comment comment">/**
 * æµ‹è¯•å †ç©ºé—´å¸¸ç”¨JVMå‚æ•°ï¼š
 * -XX:+PrintFlagsInitial : æŸ¥çœ‹æ‰€æœ‰çš„å‚æ•°çš„é»˜è®¤åˆå§‹å€¼
 * -XX:+PrintFlagsFinal  ï¼šæŸ¥çœ‹æ‰€æœ‰çš„å‚æ•°çš„æœ€ç»ˆå€¼ï¼ˆå¯èƒ½ä¼šå­˜åœ¨ä¿®æ”¹ï¼Œä¸å†æ˜¯åˆå§‹å€¼ï¼‰
 * å…·ä½“æŸ¥çœ‹æŸä¸ªå‚æ•°çš„æŒ‡ä»¤ï¼š
 *      jpsï¼šæŸ¥çœ‹å½“å‰è¿è¡Œä¸­çš„è¿›ç¨‹
 *      jinfo -flag SurvivorRatio è¿›ç¨‹id
 * -Xmsï¼šåˆå§‹å †ç©ºé—´å†…å­˜ ï¼ˆé»˜è®¤ä¸ºç‰©ç†å†…å­˜çš„1/64ï¼‰
 * -Xmxï¼šæœ€å¤§å †ç©ºé—´å†…å­˜ï¼ˆé»˜è®¤ä¸ºç‰©ç†å†…å­˜çš„1/4ï¼‰
 * -Xmnï¼šè®¾ç½®æ–°ç”Ÿä»£çš„å¤§å°ã€‚(åˆå§‹å€¼åŠæœ€å¤§å€¼)
 * -XX:NewRatioï¼šé…ç½®æ–°ç”Ÿä»£ä¸è€å¹´ä»£åœ¨å †ç»“æ„çš„å æ¯”
 * -XX:SurvivorRatioï¼šè®¾ç½®æ–°ç”Ÿä»£ä¸­Edenå’ŒS0/S1ç©ºé—´çš„æ¯”ä¾‹
 * -XX:MaxTenuringThresholdï¼šè®¾ç½®æ–°ç”Ÿä»£åƒåœ¾çš„æœ€å¤§å¹´é¾„
 * -XX:+PrintGCDetailsï¼šè¾“å‡ºè¯¦ç»†çš„GCå¤„ç†æ—¥å¿—
 * æ‰“å°gcç®€è¦ä¿¡æ¯ï¼šâ‘  -XX:+PrintGC   â‘¡ -verbose:gc
 * -XX:HandlePromotionFailureï¼šæ˜¯å¦è®¾ç½®ç©ºé—´åˆ†é…æ‹…ä¿
 */</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">HeapArgsTest</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>

    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><blockquote><p>é—®é¢˜ï¼šå¦‚æœä¼Šç”¸å›­åŒºè®¾ç½®çš„ä¸å¤Ÿå¤§ï¼Œå¹¸å­˜è€…åŒºè®¾ç½®çš„æ¯”è¾ƒå¤§æ€ä¹ˆåŠï¼Ÿ</p></blockquote><p>æ­¤æ—¶YGCå‡ºç°çš„é¢‘ç‡å°±æ¯”è¾ƒé«˜ï¼Œå°±ä¼šå½±å“ç”¨æˆ·è¿›ç¨‹å¯¼è‡´STWï¼ˆæ€»ä½“æ—¶é—´ï¼‰å˜å¤š</p><h1 id="é¢è¯•é—®é¢˜" tabindex="-1"><a class="header-anchor" href="#é¢è¯•é—®é¢˜" aria-hidden="true">#</a> é¢è¯•é—®é¢˜</h1><h2 id="å †æ˜¯åˆ†é…å¯¹è±¡å­˜å‚¨çš„å”¯ä¸€é€‰æ‹©å—" tabindex="-1"><a class="header-anchor" href="#å †æ˜¯åˆ†é…å¯¹è±¡å­˜å‚¨çš„å”¯ä¸€é€‰æ‹©å—" aria-hidden="true">#</a> å †æ˜¯åˆ†é…å¯¹è±¡å­˜å‚¨çš„å”¯ä¸€é€‰æ‹©å—ï¼Ÿ</h2><p><strong>åœ¨ã€Šæ·±å…¥ç†è§£Javaè™šæ‹Ÿæœºã€‹ä¸­å…³äºJavaå †å†…å­˜æœ‰è¿™æ ·ä¸€æ®µæè¿°ï¼š</strong></p><ul><li>éšç€JITç¼–è¯‘æœŸçš„å‘å±•ä¸<code>é€ƒé€¸åˆ†ææŠ€æœ¯</code>é€æ¸æˆç†Ÿï¼Œ<strong>æ ˆä¸Šåˆ†é…ã€æ ‡é‡æ›¿æ¢</strong>ä¼˜åŒ–æŠ€æœ¯å°†ä¼šå¯¼è‡´ä¸€äº›å¾®å¦™çš„å˜åŒ–ï¼Œæ‰€æœ‰çš„å¯¹è±¡éƒ½åˆ†é…åˆ°å †ä¸Šä¹Ÿæ¸æ¸å˜å¾—ä¸é‚£ä¹ˆâ€œç»å¯¹â€äº†ã€‚</li><li>åœ¨Javaè™šæ‹Ÿæœºä¸­ï¼Œå¯¹è±¡æ˜¯åœ¨Javaå †ä¸­åˆ†é…å†…å­˜çš„ï¼Œè¿™æ˜¯ä¸€ä¸ªæ™®éçš„å¸¸è¯†ã€‚ä½†æ˜¯ï¼Œæœ‰ä¸€ç§ç‰¹æ®Šæƒ…å†µï¼Œé‚£å°±æ˜¯<code>å¦‚æœç»è¿‡é€ƒé€¸åˆ†æï¼ˆEscape Analysisï¼‰åå‘ç°ï¼Œä¸€ä¸ªå¯¹è±¡å¹¶æ²¡æœ‰é€ƒé€¸å‡ºæ–¹æ³•çš„è¯ï¼Œé‚£ä¹ˆå°±å¯èƒ½è¢«ä¼˜åŒ–æˆæ ˆä¸Šåˆ†é…</code>ã€‚è¿™æ ·å°±æ— éœ€åœ¨å †ä¸Šåˆ†é…å†…å­˜ï¼Œä¹Ÿæ— é¡»è¿›è¡Œåƒåœ¾å›æ”¶äº†ã€‚è¿™ä¹Ÿæ˜¯æœ€å¸¸è§çš„å †å¤–å­˜å‚¨æŠ€æœ¯ã€‚</li><li>æ­¤å¤–ï¼Œå‰é¢æåˆ°çš„åŸºäºOpenJDKæ·±åº¦å®šåˆ¶çš„TaoBao VM( æ·˜å®è™šæ‹Ÿæœº )ï¼Œå…¶ä¸­åˆ›æ–°çš„GCIHï¼ˆGC invisible heapï¼‰æŠ€æœ¯å®ç°off-heapï¼Œå°†ç”Ÿå‘½å‘¨æœŸè¾ƒé•¿çš„Javaå¯¹è±¡ä»heapä¸­ç§»è‡³heapå¤–ï¼Œå¹¶ä¸”GCä¸èƒ½ç®¡ç†GCIHå†…éƒ¨çš„Javaå¯¹è±¡ï¼Œä»¥æ­¤è¾¾åˆ°é™ä½GCçš„å›æ”¶é¢‘ç‡å’Œæå‡GCçš„å›æ”¶æ•ˆç‡çš„ç›®çš„ã€‚</li></ul><h2 id="é€ƒé€¸åˆ†æ" tabindex="-1"><a class="header-anchor" href="#é€ƒé€¸åˆ†æ" aria-hidden="true">#</a> é€ƒé€¸åˆ†æ</h2><p><strong>å¦‚ä½•å°†å †ä¸Šçš„å¯¹è±¡åˆ†é…åˆ°æ ˆï¼Œéœ€è¦ä½¿ç”¨é€ƒé€¸åˆ†ææ‰‹æ®µã€‚</strong></p><ul><li>è¿™æ˜¯ä¸€ç§å¯ä»¥æœ‰æ•ˆå‡å°‘Javaç¨‹åºä¸­åŒæ­¥è´Ÿè½½å’Œå†…å­˜å †åˆ†é…å‹åŠ›çš„è·¨å‡½æ•°å…¨å±€æ•°æ®æµåˆ†æç®—æ³•ã€‚</li><li>é€šè¿‡é€ƒé€¸åˆ†æï¼ŒJava Hotspotç¼–è¯‘å™¨èƒ½å¤Ÿåˆ†æå‡ºä¸€ä¸ªæ–°çš„å¯¹è±¡çš„å¼•ç”¨çš„ä½¿ç”¨èŒƒå›´ä»è€Œå†³å®šæ˜¯å¦è¦å°†è¿™ä¸ªå¯¹è±¡åˆ†é…åˆ°å †ä¸Šã€‚</li><li>é€ƒé€¸åˆ†æçš„åŸºæœ¬è¡Œä¸ºå°±æ˜¯åˆ†æå¯¹è±¡åŠ¨æ€ä½œç”¨åŸŸï¼š <ul><li><strong>å½“ä¸€ä¸ªå¯¹è±¡åœ¨æ–¹æ³•ä¸­è¢«å®šä¹‰åï¼Œå¯¹è±¡åªåœ¨æ–¹æ³•å†…éƒ¨ä½¿ç”¨ï¼Œåˆ™è®¤ä¸ºæ²¡æœ‰å‘ç”Ÿé€ƒé€¸</strong>ã€‚</li><li>å½“ä¸€ä¸ªå¯¹è±¡åœ¨æ–¹æ³•ä¸­è¢«å®šä¹‰åï¼Œå®ƒè¢«å¤–éƒ¨æ–¹æ³•æ‰€å¼•ç”¨ï¼Œåˆ™è®¤ä¸ºå‘ç”Ÿé€ƒé€¸ã€‚ä¾‹å¦‚ä½œä¸ºè°ƒç”¨å‚æ•°ä¼ é€’åˆ°å…¶ä»–åœ°æ–¹ä¸­ã€‚</li></ul></li></ul><h3 id="ä¸¾ä¾‹è¯´æ˜" tabindex="-1"><a class="header-anchor" href="#ä¸¾ä¾‹è¯´æ˜" aria-hidden="true">#</a> ä¸¾ä¾‹è¯´æ˜</h3><p>æ²¡æœ‰å‘ç”Ÿé€ƒé€¸çš„å¯¹è±¡ï¼Œåˆ™å¯ä»¥åˆ†é…åˆ°æ ˆä¸Šï¼Œéšç€æ–¹æ³•æ‰§è¡Œçš„ç»“æŸï¼Œæ ˆç©ºé—´å°±è¢«ç§»é™¤</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">my_method</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">V</span> v <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">V</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// use v</span>
    <span class="token comment">// ....</span>
    v <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä¸‹é¢ä»£ç ä¸­çš„ StringBuffer sb å‘ç”Ÿäº†é€ƒé€¸ï¼ˆå› ä¸ºè¿™ä¸ªStringBufferåœ¨æ–¹æ³•å¤–æœ‰å¯èƒ½è¢«è°ƒç”¨ï¼‰ï¼Œç”±æ­¤å¯ä»¥è¿›ä¸€æ­¥æ‹“å±•ï¼Œã€æ ˆä¸Šåˆ†é…å¤§è‡´å°±æ˜¯åªåœ¨æ–¹æ³•å†…éƒ¨ç”¨ï¼Œç”¨å®Œå°±ä¸¢ã€‘</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">StringBuffer</span> <span class="token function">createStringBuffer</span><span class="token punctuation">(</span><span class="token class-name">String</span> s1<span class="token punctuation">,</span> <span class="token class-name">String</span> s2<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">StringBuffer</span> sb <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">StringBuffer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    sb<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span>s1<span class="token punctuation">)</span><span class="token punctuation">;</span>
    sb<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span>s2<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> sb<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å¦‚æœæƒ³è¦StringBuffer sbä¸å‘ç”Ÿé€ƒé€¸ï¼Œå¯ä»¥è¿™æ ·å†™</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">String</span> <span class="token function">createStringBuffer</span><span class="token punctuation">(</span><span class="token class-name">String</span> s1<span class="token punctuation">,</span> <span class="token class-name">String</span> s2<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">StringBuffer</span> sb <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">StringBuffer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    sb<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span>s1<span class="token punctuation">)</span><span class="token punctuation">;</span>
    sb<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span>s2<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> sb<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>é€ƒé€¸åˆ†æçš„ä¸¾ä¾‹</li><li><strong>å¦‚ä½•å¿«é€Ÿçš„åˆ¤æ–­æ˜¯å¦å‘ç”Ÿäº†é€ƒé€¸åˆ†æï¼Œå¤§å®¶å°±çœ‹newçš„å¯¹è±¡å®ä½“æ˜¯å¦æœ‰å¯èƒ½åœ¨æ–¹æ³•å¤–è¢«è°ƒç”¨</strong></li></ul><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token doc-comment comment">/**
 * é€ƒé€¸åˆ†æ
 *
 * å¦‚ä½•å¿«é€Ÿçš„åˆ¤æ–­æ˜¯å¦å‘ç”Ÿäº†é€ƒé€¸åˆ†æï¼Œå¤§å®¶å°±çœ‹newçš„å¯¹è±¡å®ä½“æ˜¯å¦æœ‰å¯èƒ½åœ¨æ–¹æ³•å¤–è¢«è°ƒç”¨ã€‚
 */</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">EscapeAnalysis</span> <span class="token punctuation">{</span>

    <span class="token keyword">public</span> <span class="token class-name">EscapeAnalysis</span> obj<span class="token punctuation">;</span>

    <span class="token comment">/*
    æ–¹æ³•è¿”å›EscapeAnalysiså¯¹è±¡ï¼Œå‘ç”Ÿé€ƒé€¸
     */</span>
    <span class="token keyword">public</span> <span class="token class-name">EscapeAnalysis</span> <span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">return</span> obj <span class="token operator">==</span> <span class="token keyword">null</span><span class="token operator">?</span> <span class="token keyword">new</span> <span class="token class-name">EscapeAnalysis</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">:</span> obj<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/*
    ä¸ºæˆå‘˜å±æ€§èµ‹å€¼ï¼Œå‘ç”Ÿé€ƒé€¸
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setObj</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>obj <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">EscapeAnalysis</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token comment">//æ€è€ƒï¼šå¦‚æœå½“å‰çš„objå¼•ç”¨å£°æ˜ä¸ºstaticçš„ï¼Ÿ ä»ç„¶ä¼šå‘ç”Ÿé€ƒé€¸ã€‚</span>

    <span class="token comment">/*
    å¯¹è±¡çš„ä½œç”¨åŸŸä»…åœ¨å½“å‰æ–¹æ³•ä¸­æœ‰æ•ˆï¼Œæ²¡æœ‰å‘ç”Ÿé€ƒé€¸
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">useEscapeAnalysis</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token class-name">EscapeAnalysis</span> e <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">EscapeAnalysis</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/*
    å¼•ç”¨æˆå‘˜å˜é‡çš„å€¼ï¼Œå‘ç”Ÿé€ƒé€¸
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">useEscapeAnalysis1</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token class-name">EscapeAnalysis</span> e <span class="token operator">=</span> <span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//è¿™ä¸ªeå¯¹è±¡ï¼Œæœ¬èº«å°±æ˜¯ä»å¤–é¢çš„æ–¹æ³•é€ƒé€¸è¿›æ¥çš„</span>
        <span class="token comment">//getInstance().xxx()åŒæ ·ä¼šå‘ç”Ÿé€ƒé€¸</span>
    <span class="token punctuation">}</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="å‚æ•°è®¾ç½®" tabindex="-1"><a class="header-anchor" href="#å‚æ•°è®¾ç½®" aria-hidden="true">#</a> å‚æ•°è®¾ç½®</h3><ul><li><strong>åœ¨JDK 1.7 ç‰ˆæœ¬ä¹‹åï¼ŒHotSpotä¸­é»˜è®¤å°±å·²ç»å¼€å¯äº†é€ƒé€¸åˆ†æ</strong></li><li>å¦‚æœä½¿ç”¨çš„æ˜¯è¾ƒæ—©çš„ç‰ˆæœ¬ï¼Œå¼€å‘äººå‘˜åˆ™å¯ä»¥é€šè¿‡ï¼š <ul><li>é€‰é¡¹â€œ-XX:+DoEscapeAnalysis&quot;æ˜¾å¼å¼€å¯é€ƒé€¸åˆ†æ</li><li>é€šè¿‡é€‰é¡¹â€œ-XX:+PrintEscapeAnalysis&quot;æŸ¥çœ‹é€ƒé€¸åˆ†æçš„ç­›é€‰ç»“æœ</li></ul></li></ul><h3 id="ç»“è®º" tabindex="-1"><a class="header-anchor" href="#ç»“è®º" aria-hidden="true">#</a> ç»“è®º</h3><p><strong>å¼€å‘ä¸­èƒ½ä½¿ç”¨å±€éƒ¨å˜é‡çš„ï¼Œå°±ä¸è¦ä½¿ç”¨åœ¨æ–¹æ³•å¤–å®šä¹‰</strong>ã€‚</p><h3 id="ä»£ç ä¼˜åŒ–" tabindex="-1"><a class="header-anchor" href="#ä»£ç ä¼˜åŒ–" aria-hidden="true">#</a> ä»£ç ä¼˜åŒ–</h3><p>ä½¿ç”¨é€ƒé€¸åˆ†æï¼Œç¼–è¯‘å™¨å¯ä»¥å¯¹ä»£ç åšå¦‚ä¸‹ä¼˜åŒ–ï¼š</p><ul><li><strong>æ ˆä¸Šåˆ†é…</strong>ï¼šå°†å †åˆ†é…è½¬åŒ–ä¸ºæ ˆåˆ†é…ã€‚å¦‚æœä¸€ä¸ªå¯¹è±¡åœ¨å­ç¨‹åºä¸­è¢«åˆ†é…ï¼Œè¦ä½¿æŒ‡å‘è¯¥å¯¹è±¡çš„æŒ‡é’ˆæ°¸è¿œä¸ä¼šå‘ç”Ÿé€ƒé€¸ï¼Œå¯¹è±¡å¯èƒ½æ˜¯æ ˆä¸Šåˆ†é…çš„å€™é€‰ï¼Œè€Œä¸æ˜¯å †ä¸Šåˆ†é…</li><li><strong>åŒæ­¥çœç•¥</strong>ï¼šå¦‚æœä¸€ä¸ªå¯¹è±¡è¢«å‘ç°åªæœ‰ä¸€ä¸ªçº¿ç¨‹è¢«è®¿é—®åˆ°ï¼Œé‚£ä¹ˆå¯¹äºè¿™ä¸ªå¯¹è±¡çš„æ“ä½œå¯ä»¥ä¸è€ƒè™‘åŒæ­¥ã€‚</li><li><strong>åˆ†ç¦»å¯¹è±¡æˆ–æ ‡é‡æ›¿æ¢</strong>ï¼šæœ‰çš„å¯¹è±¡å¯èƒ½ä¸éœ€è¦ä½œä¸ºä¸€ä¸ªè¿ç»­çš„å†…å­˜ç»“æ„å­˜åœ¨ä¹Ÿå¯ä»¥è¢«è®¿é—®åˆ°ï¼Œé‚£ä¹ˆå¯¹è±¡çš„éƒ¨åˆ†ï¼ˆæˆ–å…¨éƒ¨ï¼‰å¯ä»¥ä¸å­˜å‚¨åœ¨å†…å­˜ï¼Œè€Œæ˜¯å­˜å‚¨åœ¨CPUå¯„å­˜å™¨ä¸­ã€‚</li></ul><h2 id="æ ˆä¸Šåˆ†é…" tabindex="-1"><a class="header-anchor" href="#æ ˆä¸Šåˆ†é…" aria-hidden="true">#</a> æ ˆä¸Šåˆ†é…</h2><ul><li>JITç¼–è¯‘å™¨åœ¨ç¼–è¯‘æœŸé—´æ ¹æ®é€ƒé€¸åˆ†æçš„ç»“æœï¼Œå‘ç°å¦‚æœä¸€ä¸ªå¯¹è±¡å¹¶æ²¡æœ‰é€ƒé€¸å‡ºæ–¹æ³•çš„è¯ï¼Œå°±å¯èƒ½è¢«ä¼˜åŒ–æˆæ ˆä¸Šåˆ†é…ã€‚</li><li>åˆ†é…å®Œæˆåï¼Œç»§ç»­åœ¨è°ƒç”¨æ ˆå†…æ‰§è¡Œï¼Œæœ€åçº¿ç¨‹ç»“æŸï¼Œæ ˆç©ºé—´è¢«å›æ”¶ï¼Œå±€éƒ¨å˜é‡å¯¹è±¡ä¹Ÿè¢«å›æ”¶ã€‚è¿™æ ·å°±æ— é¡»è¿›è¡Œåƒåœ¾å›æ”¶äº†ã€‚</li><li>å¸¸è§çš„æ ˆä¸Šåˆ†é…çš„åœºæ™¯ï¼š <ul><li>åœ¨é€ƒé€¸åˆ†æä¸­ï¼Œå·²ç»è¯´æ˜äº†ï¼Œåˆ†åˆ«æ˜¯ç»™æˆå‘˜å˜é‡èµ‹å€¼ã€æ–¹æ³•è¿”å›å€¼ã€å®ä¾‹å¼•ç”¨ä¼ é€’ã€‚</li></ul></li></ul><blockquote><p>ä»£ç ä¸¾ä¾‹</p></blockquote><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token doc-comment comment">/**
 * æ ˆä¸Šåˆ†é…æµ‹è¯•
 * -Xmx256m -Xms256m -XX:-DoEscapeAnalysis -XX:+PrintGCDetails
 */</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">StackAllocation</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">long</span> start <span class="token operator">=</span> <span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">currentTimeMillis</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">10000000</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token function">alloc</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token comment">// æŸ¥çœ‹æ‰§è¡Œæ—¶é—´</span>
        <span class="token keyword">long</span> end <span class="token operator">=</span> <span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">currentTimeMillis</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;èŠ±è´¹çš„æ—¶é—´ä¸ºï¼š &quot;</span> <span class="token operator">+</span> <span class="token punctuation">(</span>end <span class="token operator">-</span> start<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot; ms&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// ä¸ºäº†æ–¹ä¾¿æŸ¥çœ‹å †å†…å­˜ä¸­å¯¹è±¡ä¸ªæ•°ï¼Œçº¿ç¨‹sleep</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            <span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">1000000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">InterruptedException</span> e1<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            e1<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">alloc</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">User</span> user <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">User</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//æœªå‘ç”Ÿé€ƒé€¸</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">static</span> <span class="token keyword">class</span> <span class="token class-name">User</span> <span class="token punctuation">{</span>

    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å½“æ²¡æœ‰å¼€å¯é€ƒé€¸åˆ†æçš„æ—¶å€™</p><blockquote><p>-Xmx256m -Xms256m -XX:-DoEscapeAnalysis -XX:+PrintGCDetails</p></blockquote><figure><img src="/java-tips/assets/DSBTBgPy4Y1yJj-lQjP_9sVAR-R2YyLFkNElDYMsaL0-f5d6185a.webp" alt="image" tabindex="0" loading="lazy"><figcaption>image</figcaption></figure><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token punctuation">[</span><span class="token constant">GC</span> <span class="token punctuation">(</span><span class="token class-name">Allocation</span> <span class="token class-name">Failure</span><span class="token punctuation">)</span> <span class="token punctuation">[</span><span class="token class-name">PSYoungGen</span><span class="token operator">:</span> <span class="token number">65536</span>K<span class="token operator">-&gt;</span><span class="token function">840K</span><span class="token punctuation">(</span><span class="token number">76288</span>K<span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token number">65536</span>K<span class="token operator">-&gt;</span><span class="token function">848K</span><span class="token punctuation">(</span><span class="token number">251392</span>K<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">0.0006857</span> secs<span class="token punctuation">]</span> <span class="token punctuation">[</span><span class="token class-name">Times</span><span class="token operator">:</span> user<span class="token operator">=</span><span class="token number">0.00</span> sys<span class="token operator">=</span><span class="token number">0.00</span><span class="token punctuation">,</span> real<span class="token operator">=</span><span class="token number">0.00</span> secs<span class="token punctuation">]</span> 
<span class="token punctuation">[</span><span class="token constant">GC</span> <span class="token punctuation">(</span><span class="token class-name">Allocation</span> <span class="token class-name">Failure</span><span class="token punctuation">)</span> <span class="token punctuation">[</span><span class="token class-name">PSYoungGen</span><span class="token operator">:</span> <span class="token number">66376</span>K<span class="token operator">-&gt;</span><span class="token function">760K</span><span class="token punctuation">(</span><span class="token number">76288</span>K<span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token number">66384</span>K<span class="token operator">-&gt;</span><span class="token function">768K</span><span class="token punctuation">(</span><span class="token number">251392</span>K<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">0.0005822</span> secs<span class="token punctuation">]</span> <span class="token punctuation">[</span><span class="token class-name">Times</span><span class="token operator">:</span> user<span class="token operator">=</span><span class="token number">0.01</span> sys<span class="token operator">=</span><span class="token number">0.00</span><span class="token punctuation">,</span> real<span class="token operator">=</span><span class="token number">0.00</span> secs<span class="token punctuation">]</span> 
èŠ±è´¹çš„æ—¶é—´ä¸ºï¼š <span class="token number">42</span> ms
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å¼€å¯äº†é€ƒé€¸åˆ†æå</p><blockquote><p>-Xmx256m -Xms256m -XX:+DoEscapeAnalysis -XX:+PrintGCDetails</p></blockquote><figure><img src="/java-tips/assets/fVP-1ufq7Z62dCEY3Iz2Lj3xZfqhZiXa05wJlnmnXqg-58063704.webp" alt="image" tabindex="0" loading="lazy"><figcaption>image</figcaption></figure><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code>èŠ±è´¹çš„æ—¶é—´ä¸ºï¼š <span class="token number">4</span> ms
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h2 id="åŒæ­¥çœç•¥" tabindex="-1"><a class="header-anchor" href="#åŒæ­¥çœç•¥" aria-hidden="true">#</a> åŒæ­¥çœç•¥</h2><ul><li><strong>çº¿ç¨‹åŒæ­¥çš„ä»£ä»·æ˜¯ç›¸å½“é«˜çš„ï¼ŒåŒæ­¥çš„åæœæ˜¯é™ä½å¹¶å‘æ€§å’Œæ€§èƒ½</strong>ã€‚</li><li>åœ¨åŠ¨æ€ç¼–è¯‘åŒæ­¥å—çš„æ—¶å€™ï¼ŒJITç¼–è¯‘å™¨å¯ä»¥å€ŸåŠ©<code>é€ƒé€¸åˆ†æ</code>æ¥åˆ¤æ–­åŒæ­¥å—æ‰€ä½¿ç”¨çš„é”å¯¹è±¡æ˜¯å¦åªèƒ½å¤Ÿè¢«ä¸€ä¸ªçº¿ç¨‹è®¿é—®è€Œæ²¡æœ‰è¢«å‘å¸ƒåˆ°å…¶ä»–çº¿ç¨‹ã€‚</li><li>å¦‚æœæ²¡æœ‰ï¼Œé‚£ä¹ˆJITç¼–è¯‘å™¨åœ¨ç¼–è¯‘è¿™ä¸ªåŒæ­¥å—çš„æ—¶å€™å°±ä¼šå–æ¶ˆå¯¹è¿™éƒ¨åˆ†ä»£ç çš„åŒæ­¥ã€‚è¿™æ ·å°±èƒ½å¤§å¤§æé«˜å¹¶å‘æ€§å’Œæ€§èƒ½ã€‚è¿™ä¸ª<strong>å–æ¶ˆåŒæ­¥çš„è¿‡ç¨‹å°±å«åŒæ­¥çœç•¥ï¼Œä¹Ÿå«****é”æ¶ˆé™¤</strong>ã€‚</li><li>ä¾‹å¦‚ä¸‹é¢çš„æ™ºéšœä»£ç ï¼Œæ ¹æœ¬èµ·ä¸åˆ°é”çš„ä½œç”¨</li></ul><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">f</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">Object</span> hellis <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Object</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">synchronized</span><span class="token punctuation">(</span>hellis<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>hellis<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä»£ç ä¸­å¯¹hellisè¿™ä¸ªå¯¹è±¡åŠ é”ï¼Œä½†æ˜¯helliså¯¹è±¡çš„ç”Ÿå‘½å‘¨æœŸåªåœ¨f( )æ–¹æ³•ä¸­ï¼Œå¹¶ä¸ä¼šè¢«å…¶ä»–çº¿ç¨‹æ‰€è®¿é—®åˆ°ï¼Œæ‰€ä»¥åœ¨JITç¼–è¯‘é˜¶æ®µå°±ä¼šè¢«ä¼˜åŒ–æ‰ï¼Œä¼˜åŒ–æˆï¼š</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">f</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  	<span class="token class-name">Object</span> hellis <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Object</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>hellis<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><blockquote><p>å­—èŠ‚ç åˆ†æ</p></blockquote><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token doc-comment comment">/**
 * åŒæ­¥çœç•¥è¯´æ˜
 * <span class="token keyword">@author</span> xiexu
 * <span class="token keyword">@create</span> 2020-11-27 7:01 ä¸‹åˆ
 */</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">SynchronizedTest</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">f</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">Object</span> hellis <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Object</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">synchronized</span><span class="token punctuation">(</span>hellis<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>hellis<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æ³¨æ„ï¼šå­—èŠ‚ç æ–‡ä»¶ä¸­å¹¶æ²¡æœ‰è¿›è¡Œä¼˜åŒ–ï¼Œå¯ä»¥çœ‹åˆ°åŠ é”å’Œé‡Šæ”¾é”çš„æ“ä½œä¾ç„¶å­˜åœ¨ï¼Œ<strong>åŒæ­¥çœç•¥æ“ä½œæ˜¯åœ¨è§£é‡Šè¿è¡Œæ—¶å‘ç”Ÿçš„</strong></p><p>ï¼ˆåŒæ­¥æ“ä½œæ˜¯ä¸‹å›¾ä¸­æ©™è‰²æ ‡å¿—ï¼‰</p><figure><img src="/java-tips/assets/py6qZbSRhDZ6tZhg73idSYxgBXGOyXPuU2Nuz30D81M-878026df.webp" alt="image" tabindex="0" loading="lazy"><figcaption>image</figcaption></figure><h2 id="åˆ†ç¦»å¯¹è±¡æˆ–æ ‡é‡æ›¿æ¢" tabindex="-1"><a class="header-anchor" href="#åˆ†ç¦»å¯¹è±¡æˆ–æ ‡é‡æ›¿æ¢" aria-hidden="true">#</a> åˆ†ç¦»å¯¹è±¡æˆ–æ ‡é‡æ›¿æ¢</h2><ul><li><strong>æ ‡é‡ï¼ˆscalarï¼‰æ˜¯æŒ‡ä¸€ä¸ªæ— æ³•å†åˆ†è§£æˆæ›´å°çš„æ•°æ®çš„æ•°æ®ã€‚Javaä¸­çš„åŸå§‹æ•°æ®ç±»å‹å°±æ˜¯æ ‡é‡</strong>ã€‚</li><li>ç›¸å¯¹çš„ï¼Œé‚£äº›è¿˜å¯ä»¥åˆ†è§£çš„æ•°æ®å«åšèšåˆé‡ï¼ˆAggregateï¼‰ï¼ŒJavaä¸­çš„å¯¹è±¡å°±æ˜¯èšåˆé‡ï¼Œå› ä¸ºä»–å¯ä»¥åˆ†è§£æˆå…¶ä»–èšåˆé‡å’Œæ ‡é‡ã€‚</li><li>åœ¨JITé˜¶æ®µï¼Œå¦‚æœç»è¿‡é€ƒé€¸åˆ†æï¼Œå‘ç°ä¸€ä¸ªå¯¹è±¡ä¸ä¼šè¢«å¤–ç•Œè®¿é—®çš„è¯ï¼Œé‚£ä¹ˆç»è¿‡JITä¼˜åŒ–ï¼Œå°±ä¼š<strong>æŠŠè¿™ä¸ªå¯¹è±¡æ‹†è§£æˆè‹¥å¹²ä¸ªå…¶ä¸­åŒ…å«çš„è‹¥å¹²ä¸ªæˆå‘˜å˜é‡æ¥ä»£æ›¿ã€‚è¿™ä¸ªè¿‡ç¨‹å°±æ˜¯æ ‡é‡æ›¿æ¢</strong></li></ul><blockquote><p>ä»£ç ä¸¾ä¾‹</p></blockquote><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span> args<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">alloc</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">class</span> <span class="token class-name">Point</span> <span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token keyword">int</span> x<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token keyword">int</span> y<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">alloc</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">Point</span> point <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Point</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;point.x&quot;</span> <span class="token operator">+</span> point<span class="token punctuation">.</span>x <span class="token operator">+</span> <span class="token string">&quot;;point.y&quot;</span> <span class="token operator">+</span> point<span class="token punctuation">.</span>y<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä»¥ä¸Šä»£ç ï¼Œç»è¿‡æ ‡é‡æ›¿æ¢åï¼Œå°±ä¼šå˜æˆ</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">alloc</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">int</span> x <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span> y <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;point.x = &quot;</span> <span class="token operator">+</span> x <span class="token operator">+</span> <span class="token string">&quot;; point.y=&quot;</span> <span class="token operator">+</span> y<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><blockquote><p>ä»£ç ç¤ºä¾‹</p></blockquote><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token doc-comment comment">/**
 * æ ‡é‡æ›¿æ¢æµ‹è¯•
 *  -Xmx100m -Xms100m -XX:+DoEscapeAnalysis -XX:+PrintGC -XX:-EliminateAllocations
 * <span class="token keyword">@author</span> shkstart  shkstart@126.com
 * <span class="token keyword">@create</span> 2020  12:01
 */</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ScalarReplace</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">class</span> <span class="token class-name">User</span> <span class="token punctuation">{</span>
        <span class="token keyword">public</span> <span class="token keyword">int</span> id<span class="token punctuation">;</span>
        <span class="token keyword">public</span> <span class="token class-name">String</span> name<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">alloc</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">User</span> u <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">User</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//æœªå‘ç”Ÿé€ƒé€¸</span>
        u<span class="token punctuation">.</span>id <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">;</span>
        u<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">&quot;www.atguigu.com&quot;</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">long</span> start <span class="token operator">=</span> <span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">currentTimeMillis</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">10000000</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token function">alloc</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">long</span> end <span class="token operator">=</span> <span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">currentTimeMillis</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;èŠ±è´¹çš„æ—¶é—´ä¸ºï¼š &quot;</span> <span class="token operator">+</span> <span class="token punctuation">(</span>end <span class="token operator">-</span> start<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot; ms&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><blockquote><p>VMé€‰é¡¹</p></blockquote><p>-Xmx100m -Xms100m -XX:+DoEscapeAnalysis -XX:+PrintGC -XX:-EliminateAllocations</p><blockquote><p>å½“æ²¡æœ‰å¼€å¯æ ‡é‡ï¼Œç»“æœ</p></blockquote><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token punctuation">[</span><span class="token constant">GC</span> <span class="token punctuation">(</span><span class="token class-name">Allocation</span> <span class="token class-name">Failure</span><span class="token punctuation">)</span>  <span class="token number">25600</span>K<span class="token operator">-&gt;</span><span class="token function">752K</span><span class="token punctuation">(</span><span class="token number">98304</span>K<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">0.0007471</span> secs<span class="token punctuation">]</span>
<span class="token punctuation">[</span><span class="token constant">GC</span> <span class="token punctuation">(</span><span class="token class-name">Allocation</span> <span class="token class-name">Failure</span><span class="token punctuation">)</span>  <span class="token number">26352</span>K<span class="token operator">-&gt;</span><span class="token function">736K</span><span class="token punctuation">(</span><span class="token number">98304</span>K<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">0.0008870</span> secs<span class="token punctuation">]</span>
<span class="token punctuation">[</span><span class="token constant">GC</span> <span class="token punctuation">(</span><span class="token class-name">Allocation</span> <span class="token class-name">Failure</span><span class="token punctuation">)</span>  <span class="token number">26336</span>K<span class="token operator">-&gt;</span><span class="token function">736K</span><span class="token punctuation">(</span><span class="token number">98304</span>K<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">0.0004834</span> secs<span class="token punctuation">]</span>
<span class="token punctuation">[</span><span class="token constant">GC</span> <span class="token punctuation">(</span><span class="token class-name">Allocation</span> <span class="token class-name">Failure</span><span class="token punctuation">)</span>  <span class="token number">26336</span>K<span class="token operator">-&gt;</span><span class="token function">776K</span><span class="token punctuation">(</span><span class="token number">98304</span>K<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">0.0005193</span> secs<span class="token punctuation">]</span>
<span class="token punctuation">[</span><span class="token constant">GC</span> <span class="token punctuation">(</span><span class="token class-name">Allocation</span> <span class="token class-name">Failure</span><span class="token punctuation">)</span>  <span class="token number">26376</span>K<span class="token operator">-&gt;</span><span class="token function">744K</span><span class="token punctuation">(</span><span class="token number">98304</span>K<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">0.0004676</span> secs<span class="token punctuation">]</span>
<span class="token punctuation">[</span><span class="token constant">GC</span> <span class="token punctuation">(</span><span class="token class-name">Allocation</span> <span class="token class-name">Failure</span><span class="token punctuation">)</span>  <span class="token number">26344</span>K<span class="token operator">-&gt;</span><span class="token function">760K</span><span class="token punctuation">(</span><span class="token number">101376</span>K<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">0.0009020</span> secs<span class="token punctuation">]</span>
<span class="token punctuation">[</span><span class="token constant">GC</span> <span class="token punctuation">(</span><span class="token class-name">Allocation</span> <span class="token class-name">Failure</span><span class="token punctuation">)</span>  <span class="token number">32504</span>K<span class="token operator">-&gt;</span><span class="token function">668K</span><span class="token punctuation">(</span><span class="token number">101376</span>K<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">0.0007022</span> secs<span class="token punctuation">]</span>
<span class="token punctuation">[</span><span class="token constant">GC</span> <span class="token punctuation">(</span><span class="token class-name">Allocation</span> <span class="token class-name">Failure</span><span class="token punctuation">)</span>  <span class="token number">32412</span>K<span class="token operator">-&gt;</span><span class="token function">668K</span><span class="token punctuation">(</span><span class="token number">101376</span>K<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">0.0003749</span> secs<span class="token punctuation">]</span>
èŠ±è´¹çš„æ—¶é—´ä¸ºï¼š <span class="token number">50</span> ms
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><blockquote><p>å¼€å¯æ ‡é‡æ›¿æ¢ï¼Œç»“æœ</p></blockquote><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code>èŠ±è´¹çš„æ—¶é—´ä¸ºï¼š <span class="token number">5</span> ms
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p><strong>ç»“è®ºï¼š</strong></p><ul><li>å¯ä»¥çœ‹åˆ°ï¼ŒPointè¿™ä¸ªèšåˆé‡ç»è¿‡é€ƒé€¸åˆ†æåï¼Œå‘ç°ä»–å¹¶æ²¡æœ‰é€ƒé€¸ï¼Œå°±è¢«æ›¿æ¢æˆä¸¤ä¸ªèšåˆé‡äº†ã€‚</li><li>é‚£ä¹ˆæ ‡é‡æ›¿æ¢æœ‰ä»€ä¹ˆå¥½å¤„å‘¢ï¼Ÿå°±æ˜¯å¯ä»¥å¤§å¤§å‡å°‘å †å†…å­˜çš„å ç”¨ã€‚å› ä¸ºä¸€æ—¦ä¸éœ€è¦åˆ›å»ºå¯¹è±¡äº†ï¼Œé‚£ä¹ˆå°±ä¸å†éœ€è¦åˆ†é…å †å†…å­˜äº†ã€‚</li><li>æ ‡é‡æ›¿æ¢ä¸ºæ ˆä¸Šåˆ†é…æä¾›äº†å¾ˆå¥½çš„åŸºç¡€ã€‚</li></ul><h3 id="é€ƒé€¸åˆ†æå‚æ•°è®¾ç½®æ€»ç»“" tabindex="-1"><a class="header-anchor" href="#é€ƒé€¸åˆ†æå‚æ•°è®¾ç½®æ€»ç»“" aria-hidden="true">#</a> é€ƒé€¸åˆ†æå‚æ•°è®¾ç½®æ€»ç»“</h3><ul><li>ä¸Šè¿°ä»£ç åœ¨ä¸»å‡½æ•°ä¸­è°ƒç”¨äº†1äº¿æ¬¡alloc( )æ–¹æ³•ï¼Œè¿›è¡Œå¯¹è±¡åˆ›å»º</li><li>ç”±äºUserå¯¹è±¡å®ä¾‹éœ€è¦å æ®çº¦16å­—èŠ‚çš„ç©ºé—´ï¼Œå› æ­¤ç´¯è®¡åˆ†é…ç©ºé—´è¾¾åˆ°å°†è¿‘1.5GBã€‚</li><li>å¦‚æœå †ç©ºé—´å°äºè¿™ä¸ªå€¼ï¼Œå°±å¿…ç„¶ä¼šå‘ç”ŸGCã€‚ä½¿ç”¨å¦‚ä¸‹å‚æ•°è¿è¡Œä¸Šè¿°ä»£ç ï¼š</li></ul><blockquote><p>-server -Xmx100m -Xms100m -XX:+DoEscapeAnalysis -XX:+PrintGC -XX:+EliminateAllocations</p></blockquote><p>è¿™é‡Œè®¾ç½®å‚æ•°å¦‚ä¸‹ï¼š</p><ul><li>å‚æ•° -serverï¼šå¯åŠ¨Serveræ¨¡å¼ï¼Œå› ä¸ºåœ¨serveræ¨¡å¼ä¸‹ï¼Œæ‰å¯ä»¥å¯ç”¨é€ƒé€¸åˆ†æã€‚</li><li>å‚æ•° -XX:+DoEscapeAnalysisï¼šå¯ç”¨é€ƒé€¸åˆ†æ</li><li>å‚æ•° -Xmx10mï¼šæŒ‡å®šäº†å †ç©ºé—´æœ€å¤§ä¸º10MB</li><li>å‚æ•° -XX:+PrintGCï¼šå°†æ‰“å°GCæ—¥å¿—ã€‚</li><li>å‚æ•° -XX:+EliminateAllocationsï¼šå¼€å¯äº†æ ‡é‡æ›¿æ¢ï¼ˆé»˜è®¤æ‰“å¼€ï¼‰ï¼Œå…è®¸å°†å¯¹è±¡æ‰“æ•£åˆ†é…åœ¨æ ˆä¸Šï¼Œæ¯”å¦‚å¯¹è±¡æ‹¥æœ‰idå’Œnameä¸¤ä¸ªå­—æ®µï¼Œé‚£ä¹ˆè¿™ä¸¤ä¸ªå­—æ®µå°†ä¼šè¢«è§†ä¸ºä¸¤ä¸ªç‹¬ç«‹çš„å±€éƒ¨å˜é‡è¿›è¡Œåˆ†é…</li></ul><h3 id="é€ƒé€¸åˆ†æçš„ä¸è¶³" tabindex="-1"><a class="header-anchor" href="#é€ƒé€¸åˆ†æçš„ä¸è¶³" aria-hidden="true">#</a> é€ƒé€¸åˆ†æçš„ä¸è¶³</h3><ul><li>å…³äºé€ƒé€¸åˆ†æçš„è®ºæ–‡åœ¨1999å¹´å°±å·²ç»å‘è¡¨äº†ï¼Œä½†ç›´åˆ°JDK1.6æ‰æœ‰å®ç°ï¼Œè€Œä¸”è¿™é¡¹æŠ€æœ¯åˆ°å¦‚ä»Šä¹Ÿå¹¶ä¸æ˜¯ååˆ†æˆç†Ÿçš„ã€‚</li><li>å…¶æ ¹æœ¬åŸå› å°±æ˜¯æ— æ³•ä¿è¯é€ƒé€¸åˆ†æçš„æ€§èƒ½æ¶ˆè€—ä¸€å®šèƒ½é«˜äºä»–çš„æ¶ˆè€—ã€‚è™½ç„¶ç»è¿‡é€ƒé€¸åˆ†æå¯ä»¥åšæ ‡é‡æ›¿æ¢ã€æ ˆä¸Šåˆ†é…ã€å’Œé”æ¶ˆé™¤ã€‚ä½†æ˜¯é€ƒé€¸åˆ†æè‡ªèº«ä¹Ÿæ˜¯éœ€è¦è¿›è¡Œä¸€ç³»åˆ—å¤æ‚çš„åˆ†æçš„ï¼Œè¿™å…¶å®ä¹Ÿæ˜¯ä¸€ä¸ªç›¸å¯¹è€—æ—¶çš„è¿‡ç¨‹ã€‚ä¸€ä¸ªæç«¯çš„ä¾‹å­ï¼Œå°±æ˜¯ç»è¿‡é€ƒé€¸åˆ†æä¹‹åï¼Œå‘ç°æ²¡æœ‰ä¸€ä¸ªå¯¹è±¡æ˜¯ä¸é€ƒé€¸çš„ã€‚é‚£è¿™ä¸ªé€ƒé€¸åˆ†æçš„è¿‡ç¨‹å°±ç™½ç™½æµªè´¹æ‰äº†ã€‚</li><li>è™½ç„¶è¿™é¡¹æŠ€æœ¯å¹¶ä¸ååˆ†æˆç†Ÿï¼Œä½†æ˜¯å®ƒä¹Ÿæ˜¯å³æ—¶ç¼–è¯‘å™¨ä¼˜åŒ–æŠ€æœ¯ä¸­ä¸€ä¸ªååˆ†é‡è¦çš„æ‰‹æ®µã€‚æ³¨æ„åˆ°æœ‰ä¸€äº›è§‚ç‚¹ï¼Œè®¤ä¸ºé€šè¿‡é€ƒé€¸åˆ†æï¼ŒJVMä¼šåœ¨æ ˆä¸Šåˆ†é…é‚£äº›ä¸ä¼šé€ƒé€¸çš„å¯¹è±¡ï¼Œè¿™åœ¨ç†è®ºä¸Šæ˜¯å¯è¡Œçš„ï¼Œä½†æ˜¯å–å†³äºJVMè®¾è®¡è€…çš„é€‰æ‹©ã€‚</li><li>æ®æˆ‘æ‰€çŸ¥ï¼Œ<strong>Oracle Hotspot JVMä¸­å¹¶æœªè¿™ä¹ˆåš</strong>ï¼Œè¿™ä¸€ç‚¹åœ¨é€ƒé€¸åˆ†æç›¸å…³çš„æ–‡æ¡£é‡Œå·²ç»è¯´æ˜ï¼Œæ‰€ä»¥å¯ä»¥æ˜ç¡®æ‰€æœ‰çš„å¯¹è±¡å®ä¾‹éƒ½æ˜¯åˆ›å»ºåœ¨å †ä¸Šã€‚</li><li><strong>Oracle Hotspot JVM</strong>æ˜¯é€šè¿‡æ ‡é‡æ›¿æ¢å®ç°é€ƒé€¸åˆ†æçš„</li><li>ç›®å‰å¾ˆå¤šä¹¦ç±è¿˜æ˜¯åŸºäºJDK7ä»¥å‰çš„ç‰ˆæœ¬ï¼ŒJDKå·²ç»å‘ç”Ÿäº†å¾ˆå¤§å˜åŒ–ï¼Œinternå­—ç¬¦ä¸²çš„ç¼“å­˜å’Œé™æ€å˜é‡æ›¾ç»éƒ½è¢«åˆ†é…åœ¨æ°¸ä¹…ä»£ä¸Šï¼Œè€Œæ°¸ä¹…ä»£å·²ç»è¢«å…ƒæ•°æ®åŒºå–ä»£ã€‚ä½†æ˜¯<strong>internå­—ç¬¦ä¸²ç¼“å­˜å’Œé™æ€å˜é‡å¹¶ä¸æ˜¯è¢«è½¬ç§»åˆ°å…ƒæ•°æ®åŒºï¼Œè€Œæ˜¯ç›´æ¥åœ¨å †ä¸Šåˆ†é…</strong>ï¼Œæ‰€ä»¥è¿™ä¸€ç‚¹åŒæ ·ç¬¦åˆå‰é¢ä¸€ç‚¹çš„ç»“è®ºï¼š<strong>å¯¹è±¡å®ä¾‹éƒ½æ˜¯åˆ†é…åœ¨å †ä¸Š</strong>ã€‚</li></ul><h1 id="å †æ€»ç»“" tabindex="-1"><a class="header-anchor" href="#å †æ€»ç»“" aria-hidden="true">#</a> å †æ€»ç»“</h1><ul><li>å¹´è½»ä»£æ˜¯å¯¹è±¡çš„è¯ç”Ÿã€æˆé•¿ã€æ¶ˆäº¡çš„åŒºåŸŸï¼Œä¸€ä¸ªå¯¹è±¡åœ¨è¿™é‡Œäº§ç”Ÿã€åº”ç”¨ï¼Œæœ€åè¢«åƒåœ¾å›æ”¶å™¨æ”¶é›†ã€ç»“æŸç”Ÿå‘½ã€‚</li><li>è€å¹´ä»£æ”¾ç½®é•¿ç”Ÿå‘½å‘¨æœŸçš„å¯¹è±¡ï¼Œé€šå¸¸éƒ½æ˜¯ä»SurvivoråŒºåŸŸç­›é€‰æ‹·è´è¿‡æ¥çš„Javaå¯¹è±¡ã€‚</li><li>å½“ç„¶ï¼Œä¹Ÿæœ‰ç‰¹æ®Šæƒ…å†µï¼Œæˆ‘ä»¬çŸ¥é“æ™®é€šçš„å¯¹è±¡å¯èƒ½ä¼šè¢«åˆ†é…åœ¨TLABä¸Š</li><li>å¦‚æœå¯¹è±¡è¾ƒå¤§ï¼Œæ— æ³•åˆ†é…åœ¨ TLAB ä¸Šï¼Œåˆ™JVMä¼šè¯•å›¾ç›´æ¥åˆ†é…åœ¨Edenå…¶ä»–ä½ç½®ä¸Š</li><li>å¦‚æœå¯¹è±¡å¤ªå¤§ï¼Œå®Œå…¨æ— æ³•åœ¨æ–°ç”Ÿä»£æ‰¾åˆ°è¶³å¤Ÿé•¿çš„è¿ç»­ç©ºé—²ç©ºé—´ï¼ŒJVMå°±ä¼šç›´æ¥åˆ†é…åˆ°è€å¹´ä»£</li><li>å½“GCåªå‘ç”Ÿåœ¨å¹´è½»ä»£ä¸­ï¼Œå›æ”¶å¹´è½»ä»£å¯¹è±¡çš„è¡Œä¸ºè¢«ç§°ä¸ºMinor GC</li><li>å½“GCå‘ç”Ÿåœ¨è€å¹´ä»£æ—¶åˆ™è¢«ç§°ä¸ºMajor GCï¼ˆä¸»è¦æ˜¯è€å¹´ä»£ï¼‰æˆ–è€…Full GCï¼ˆå›æ”¶å †ã€æ–¹æ³•åŒºï¼‰</li><li>ä¸€èˆ¬çš„ï¼ŒMinor GCçš„å‘ç”Ÿé¢‘ç‡è¦æ¯”Major GCé«˜å¾ˆå¤šï¼Œå³è€å¹´ä»£ä¸­åƒåœ¾å›æ”¶å‘ç”Ÿçš„é¢‘ç‡å°†å¤§å¤§ä½äºå¹´è½»ä»£</li></ul></div><!----><footer class="page-meta"><div class="meta-item edit-link"><a href="https://github.com/zeanzai/java-tips/edit/main/demo/theme-docs/src/Java/jvm/part1/8.å †.md" rel="noopener noreferrer" target="_blank" aria-label="åœ¨ GitHub ä¸Šç¼–è¾‘æ­¤é¡µ" class="nav-link label"><!--[--><svg xmlns="http://www.w3.org/2000/svg" class="icon edit-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="edit icon"><path d="M430.818 653.65a60.46 60.46 0 0 1-50.96-93.281l71.69-114.012 7.773-10.365L816.038 80.138A60.46 60.46 0 0 1 859.225 62a60.46 60.46 0 0 1 43.186 18.138l43.186 43.186a60.46 60.46 0 0 1 0 86.373L588.879 565.55l-8.637 8.637-117.466 68.234a60.46 60.46 0 0 1-31.958 11.229z"></path><path d="M728.802 962H252.891A190.883 190.883 0 0 1 62.008 771.98V296.934a190.883 190.883 0 0 1 190.883-192.61h267.754a60.46 60.46 0 0 1 0 120.92H252.891a69.962 69.962 0 0 0-69.098 69.099V771.98a69.962 69.962 0 0 0 69.098 69.098h475.911A69.962 69.962 0 0 0 797.9 771.98V503.363a60.46 60.46 0 1 1 120.922 0V771.98A190.883 190.883 0 0 1 728.802 962z"></path></svg><!--]-->åœ¨ GitHub ä¸Šç¼–è¾‘æ­¤é¡µ<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!----></a></div><div class="meta-item git-info"><div class="update-time"><span class="label">ä¸Šæ¬¡ç¼–è¾‘äº: </span><!----></div><div class="contributors"><span class="label">è´¡çŒ®è€…: </span><!--[--><!--[--><span class="contributor" title="email: zeanzai.me@gmail.com">zeanzai</span><!--]--><!--]--></div></div></footer><!----><!----><!----><!--]--></main><!--]--><footer class="footer-wrapper"><div class="footer">æµªæ¼«éª‘å£«çš„äºŒæµé”®ç›˜</div><div class="copyright">Copyright Â© 2024 zeanzai</div></footer></div><!--]--><!----><!----><!----><!--]--></div>
    <script type="module" src="/java-tips/assets/app-67da51a1.js" defer></script>
  </body>
</html>
