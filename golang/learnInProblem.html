<!DOCTYPE html>
<html lang="zh-CN" data-theme="light">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <meta name="generator" content="VuePress 2.0.0-beta.61" />
    <meta name="theme" content="VuePress Theme Hope" />
    <meta property="og:url" content="https://zeanzai.github.io/java-tips/java-tips/golang/learnInProblem.html"><meta property="og:site_name" content="CSLN"><meta property="og:title" content="从问题中学习到Go的精髓"><meta property="og:description" content="前言 参考书目及视频： 《The Way to Go》中文译本 (https://github.com/unknwon/the-way-to-goZHCN) Go 语言简明教程 (https://geektutu.com/post/quick-golang.html) Go: The Complete Developer's Guide (https:..."><meta property="og:type" content="article"><meta property="og:image" content="https://zeanzai.github.io/java-tips/java-tips/"><meta property="og:locale" content="zh-CN"><meta property="og:updated_time" content="2024-09-02T00:27:02.000Z"><meta name="twitter:card" content="summary_large_image"><meta name="twitter:image:alt" content="从问题中学习到Go的精髓"><meta property="article:author" content="zeanzai"><meta property="article:modified_time" content="2024-09-02T00:27:02.000Z"><script type="application/ld+json">{"@context":"https://schema.org","@type":"Article","headline":"从问题中学习到Go的精髓","image":["https://zeanzai.github.io/java-tips/java-tips/"],"dateModified":"2024-09-02T00:27:02.000Z","author":[{"@type":"Person","name":"zeanzai","url":"https://github.com/zeanzai"}]}</script><link rel="manifest" href="/java-tips/manifest.webmanifest" crossorigin="use-credentials"><meta name="theme-color" content="#46bd87"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover"><title>从问题中学习到Go的精髓 | CSLN</title><meta name="description" content="前言 参考书目及视频： 《The Way to Go》中文译本 (https://github.com/unknwon/the-way-to-goZHCN) Go 语言简明教程 (https://geektutu.com/post/quick-golang.html) Go: The Complete Developer's Guide (https:...">
    <style>
      :root {
        --bg-color: #fff;
      }

      html[data-theme="dark"] {
        --bg-color: #1d1e1f;
      }

      html,
      body {
        background: var(--bg-color);
      }
    </style>
    <script>
      const userMode = localStorage.getItem("vuepress-theme-hope-scheme");
      const systemDarkMode =
        window.matchMedia &&
        window.matchMedia("(prefers-color-scheme: dark)").matches;

      if (userMode === "dark" || (userMode !== "light" && systemDarkMode)) {
        document.documentElement.setAttribute("data-theme", "dark");
      }
    </script>
    <link rel="preload" href="/java-tips/assets/style-9c23f834.css" as="style"><link rel="stylesheet" href="/java-tips/assets/style-9c23f834.css">
    <link rel="modulepreload" href="/java-tips/assets/app-cd152169.js"><link rel="modulepreload" href="/java-tips/assets/framework-6a3aa88c.js"><link rel="modulepreload" href="/java-tips/assets/learnInProblem.html-24d9f9e5.js"><link rel="modulepreload" href="/java-tips/assets/learnInProblem.html-30c83c10.js">
  </head>
  <body>
    <div id="app"><!--[--><!--[--><!--[--><span tabindex="-1"></span><a href="#main-content" class="skip-link sr-only">跳至主要內容</a><!--]--><div class="theme-container has-toc"><!--[--><header class="navbar" id="navbar"><div class="navbar-start"><button type="button" class="toggle-sidebar-button" title="Toggle Sidebar"><span class="icon"></span></button><!--[--><!----><!--]--><a href="/java-tips/" class="brand"><img class="logo" src="/java-tips/logo.svg" alt="CSLN"><!----><span class="site-name hide-in-pad">CSLN</span></a><!--[--><!----><!--]--></div><div class="navbar-center"><!--[--><!----><!--]--><nav class="nav-links"><div class="nav-item hide-in-mobile"><a href="/java-tips/" class="nav-link" aria-label="主页"><span class="font-icon icon iconfont icon-home" style=""></span>主页<!----></a></div><div class="nav-item hide-in-mobile"><a href="/java-tips/intro/" class="nav-link" aria-label="导读"><span class="font-icon icon iconfont icon-discover" style=""></span>导读<!----></a></div><div class="nav-item hide-in-mobile"><a href="/java-tips/docs/" class="nav-link" aria-label="仓库"><span class="font-icon icon iconfont icon-discover" style=""></span>仓库<!----></a></div><div class="nav-item hide-in-mobile"><a href="/java-tips/notes/" class="nav-link" aria-label="笔记"><span class="font-icon icon iconfont icon-discover" style=""></span>笔记<!----></a></div><div class="nav-item hide-in-mobile"><a href="https://github.com/zeanzai/java-tips/issues" rel="noopener noreferrer" target="_blank" aria-label="问题反馈" class="nav-link"><span class="font-icon icon iconfont icon-note" style=""></span>问题反馈<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!----></a></div></nav><!--[--><!----><!--]--></div><div class="navbar-end"><!--[--><!----><!--]--><!----><div class="nav-item"><a class="repo-link" href="https://github.com/zeanzai/java-tips" target="_blank" rel="noopener noreferrer" aria-label="GitHub"><svg xmlns="http://www.w3.org/2000/svg" class="icon github-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="github icon" style="width:1.25rem;height:1.25rem;vertical-align:middle;"><path d="M511.957 21.333C241.024 21.333 21.333 240.981 21.333 512c0 216.832 140.544 400.725 335.574 465.664 24.49 4.395 32.256-10.07 32.256-23.083 0-11.69.256-44.245 0-85.205-136.448 29.61-164.736-64.64-164.736-64.64-22.315-56.704-54.4-71.765-54.4-71.765-44.587-30.464 3.285-29.824 3.285-29.824 49.195 3.413 75.179 50.517 75.179 50.517 43.776 75.008 114.816 53.333 142.762 40.79 4.523-31.66 17.152-53.377 31.19-65.537-108.971-12.458-223.488-54.485-223.488-242.602 0-53.547 19.114-97.323 50.517-131.67-5.035-12.33-21.93-62.293 4.779-129.834 0 0 41.258-13.184 134.912 50.346a469.803 469.803 0 0 1 122.88-16.554c41.642.213 83.626 5.632 122.88 16.554 93.653-63.488 134.784-50.346 134.784-50.346 26.752 67.541 9.898 117.504 4.864 129.834 31.402 34.347 50.474 78.123 50.474 131.67 0 188.586-114.73 230.016-224.042 242.09 17.578 15.232 33.578 44.672 33.578 90.454v135.85c0 13.142 7.936 27.606 32.854 22.87C862.25 912.597 1002.667 728.747 1002.667 512c0-271.019-219.648-490.667-490.71-490.667z"></path></svg></a></div><div class="nav-item hide-in-mobile"><button type="button" id="appearance-switch"><svg xmlns="http://www.w3.org/2000/svg" class="icon auto-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="auto icon" style="display:block;"><path d="M512 992C246.92 992 32 777.08 32 512S246.92 32 512 32s480 214.92 480 480-214.92 480-480 480zm0-840c-198.78 0-360 161.22-360 360 0 198.84 161.22 360 360 360s360-161.16 360-360c0-198.78-161.22-360-360-360zm0 660V212c165.72 0 300 134.34 300 300 0 165.72-134.28 300-300 300z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" class="icon dark-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="dark icon" style="display:none;"><path d="M524.8 938.667h-4.267a439.893 439.893 0 0 1-313.173-134.4 446.293 446.293 0 0 1-11.093-597.334A432.213 432.213 0 0 1 366.933 90.027a42.667 42.667 0 0 1 45.227 9.386 42.667 42.667 0 0 1 10.24 42.667 358.4 358.4 0 0 0 82.773 375.893 361.387 361.387 0 0 0 376.747 82.774 42.667 42.667 0 0 1 54.187 55.04 433.493 433.493 0 0 1-99.84 154.88 438.613 438.613 0 0 1-311.467 128z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" class="icon light-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="light icon" style="display:none;"><path d="M952 552h-80a40 40 0 0 1 0-80h80a40 40 0 0 1 0 80zM801.88 280.08a41 41 0 0 1-57.96-57.96l57.96-58a41.04 41.04 0 0 1 58 58l-58 57.96zM512 752a240 240 0 1 1 0-480 240 240 0 0 1 0 480zm0-560a40 40 0 0 1-40-40V72a40 40 0 0 1 80 0v80a40 40 0 0 1-40 40zm-289.88 88.08-58-57.96a41.04 41.04 0 0 1 58-58l57.96 58a41 41 0 0 1-57.96 57.96zM192 512a40 40 0 0 1-40 40H72a40 40 0 0 1 0-80h80a40 40 0 0 1 40 40zm30.12 231.92a41 41 0 0 1 57.96 57.96l-57.96 58a41.04 41.04 0 0 1-58-58l58-57.96zM512 832a40 40 0 0 1 40 40v80a40 40 0 0 1-80 0v-80a40 40 0 0 1 40-40zm289.88-88.08 58 57.96a41.04 41.04 0 0 1-58 58l-57.96-58a41 41 0 0 1 57.96-57.96z"></path></svg></button></div><!--[--><button type="button" class="search-pro-button" role="search" aria-label="搜索"><svg xmlns="http://www.w3.org/2000/svg" class="icon search-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="search icon"><path d="M192 480a256 256 0 1 1 512 0 256 256 0 0 1-512 0m631.776 362.496-143.2-143.168A318.464 318.464 0 0 0 768 480c0-176.736-143.264-320-320-320S128 303.264 128 480s143.264 320 320 320a318.016 318.016 0 0 0 184.16-58.592l146.336 146.368c12.512 12.48 32.768 12.48 45.28 0 12.48-12.512 12.48-32.768 0-45.28"></path></svg><div class="placeholder">搜索</div><div class="key-hints"><kbd class="key">Ctrl</kbd><kbd class="key">K</kbd></div></button><!--]--><!--[--><!----><!--]--><button type="button" class="toggle-navbar-button" aria-label="Toggle Navbar" aria-expanded="false" aria-controls="nav-screen"><span class="button-container"><span class="button-top"></span><span class="button-middle"></span><span class="button-bottom"></span></span></button></div></header><!----><!--]--><!----><div class="toggle-sidebar-wrapper"><span class="arrow start"></span></div><aside class="sidebar" id="sidebar"><!--[--><!----><!--]--><ul class="sidebar-links"><li><section class="sidebar-group"><button class="sidebar-heading clickable" type="button"><span class="font-icon icon iconfont icon-build" style=""></span><span class="title">计算机基础</span><span class="arrow end"></span></button><!----></section></li><li><section class="sidebar-group"><button class="sidebar-heading clickable" type="button"><span class="font-icon icon iconfont icon-vscode" style=""></span><span class="title">前端</span><span class="arrow end"></span></button><!----></section></li><li><section class="sidebar-group"><button class="sidebar-heading clickable active" type="button"><span class="font-icon icon iconfont icon-timer" style=""></span><span class="title">Golang</span><span class="arrow down"></span></button><ul class="sidebar-links"><li><!--[--><a aria-current="page" href="/java-tips/golang/learnInProblem.html" class="router-link-active router-link-exact-active nav-link active sidebar-link sidebar-page active" aria-label="从问题中学习到Go的精髓"><!---->从问题中学习到Go的精髓<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/java-tips/golang/learnInProblem.html#前言" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="前言"><!---->前言<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/java-tips/golang/learnInProblem.html#start" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="Start!"><!---->Start!<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/java-tips/golang/learnInProblem.html#golang为什么要有一个main的包" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="Golang为什么要有一个main的包？"><!---->Golang为什么要有一个main的包？<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/java-tips/golang/learnInProblem.html#go中的import是个什么原理" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="Go中的import是个什么原理？"><!---->Go中的import是个什么原理？<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/java-tips/golang/learnInProblem.html#【比较学习-举一反三】go在声明上和java有什么区别" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="【比较学习，举一反三】Go在声明上和Java有什么区别？"><!---->【比较学习，举一反三】Go在声明上和Java有什么区别？<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/java-tips/golang/learnInProblem.html#go中的返回类型和java中有什么区别" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="Go中的返回类型和Java中有什么区别？"><!---->Go中的返回类型和Java中有什么区别？<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/java-tips/golang/learnInProblem.html#go是如何读写文件的" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="Go是如何读写文件的？"><!---->Go是如何读写文件的？<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/java-tips/golang/learnInProblem.html#go什么时候接收器-什么时候又把这个参数放到括号内" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="Go什么时候接收器，什么时候又把这个参数放到括号内？"><!---->Go什么时候接收器，什么时候又把这个参数放到括号内？<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/java-tips/golang/learnInProblem.html#go的测试功能要怎么写呢" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="Go的测试功能要怎么写呢？"><!---->Go的测试功能要怎么写呢？<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/java-tips/golang/learnInProblem.html#go中的结构体" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="Go中的结构体"><!---->Go中的结构体<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/java-tips/golang/learnInProblem.html#go结构体中调用接收体会在内存中复制的问题" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="Go结构体中调用接收体会在内存中复制的问题"><!---->Go结构体中调用接收体会在内存中复制的问题<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/java-tips/golang/learnInProblem.html#map的形容介绍" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="Map的形容介绍"><!---->Map的形容介绍<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/java-tips/golang/learnInProblem.html#go在创建map的时候有什么不同" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="Go在创建Map的时候有什么不同？"><!---->Go在创建Map的时候有什么不同？<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/java-tips/golang/learnInProblem.html#和-的区别" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="= 和 := 的区别？"><!---->= 和 := 的区别？<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/java-tips/golang/learnInProblem.html#指针的作用" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="指针的作用"><!---->指针的作用<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/java-tips/golang/learnInProblem.html#go-允许多个返回值吗" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="Go 允许多个返回值吗？"><!---->Go 允许多个返回值吗？<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/java-tips/golang/learnInProblem.html#go-有异常类型吗" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="Go 有异常类型吗？"><!---->Go 有异常类型吗？<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/java-tips/golang/learnInProblem.html#什么是协程-goroutine" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="什么是协程（Goroutine）"><!---->什么是协程（Goroutine）<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/java-tips/golang/learnInProblem.html#如何高效地拼接字符串" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="如何高效地拼接字符串"><!---->如何高效地拼接字符串<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/java-tips/golang/learnInProblem.html#什么是-rune-类型" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="什么是 rune 类型"><!---->什么是 rune 类型<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/java-tips/golang/learnInProblem.html#如何判断-map-中是否包含某个-key" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="如何判断 map 中是否包含某个 key ？"><!---->如何判断 map 中是否包含某个 key ？<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/java-tips/golang/learnInProblem.html#go-支持默认参数或可选参数吗" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="Go 支持默认参数或可选参数吗？"><!---->Go 支持默认参数或可选参数吗？<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/java-tips/golang/learnInProblem.html#defer-的执行顺序" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="defer 的执行顺序"><!---->defer 的执行顺序<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/java-tips/golang/learnInProblem.html#如何交换-2-个变量的值" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="如何交换 2 个变量的值？"><!---->如何交换 2 个变量的值？<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/java-tips/golang/learnInProblem.html#go-语言-tag-的用处" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="Go 语言 tag 的用处？"><!---->Go 语言 tag 的用处？<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/java-tips/golang/learnInProblem.html#如何判断-2-个字符串切片-slice-是相等的" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="如何判断 2 个字符串切片（slice) 是相等的？"><!---->如何判断 2 个字符串切片（slice) 是相等的？<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/java-tips/golang/learnInProblem.html#字符串打印时-v-和-v-的区别" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="字符串打印时，%v 和 %+v 的区别"><!---->字符串打印时，%v 和 %+v 的区别<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/java-tips/golang/learnInProblem.html#go-语言中如何表示枚举值-enums" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="Go 语言中如何表示枚举值(enums)？"><!---->Go 语言中如何表示枚举值(enums)？<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/java-tips/golang/learnInProblem.html#空-struct-的用途" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="空 struct{} 的用途"><!---->空 struct{} 的用途<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/java-tips/golang/learnInProblem.html#go里面的int和int32是同一个概念吗" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="go里面的int和int32是同一个概念吗？"><!---->go里面的int和int32是同一个概念吗？<!----></a><ul class="sidebar-sub-headers"></ul></li></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/java-tips/golang/learnInProblem.html#java过渡go的第一个项目-todolist" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="Java过渡Go的第一个项目：TodoList"><!---->Java过渡Go的第一个项目：TodoList<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/java-tips/golang/learnInProblem.html#前言-1" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="前言"><!---->前言<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/java-tips/golang/learnInProblem.html#搭建外设" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="搭建外设"><!---->搭建外设<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/java-tips/golang/learnInProblem.html#建立数据库" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="建立数据库"><!---->建立数据库<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/java-tips/golang/learnInProblem.html#搭建vo对象" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="搭建VO对象"><!---->搭建VO对象<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/java-tips/golang/learnInProblem.html#搭建service层" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="搭建Service层"><!---->搭建Service层<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/java-tips/golang/learnInProblem.html#controller层" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="Controller层"><!---->Controller层<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/java-tips/golang/learnInProblem.html#搭建路由" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="搭建路由"><!---->搭建路由<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/java-tips/golang/learnInProblem.html#临时测试" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="临时测试"><!---->临时测试<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/java-tips/golang/learnInProblem.html#搭建swagger进行测试" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="搭建swagger进行测试"><!---->搭建swagger进行测试<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/java-tips/golang/learnInProblem.html#后记" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="后记"><!---->后记<!----></a><ul class="sidebar-sub-headers"></ul></li></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/java-tips/golang/learnInProblem.html#外传-项目实践-单例爬虫、协程并发爬虫" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="外传：项目实践：单例爬虫、协程并发爬虫"><!---->外传：项目实践：单例爬虫、协程并发爬虫<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/java-tips/golang/learnInProblem.html#使用说明" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="使用说明"><!---->使用说明<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/java-tips/golang/learnInProblem.html#新浪微博" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="新浪微博"><!---->新浪微博<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/java-tips/golang/learnInProblem.html#美之图" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="美之图"><!---->美之图<!----></a><ul class="sidebar-sub-headers"></ul></li></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/java-tips/golang/learnInProblem.html#问题汇总" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="问题汇总"><!---->问题汇总<!----></a><ul class="sidebar-sub-headers"></ul></li></ul><!--]--></li><li><!--[--><a href="/java-tips/golang/eightPart.html" class="nav-link sidebar-link sidebar-page" aria-label="Golang八股文收集"><!---->Golang八股文收集<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li></ul></section></li><li><section class="sidebar-group"><button class="sidebar-heading clickable" type="button"><span class="font-icon icon iconfont icon-light" style=""></span><span class="title">Rust</span><span class="arrow end"></span></button><!----></section></li><li><section class="sidebar-group"><button class="sidebar-heading clickable" type="button"><span class="font-icon icon iconfont icon-java" style=""></span><span class="title">Java</span><span class="arrow end"></span></button><!----></section></li><li><section class="sidebar-group"><button class="sidebar-heading clickable" type="button"><span class="font-icon icon iconfont icon-repair" style=""></span><span class="title">经验总结</span><span class="arrow end"></span></button><!----></section></li><li><section class="sidebar-group"><button class="sidebar-heading clickable" type="button"><span class="font-icon icon iconfont icon-autumn" style=""></span><span class="title">好物推荐</span><span class="arrow end"></span></button><!----></section></li><li><section class="sidebar-group"><button class="sidebar-heading clickable" type="button"><span class="font-icon icon iconfont icon-java" style=""></span><span class="title">docs</span><span class="arrow end"></span></button><!----></section></li></ul><!--[--><!----><!--]--></aside><!--[--><main class="page" id="main-content"><!--[--><!----><nav class="breadcrumb disable"></nav><div class="page-title"><h1><!---->从问题中学习到Go的精髓</h1><div class="page-info"><span class="page-author-info" aria-label="作者🖊" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon author-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="author icon"><path d="M649.6 633.6c86.4-48 147.2-144 147.2-249.6 0-160-128-288-288-288s-288 128-288 288c0 108.8 57.6 201.6 147.2 249.6-121.6 48-214.4 153.6-240 288-3.2 9.6 0 19.2 6.4 25.6 3.2 9.6 12.8 12.8 22.4 12.8h704c9.6 0 19.2-3.2 25.6-12.8 6.4-6.4 9.6-16 6.4-25.6-25.6-134.4-121.6-240-243.2-288z"></path></svg><span><a class="page-author-item" href="https://github.com/zeanzai" target="_blank" rel="noopener noreferrer">zeanzai</a></span><span property="author" content="zeanzai"></span></span><!----><span class="page-date-info" aria-label="写作日期📅" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon calendar-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="calendar icon"><path d="M716.4 110.137c0-18.753-14.72-33.473-33.472-33.473-18.753 0-33.473 14.72-33.473 33.473v33.473h66.993v-33.473zm-334.87 0c0-18.753-14.72-33.473-33.473-33.473s-33.52 14.72-33.52 33.473v33.473h66.993v-33.473zm468.81 33.52H716.4v100.465c0 18.753-14.72 33.473-33.472 33.473a33.145 33.145 0 01-33.473-33.473V143.657H381.53v100.465c0 18.753-14.72 33.473-33.473 33.473a33.145 33.145 0 01-33.473-33.473V143.657H180.6A134.314 134.314 0 0046.66 277.595v535.756A134.314 134.314 0 00180.6 947.289h669.74a134.36 134.36 0 00133.94-133.938V277.595a134.314 134.314 0 00-133.94-133.938zm33.473 267.877H147.126a33.145 33.145 0 01-33.473-33.473c0-18.752 14.72-33.473 33.473-33.473h736.687c18.752 0 33.472 14.72 33.472 33.473a33.145 33.145 0 01-33.472 33.473z"></path></svg><span><!----></span><meta property="datePublished" content="2024-09-02T00:27:02.000Z"></span><span class="page-pageview-info" aria-label="访问量🔢" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon eye-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="eye icon"><path d="M992 512.096c0-5.76-.992-10.592-1.28-11.136-.192-2.88-1.152-8.064-2.08-10.816-.256-.672-.544-1.376-.832-2.08-.48-1.568-1.024-3.104-1.6-4.32C897.664 290.112 707.104 160 512 160c-195.072 0-385.632 130.016-473.76 322.592-1.056 2.112-1.792 4.096-2.272 5.856a55.512 55.512 0 00-.64 1.6c-1.76 5.088-1.792 8.64-1.632 7.744-.832 3.744-1.568 11.168-1.568 11.168-.224 2.272-.224 4.032.032 6.304 0 0 .736 6.464 1.088 7.808.128 1.824.576 4.512 1.12 6.976h-.032c.448 2.08 1.12 4.096 1.984 6.08.48 1.536.992 2.976 1.472 4.032C126.432 733.856 316.992 864 512 864c195.136 0 385.696-130.048 473.216-321.696 1.376-2.496 2.24-4.832 2.848-6.912.256-.608.48-1.184.672-1.728 1.536-4.48 1.856-8.32 1.728-8.32l-.032.032c.608-3.104 1.568-7.744 1.568-13.28zM512 672c-88.224 0-160-71.776-160-160s71.776-160 160-160 160 71.776 160 160-71.776 160-160 160z"></path></svg><span class="waline-pageview-count" id="ArtalkPV" data-path="/java-tips/golang/learnInProblem.html">...</span></span><span class="page-reading-time-info" aria-label="阅读时间⌛" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon timer-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="timer icon"><path d="M799.387 122.15c4.402-2.978 7.38-7.897 7.38-13.463v-1.165c0-8.933-7.38-16.312-16.312-16.312H256.33c-8.933 0-16.311 7.38-16.311 16.312v1.165c0 5.825 2.977 10.874 7.637 13.592 4.143 194.44 97.22 354.963 220.201 392.763-122.204 37.542-214.893 196.511-220.2 389.397-4.661 5.049-7.638 11.651-7.638 19.03v5.825h566.49v-5.825c0-7.379-2.849-13.981-7.509-18.9-5.049-193.016-97.867-351.985-220.2-389.527 123.24-37.67 216.446-198.453 220.588-392.892zM531.16 450.445v352.632c117.674 1.553 211.787 40.778 211.787 88.676H304.097c0-48.286 95.149-87.382 213.728-88.676V450.445c-93.077-3.107-167.901-81.297-167.901-177.093 0-8.803 6.99-15.793 15.793-15.793 8.803 0 15.794 6.99 15.794 15.793 0 80.261 63.69 145.635 142.01 145.635s142.011-65.374 142.011-145.635c0-8.803 6.99-15.793 15.794-15.793s15.793 6.99 15.793 15.793c0 95.019-73.789 172.82-165.96 177.093z"></path></svg><span>大约 23 分钟</span><meta property="timeRequired" content="PT23M"></span><span class="page-category-info" aria-label="分类🌈" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon category-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="category icon"><path d="M148.41 106.992h282.176c22.263 0 40.31 18.048 40.31 40.31V429.48c0 22.263-18.047 40.31-40.31 40.31H148.41c-22.263 0-40.311-18.047-40.311-40.31V147.302c0-22.263 18.048-40.31 40.311-40.31zM147.556 553.478H429.73c22.263 0 40.311 18.048 40.311 40.31v282.176c0 22.263-18.048 40.312-40.31 40.312H147.555c-22.263 0-40.311-18.049-40.311-40.312V593.79c0-22.263 18.048-40.311 40.31-40.311zM593.927 106.992h282.176c22.263 0 40.31 18.048 40.31 40.31V429.48c0 22.263-18.047 40.31-40.31 40.31H593.927c-22.263 0-40.311-18.047-40.311-40.31V147.302c0-22.263 18.048-40.31 40.31-40.31zM730.22 920.502H623.926c-40.925 0-74.22-33.388-74.22-74.425V623.992c0-41.038 33.387-74.424 74.425-74.424h222.085c41.038 0 74.424 33.226 74.424 74.067v114.233c0 10.244-8.304 18.548-18.547 18.548s-18.548-8.304-18.548-18.548V623.635c0-20.388-16.746-36.974-37.33-36.974H624.13c-20.585 0-37.331 16.747-37.331 37.33v222.086c0 20.585 16.654 37.331 37.126 37.331H730.22c10.243 0 18.547 8.304 18.547 18.547 0 10.244-8.304 18.547-18.547 18.547z"></path></svg><span class="page-category-item category7" role>golang</span><meta property="articleSection" content="golang"></span><!----></div><hr></div><div class="toc-place-holder"><aside id="toc"><!--[--><!----><!--]--><div class="toc-header">此页内容<button type="button" class="print-button" title="打印"><svg xmlns="http://www.w3.org/2000/svg" class="icon print-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="print icon"><path d="M819.2 364.8h-44.8V128c0-17.067-14.933-32-32-32H281.6c-17.067 0-32 14.933-32 32v236.8h-44.8C145.067 364.8 96 413.867 96 473.6v192c0 59.733 49.067 108.8 108.8 108.8h44.8V896c0 17.067 14.933 32 32 32h460.8c17.067 0 32-14.933 32-32V774.4h44.8c59.733 0 108.8-49.067 108.8-108.8v-192c0-59.733-49.067-108.8-108.8-108.8zM313.6 160h396.8v204.8H313.6V160zm396.8 704H313.6V620.8h396.8V864zM864 665.6c0 25.6-19.2 44.8-44.8 44.8h-44.8V588.8c0-17.067-14.933-32-32-32H281.6c-17.067 0-32 14.933-32 32v121.6h-44.8c-25.6 0-44.8-19.2-44.8-44.8v-192c0-25.6 19.2-44.8 44.8-44.8h614.4c25.6 0 44.8 19.2 44.8 44.8v192z"></path></svg></button></div><div class="toc-wrapper"><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/java-tips/golang/learnInProblem.html#前言" class="router-link-active router-link-exact-active toc-link level2">前言</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/java-tips/golang/learnInProblem.html#start" class="router-link-active router-link-exact-active toc-link level2">Start!</a></li><li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/java-tips/golang/learnInProblem.html#golang为什么要有一个main的包" class="router-link-active router-link-exact-active toc-link level3">Golang为什么要有一个main的包？</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/java-tips/golang/learnInProblem.html#go中的import是个什么原理" class="router-link-active router-link-exact-active toc-link level3">Go中的import是个什么原理？</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/java-tips/golang/learnInProblem.html#【比较学习-举一反三】go在声明上和java有什么区别" class="router-link-active router-link-exact-active toc-link level3">【比较学习，举一反三】Go在声明上和Java有什么区别？</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/java-tips/golang/learnInProblem.html#go中的返回类型和java中有什么区别" class="router-link-active router-link-exact-active toc-link level3">Go中的返回类型和Java中有什么区别？</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/java-tips/golang/learnInProblem.html#go是如何读写文件的" class="router-link-active router-link-exact-active toc-link level3">Go是如何读写文件的？</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/java-tips/golang/learnInProblem.html#go什么时候接收器-什么时候又把这个参数放到括号内" class="router-link-active router-link-exact-active toc-link level3">Go什么时候接收器，什么时候又把这个参数放到括号内？</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/java-tips/golang/learnInProblem.html#go的测试功能要怎么写呢" class="router-link-active router-link-exact-active toc-link level3">Go的测试功能要怎么写呢？</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/java-tips/golang/learnInProblem.html#go中的结构体" class="router-link-active router-link-exact-active toc-link level3">Go中的结构体</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/java-tips/golang/learnInProblem.html#go结构体中调用接收体会在内存中复制的问题" class="router-link-active router-link-exact-active toc-link level3">Go结构体中调用接收体会在内存中复制的问题</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/java-tips/golang/learnInProblem.html#map的形容介绍" class="router-link-active router-link-exact-active toc-link level3">Map的形容介绍</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/java-tips/golang/learnInProblem.html#go在创建map的时候有什么不同" class="router-link-active router-link-exact-active toc-link level3">Go在创建Map的时候有什么不同？</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/java-tips/golang/learnInProblem.html#和-的区别" class="router-link-active router-link-exact-active toc-link level3">= 和 := 的区别？</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/java-tips/golang/learnInProblem.html#指针的作用" class="router-link-active router-link-exact-active toc-link level3">指针的作用</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/java-tips/golang/learnInProblem.html#go-允许多个返回值吗" class="router-link-active router-link-exact-active toc-link level3">Go 允许多个返回值吗？</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/java-tips/golang/learnInProblem.html#go-有异常类型吗" class="router-link-active router-link-exact-active toc-link level3">Go 有异常类型吗？</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/java-tips/golang/learnInProblem.html#什么是协程-goroutine" class="router-link-active router-link-exact-active toc-link level3">什么是协程（Goroutine）</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/java-tips/golang/learnInProblem.html#如何高效地拼接字符串" class="router-link-active router-link-exact-active toc-link level3">如何高效地拼接字符串</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/java-tips/golang/learnInProblem.html#什么是-rune-类型" class="router-link-active router-link-exact-active toc-link level3">什么是 rune 类型</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/java-tips/golang/learnInProblem.html#如何判断-map-中是否包含某个-key" class="router-link-active router-link-exact-active toc-link level3">如何判断 map 中是否包含某个 key ？</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/java-tips/golang/learnInProblem.html#go-支持默认参数或可选参数吗" class="router-link-active router-link-exact-active toc-link level3">Go 支持默认参数或可选参数吗？</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/java-tips/golang/learnInProblem.html#defer-的执行顺序" class="router-link-active router-link-exact-active toc-link level3">defer 的执行顺序</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/java-tips/golang/learnInProblem.html#如何交换-2-个变量的值" class="router-link-active router-link-exact-active toc-link level3">如何交换 2 个变量的值？</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/java-tips/golang/learnInProblem.html#go-语言-tag-的用处" class="router-link-active router-link-exact-active toc-link level3">Go 语言 tag 的用处？</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/java-tips/golang/learnInProblem.html#如何判断-2-个字符串切片-slice-是相等的" class="router-link-active router-link-exact-active toc-link level3">如何判断 2 个字符串切片（slice) 是相等的？</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/java-tips/golang/learnInProblem.html#字符串打印时-v-和-v-的区别" class="router-link-active router-link-exact-active toc-link level3">字符串打印时，%v 和 %+v 的区别</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/java-tips/golang/learnInProblem.html#go-语言中如何表示枚举值-enums" class="router-link-active router-link-exact-active toc-link level3">Go 语言中如何表示枚举值(enums)？</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/java-tips/golang/learnInProblem.html#空-struct-的用途" class="router-link-active router-link-exact-active toc-link level3">空 struct{} 的用途</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/java-tips/golang/learnInProblem.html#go里面的int和int32是同一个概念吗" class="router-link-active router-link-exact-active toc-link level3">go里面的int和int32是同一个概念吗？</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/java-tips/golang/learnInProblem.html#java过渡go的第一个项目-todolist" class="router-link-active router-link-exact-active toc-link level2">Java过渡Go的第一个项目：TodoList</a></li><li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/java-tips/golang/learnInProblem.html#前言-1" class="router-link-active router-link-exact-active toc-link level3">前言</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/java-tips/golang/learnInProblem.html#搭建外设" class="router-link-active router-link-exact-active toc-link level3">搭建外设</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/java-tips/golang/learnInProblem.html#建立数据库" class="router-link-active router-link-exact-active toc-link level3">建立数据库</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/java-tips/golang/learnInProblem.html#搭建vo对象" class="router-link-active router-link-exact-active toc-link level3">搭建VO对象</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/java-tips/golang/learnInProblem.html#搭建service层" class="router-link-active router-link-exact-active toc-link level3">搭建Service层</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/java-tips/golang/learnInProblem.html#controller层" class="router-link-active router-link-exact-active toc-link level3">Controller层</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/java-tips/golang/learnInProblem.html#搭建路由" class="router-link-active router-link-exact-active toc-link level3">搭建路由</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/java-tips/golang/learnInProblem.html#临时测试" class="router-link-active router-link-exact-active toc-link level3">临时测试</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/java-tips/golang/learnInProblem.html#搭建swagger进行测试" class="router-link-active router-link-exact-active toc-link level3">搭建swagger进行测试</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/java-tips/golang/learnInProblem.html#后记" class="router-link-active router-link-exact-active toc-link level3">后记</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/java-tips/golang/learnInProblem.html#外传-项目实践-单例爬虫、协程并发爬虫" class="router-link-active router-link-exact-active toc-link level2">外传：项目实践：单例爬虫、协程并发爬虫</a></li><li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/java-tips/golang/learnInProblem.html#使用说明" class="router-link-active router-link-exact-active toc-link level3">使用说明</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/java-tips/golang/learnInProblem.html#新浪微博" class="router-link-active router-link-exact-active toc-link level3">新浪微博</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/java-tips/golang/learnInProblem.html#美之图" class="router-link-active router-link-exact-active toc-link level3">美之图</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/java-tips/golang/learnInProblem.html#问题汇总" class="router-link-active router-link-exact-active toc-link level2">问题汇总</a></li><!----><!--]--></ul></div><!--[--><!----><!--]--></aside></div><!----><div class="theme-hope-content"><h1 id="golang-learn-in-problem-从问题中学习到go的精髓" tabindex="-1"><a class="header-anchor" href="#golang-learn-in-problem-从问题中学习到go的精髓" aria-hidden="true">#</a> Golang-Learn-In-Problem 从问题中学习到Go的精髓</h1><figure><img src="/java-tips/assets/logo-65212973.webp" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><h2 id="前言" tabindex="-1"><a class="header-anchor" href="#前言" aria-hidden="true">#</a> 前言</h2><p>参考书目及视频：</p><p><a href="https://github.com/unknwon/the-way-to-go_ZH_CN" target="_blank" rel="noopener noreferrer">《The Way to Go》中文译本<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><p><a href="https://geektutu.com/post/quick-golang.html" target="_blank" rel="noopener noreferrer">Go 语言简明教程<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><p><a href="https://www.udemy.com/course/go-the-complete-developers-guide/" target="_blank" rel="noopener noreferrer">Go: The Complete Developer&#39;s Guide<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><p>注：（<a href="https://www.udemy.com/course/go-the-complete-developers-guide/" target="_blank" rel="noopener noreferrer">Go: The Complete Developer&#39;s Guide<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>）欢迎去购买支持此课程，非常的棒！</p><h2 id="start" tabindex="-1"><a class="header-anchor" href="#start" aria-hidden="true">#</a> Start!</h2><p>下面的问题有些是自己思考问自己的，解答来自视频和思考。</p><p>还有部分问题来自极客兔兔，回答是官方FAQ（<a href="https://go.dev/doc/faq%EF%BC%89" target="_blank" rel="noopener noreferrer">https://go.dev/doc/faq）<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><h3 id="golang为什么要有一个main的包" tabindex="-1"><a class="header-anchor" href="#golang为什么要有一个main的包" aria-hidden="true">#</a> Golang为什么要有一个main的包？</h3><p>这个问题我在第一次学习Go的时候没有深究（因为使用的是Goland进行编写）</p><p>Golang的包分为两种：可执行包和可重复使用的包 or 依赖类型的包（里面放了很多可重用的辅助函数或可重用的东西），后者可以再分为包计算者和包上传者，如下图所示</p><figure><img src="/java-tips/assets/image-20220521211257013-6264651d.webp" alt="image-20220521211257013" tabindex="0" loading="lazy"><figcaption>image-20220521211257013</figcaption></figure><p>通过实验（使用go build编译）可以看到，如果我把package换成了其他，例如：xiaomi，没有生成文件</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>Mode                 LastWriteTime         Length Name

----                 -------------         ------ ----

-a----         <span class="token number">2022</span>/5/21     <span class="token number">21</span>:17             <span class="token number">76</span> main.go
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>如果归为main包，就可以看到</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>Mode                 LastWriteTime         Length Name
----                 -------------         ------ ----
-a----         <span class="token number">2022</span>/5/21     <span class="token number">21</span>:18        <span class="token number">1891328</span> main.exe
-a----         <span class="token number">2022</span>/5/21     <span class="token number">21</span>:18             <span class="token number">74</span> main.go
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>代码示例：</p><div class="language-go line-numbers-mode" data-ext="go"><pre class="language-go"><code><span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token string">&quot;fmt&quot;</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;Hello, world!&quot;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="go中的import是个什么原理" tabindex="-1"><a class="header-anchor" href="#go中的import是个什么原理" aria-hidden="true">#</a> Go中的import是个什么原理？</h3><p><a href="https://pkg.go.dev/std" target="_blank" rel="noopener noreferrer">https://pkg.go.dev/std<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><p>我的理解是通过import连接其它的可重用文件（链接其他包）</p><figure><img src="/java-tips/assets/image-20220521212519888-2c130383.webp" alt="image-20220521212519888" tabindex="0" loading="lazy"><figcaption>image-20220521212519888</figcaption></figure><h3 id="【比较学习-举一反三】go在声明上和java有什么区别" tabindex="-1"><a class="header-anchor" href="#【比较学习-举一反三】go在声明上和java有什么区别" aria-hidden="true">#</a> 【比较学习，举一反三】Go在声明上和Java有什么区别？</h3><p>Java声明函数举例：</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>Go函数声明：</p><div class="language-go line-numbers-mode" data-ext="go"><pre class="language-go"><code><span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token builtin">string</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>Java声明变量：</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token class-name">String</span> a <span class="token operator">=</span> <span class="token string">&quot;123&quot;</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>Go声明变量：</p><div class="language-go line-numbers-mode" data-ext="go"><pre class="language-go"><code><span class="token keyword">var</span> a <span class="token builtin">string</span> <span class="token operator">=</span> <span class="token string">&quot;123&quot;</span>
or
a <span class="token operator">:=</span> <span class="token string">&quot;123&quot;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Java声明数组：</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> a <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>Go的切片：</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>a := []int{1, 2, 3, 4}
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>其中的不同就是Go的切片可以相当于Java使用ArrayList</p><div class="language-go line-numbers-mode" data-ext="go"><pre class="language-go"><code>a <span class="token operator">=</span> <span class="token function">append</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>Java的for循环</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> a<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
or
<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> ac in a<span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
or <span class="token punctuation">(</span><span class="token keyword">if</span> a is a <span class="token class-name">List</span><span class="token punctuation">)</span>
a<span class="token punctuation">.</span><span class="token function">stream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span>e <span class="token operator">-&gt;</span> xxx<span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Go的for循环</p><div class="language-go line-numbers-mode" data-ext="go"><pre class="language-go"><code><span class="token keyword">for</span> i<span class="token punctuation">,</span> num <span class="token operator">:=</span> <span class="token keyword">range</span> a <span class="token punctuation">{</span><span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>Python的for循环</p><div class="language-python line-numbers-mode" data-ext="py"><pre class="language-python"><code><span class="token keyword">for</span> i<span class="token punctuation">,</span>num <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">:</span>
    xxxx
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>Go的自定义类型：</p><div class="language-go line-numbers-mode" data-ext="go"><pre class="language-go"><code><span class="token keyword">type</span> num <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">int</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>甚至可以为这个自定义类型声明一个成员函数</p><div class="language-go line-numbers-mode" data-ext="go"><pre class="language-go"><code><span class="token keyword">type</span> num <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">int</span>

<span class="token keyword">func</span> <span class="token punctuation">(</span>n num<span class="token punctuation">)</span> <span class="token function">print</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">for</span> i<span class="token punctuation">,</span> nu <span class="token operator">:=</span> <span class="token keyword">range</span> n <span class="token punctuation">{</span>
		fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> nu<span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="/java-tips/assets/image-20220523105431566-9627b4b5.webp" alt="image-20220523105431566" tabindex="0" loading="lazy"><figcaption>image-20220523105431566</figcaption></figure><p>上述中的 func (n num)中的<code>(n num)</code>实际上是接收器参数，每一个num类型的变量都可以调用此函数，老师的意思是实际上这是一个引用！</p><h3 id="go中的返回类型和java中有什么区别" tabindex="-1"><a class="header-anchor" href="#go中的返回类型和java中有什么区别" aria-hidden="true">#</a> Go中的返回类型和Java中有什么区别？</h3><p>Go可以返回多个，这个就和Java不一样，首先在函数的屁股后面加上返回的类型和个数，然后可以选择分片返回，这是Java8做不到的</p><div class="language-go line-numbers-mode" data-ext="go"><pre class="language-go"><code><span class="token keyword">func</span> <span class="token function">deal</span><span class="token punctuation">(</span>d deck<span class="token punctuation">,</span> handSize <span class="token builtin">int</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>deck<span class="token punctuation">,</span> deck<span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">return</span> d<span class="token punctuation">[</span><span class="token punctuation">:</span>handSize<span class="token punctuation">]</span><span class="token punctuation">,</span> d<span class="token punctuation">[</span>handSize<span class="token punctuation">:</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>这里的分片又和python有异曲同工之妙，用法都一样</p><h3 id="go是如何读写文件的" tabindex="-1"><a class="header-anchor" href="#go是如何读写文件的" aria-hidden="true">#</a> Go是如何读写文件的？</h3><p>写</p><hr><p>首先它返回一个error，原因是这个工具包如果出错会抛出一个异常；另外toString做了把一个数组转换为一坨字符串的效果；最后的0666是权限，这个一般是任何人都可以用</p><div class="language-go line-numbers-mode" data-ext="go"><pre class="language-go"><code><span class="token keyword">func</span> <span class="token punctuation">(</span>d deck<span class="token punctuation">)</span> <span class="token function">saveToFile</span><span class="token punctuation">(</span>filename <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token builtin">error</span> <span class="token punctuation">{</span>
	<span class="token keyword">return</span> ioutil<span class="token punctuation">.</span><span class="token function">WriteFile</span><span class="token punctuation">(</span>filename<span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token function">byte</span><span class="token punctuation">(</span>d<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">0666</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>再看[]byte做了什么</p><figure><img src="/java-tips/assets/image-20220524232214510-9bef9713.webp" alt="image-20220524232214510" tabindex="0" loading="lazy"><figcaption>image-20220524232214510</figcaption></figure><p>最后看它函数的定义</p><div class="language-go line-numbers-mode" data-ext="go"><pre class="language-go"><code><span class="token keyword">func</span> <span class="token function">WriteFile</span><span class="token punctuation">(</span>filename <span class="token builtin">string</span><span class="token punctuation">,</span> data <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">byte</span><span class="token punctuation">,</span> perm fs<span class="token punctuation">.</span>FileMode<span class="token punctuation">)</span> <span class="token builtin">error</span>

解释：WriteFile 将数据写入由文件名命名的文件。  如果文件不存在，WriteFile 使用权限 perm（在 umask 之前）创建它；  否则 WriteFile 在写入之前将其截断，而不更改权限。

<span class="token comment">// 官方例子</span>
<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	message <span class="token operator">:=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token function">byte</span><span class="token punctuation">(</span><span class="token string">&quot;Hello, Gophers!&quot;</span><span class="token punctuation">)</span>
	err <span class="token operator">:=</span> ioutil<span class="token punctuation">.</span><span class="token function">WriteFile</span><span class="token punctuation">(</span><span class="token string">&quot;hello&quot;</span><span class="token punctuation">,</span> message<span class="token punctuation">,</span> <span class="token number">0644</span><span class="token punctuation">)</span>
	<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
		log<span class="token punctuation">.</span><span class="token function">Fatal</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>读</p><hr><p>先看看API函数：</p><div class="language-go line-numbers-mode" data-ext="go"><pre class="language-go"><code><span class="token keyword">func</span> <span class="token function">ReadFile</span><span class="token punctuation">(</span>filename <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">byte</span><span class="token punctuation">,</span> <span class="token builtin">error</span><span class="token punctuation">)</span>
ReadFile 读取由 filename 命名的文件并返回内容。  成功的调用返回 err <span class="token operator">==</span> <span class="token boolean">nil</span>，而不是 err <span class="token operator">==</span> EOF。  因为 ReadFile 读取整个文件，所以它不会将 Read 中的 EOF 视为要报告的错误。
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>返回值也有不同</p><figure><img src="/java-tips/assets/image-20220525124905645-7cf4e101.webp" alt="image-20220525124905645" tabindex="0" loading="lazy"><figcaption>image-20220525124905645</figcaption></figure><p>当然这时会在想[]byte如何转换成string？当然就是直接转换即可string（[]byte）</p><div class="language-go line-numbers-mode" data-ext="go"><pre class="language-go"><code>bs<span class="token punctuation">,</span> err <span class="token operator">:=</span> ioutil<span class="token punctuation">.</span><span class="token function">ReadFile</span><span class="token punctuation">(</span>filename<span class="token punctuation">)</span>
<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
    <span class="token comment">// Option #1 - log the error and return a call to newDeck()</span>
    <span class="token comment">// Option #2 - log the error and entirely quit the program</span>
    fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;Error:&quot;</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span>
    os<span class="token punctuation">.</span><span class="token function">Exit</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
s <span class="token operator">:=</span> strings<span class="token punctuation">.</span><span class="token function">Split</span><span class="token punctuation">(</span><span class="token function">string</span><span class="token punctuation">(</span>bs<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">&quot;,&quot;</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="go什么时候接收器-什么时候又把这个参数放到括号内" tabindex="-1"><a class="header-anchor" href="#go什么时候接收器-什么时候又把这个参数放到括号内" aria-hidden="true">#</a> Go什么时候接收器，什么时候又把这个参数放到括号内？</h3><h3 id="go的测试功能要怎么写呢" tabindex="-1"><a class="header-anchor" href="#go的测试功能要怎么写呢" aria-hidden="true">#</a> Go的测试功能要怎么写呢？</h3><p>在Java中直接引入包然后注解@Test即可</p><p>在Go中需要导入<code>testing</code></p><p>参数处还有写上：<code>t *testing.T</code></p><div class="language-go line-numbers-mode" data-ext="go"><pre class="language-go"><code><span class="token keyword">func</span> <span class="token function">TestNewDeck</span><span class="token punctuation">(</span>t <span class="token operator">*</span>testing<span class="token punctuation">.</span>T<span class="token punctuation">)</span> <span class="token punctuation">{</span>
	d <span class="token operator">:=</span> <span class="token function">newDeck</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

	<span class="token keyword">if</span> <span class="token function">len</span><span class="token punctuation">(</span>d<span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token number">16</span> <span class="token punctuation">{</span>
		t<span class="token punctuation">.</span><span class="token function">Errorf</span><span class="token punctuation">(</span><span class="token string">&quot;Expected deck length of 16, but got %v&quot;</span><span class="token punctuation">,</span> <span class="token function">len</span><span class="token punctuation">(</span>d<span class="token punctuation">)</span><span class="token punctuation">)</span>
	<span class="token punctuation">}</span>

	<span class="token keyword">if</span> d<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token string">&quot;Ace of Spades&quot;</span> <span class="token punctuation">{</span>
		t<span class="token punctuation">.</span><span class="token function">Errorf</span><span class="token punctuation">(</span><span class="token string">&quot;Expected first card of Ace of Spades, but got %v&quot;</span><span class="token punctuation">,</span> d<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
	<span class="token punctuation">}</span>

	<span class="token keyword">if</span> d<span class="token punctuation">[</span><span class="token function">len</span><span class="token punctuation">(</span>d<span class="token punctuation">)</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token string">&quot;Four of Clubs&quot;</span> <span class="token punctuation">{</span>
		t<span class="token punctuation">.</span><span class="token function">Errorf</span><span class="token punctuation">(</span><span class="token string">&quot;Expected last card of Four of Clubs, but got %v&quot;</span><span class="token punctuation">,</span> d<span class="token punctuation">[</span><span class="token function">len</span><span class="token punctuation">(</span>d<span class="token punctuation">)</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Go如何测试文件的写入和读取？</p><p>流程是这样的：</p><ol><li>删除任何一个当前项目中含有相同名字的文件，例如：&quot;_decktesting&quot;</li><li>创建一个想要测试的类</li><li>保存这个文件</li><li>加载这个文件</li><li>断言这个文件的长度</li><li>删除现在文件中的包含这个名字的文件，例如：&quot;_decktesting&quot;</li></ol><div class="language-go line-numbers-mode" data-ext="go"><pre class="language-go"><code><span class="token keyword">func</span> <span class="token function">TestSaveToDeckAndNewDeckFromFile</span><span class="token punctuation">(</span>t <span class="token operator">*</span>testing<span class="token punctuation">.</span>T<span class="token punctuation">)</span> <span class="token punctuation">{</span>
	os<span class="token punctuation">.</span><span class="token function">Remove</span><span class="token punctuation">(</span><span class="token string">&quot;_decktesting&quot;</span><span class="token punctuation">)</span>

	d <span class="token operator">:=</span> <span class="token function">newDeck</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	d<span class="token punctuation">.</span><span class="token function">saveToFile</span><span class="token punctuation">(</span><span class="token string">&quot;_decktesting&quot;</span><span class="token punctuation">)</span>

	loadedDeck <span class="token operator">:=</span> <span class="token function">newDeckFromFile</span><span class="token punctuation">(</span><span class="token string">&quot;_decktesting&quot;</span><span class="token punctuation">)</span>

	<span class="token keyword">if</span> <span class="token function">len</span><span class="token punctuation">(</span>loadedDeck<span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token number">16</span> <span class="token punctuation">{</span>
		t<span class="token punctuation">.</span><span class="token function">Errorf</span><span class="token punctuation">(</span><span class="token string">&quot;Expected 16 cards in deck, got %v&quot;</span><span class="token punctuation">,</span> <span class="token function">len</span><span class="token punctuation">(</span>loadedDeck<span class="token punctuation">)</span><span class="token punctuation">)</span>
	<span class="token punctuation">}</span>

	os<span class="token punctuation">.</span><span class="token function">Remove</span><span class="token punctuation">(</span><span class="token string">&quot;_decktesting&quot;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="go中的结构体" tabindex="-1"><a class="header-anchor" href="#go中的结构体" aria-hidden="true">#</a> Go中的结构体</h3><p>老师在课程当中形容的很形象，这个struct就像python中的字典：</p><div class="language-go line-numbers-mode" data-ext="go"><pre class="language-go"><code><span class="token keyword">type</span> person <span class="token keyword">struct</span> <span class="token punctuation">{</span>
	lastName  <span class="token builtin">string</span>
	firstName <span class="token builtin">string</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	alex <span class="token operator">:=</span> person<span class="token punctuation">{</span>firstName<span class="token punctuation">:</span> <span class="token string">&quot;Alex&quot;</span><span class="token punctuation">,</span> lastName<span class="token punctuation">:</span> <span class="token string">&quot;Anderson&quot;</span><span class="token punctuation">}</span>

<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>可以通过这个语句查看key-value：<code>fmt.Printf(&quot;%+v&quot;, alex)</code></p><p>注：<code>%+v 先输出字段类型，再输出该字段的值</code></p><h3 id="go结构体中调用接收体会在内存中复制的问题" tabindex="-1"><a class="header-anchor" href="#go结构体中调用接收体会在内存中复制的问题" aria-hidden="true">#</a> Go结构体中调用接收体会在内存中复制的问题</h3><div class="language-go line-numbers-mode" data-ext="go"><pre class="language-go"><code><span class="token keyword">type</span> contactInfo <span class="token keyword">struct</span> <span class="token punctuation">{</span>
	email   <span class="token builtin">string</span>
	zipCode <span class="token builtin">int</span>
<span class="token punctuation">}</span>

<span class="token keyword">type</span> person <span class="token keyword">struct</span> <span class="token punctuation">{</span>
	lastName  <span class="token builtin">string</span>
	firstName <span class="token builtin">string</span>
	contactInfo
<span class="token punctuation">}</span>
<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

	jim <span class="token operator">:=</span> person<span class="token punctuation">{</span>
		firstName<span class="token punctuation">:</span> <span class="token string">&quot;Jim&quot;</span><span class="token punctuation">,</span>
		lastName<span class="token punctuation">:</span>  <span class="token string">&quot;Party&quot;</span><span class="token punctuation">,</span>
		contactInfo<span class="token punctuation">:</span> contactInfo<span class="token punctuation">{</span>
			email<span class="token punctuation">:</span>   <span class="token string">&quot;jim@gmail.com&quot;</span><span class="token punctuation">,</span>
			zipCode<span class="token punctuation">:</span> <span class="token number">94000</span><span class="token punctuation">,</span>
		<span class="token punctuation">}</span><span class="token punctuation">,</span>
	<span class="token punctuation">}</span>

	jim<span class="token punctuation">.</span><span class="token function">updateName</span><span class="token punctuation">(</span><span class="token string">&quot;Jimmy&quot;</span><span class="token punctuation">)</span>

	jim<span class="token punctuation">.</span><span class="token function">print</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token punctuation">(</span>pointerToPerson <span class="token operator">*</span>person<span class="token punctuation">)</span> <span class="token function">updateName</span><span class="token punctuation">(</span>name <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token punctuation">(</span><span class="token operator">*</span>pointerToPerson<span class="token punctuation">)</span><span class="token punctuation">.</span>firstName <span class="token operator">=</span> name
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token punctuation">(</span>p <span class="token operator">*</span>person<span class="token punctuation">)</span> <span class="token function">print</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">&quot;%+v&quot;</span><span class="token punctuation">,</span> p<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>如果直接调用接收体这种函数，在内存当中Go会把原先的复制，然后在新的内存中开辟再进行修改，像是下面这个图</p><figure><img src="/java-tips/assets/image-20220529135255808-a6b1d302.webp" alt="image-20220529135255808" tabindex="0" loading="lazy"><figcaption>image-20220529135255808</figcaption></figure><p>那么，我们如果不进行复制这步操作如何呢？首先要使用<code>&amp;</code>获取到这个结构体所在内存的位置，然后通过Go中的指针去改变当前的结构体内容</p><div class="language-go line-numbers-mode" data-ext="go"><pre class="language-go"><code><span class="token operator">...</span><span class="token operator">...</span><span class="token operator">...</span><span class="token operator">...</span><span class="token operator">...</span>
    jim <span class="token operator">:=</span> person<span class="token punctuation">{</span>
        firstName<span class="token punctuation">:</span> <span class="token string">&quot;Jim&quot;</span><span class="token punctuation">,</span>
        lastName<span class="token punctuation">:</span>  <span class="token string">&quot;Party&quot;</span><span class="token punctuation">,</span>
        contactInfo<span class="token punctuation">:</span> contactInfo<span class="token punctuation">{</span>
            email<span class="token punctuation">:</span>   <span class="token string">&quot;jim@gmail.com&quot;</span><span class="token punctuation">,</span>
            zipCode<span class="token punctuation">:</span> <span class="token number">94000</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span>

    jimPointer <span class="token operator">:=</span> <span class="token operator">&amp;</span>jim
    jimPointer<span class="token punctuation">.</span><span class="token function">updateName</span><span class="token punctuation">(</span><span class="token string">&quot;Jimmy&quot;</span><span class="token punctuation">)</span>

    jim<span class="token punctuation">.</span><span class="token function">print</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token keyword">func</span> <span class="token punctuation">(</span>pointerToPerson <span class="token operator">*</span>person<span class="token punctuation">)</span> <span class="token function">updateName</span><span class="token punctuation">(</span>name <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token punctuation">(</span><span class="token operator">*</span>pointerToPerson<span class="token punctuation">)</span><span class="token punctuation">.</span>firstName <span class="token operator">=</span> name
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>而每当看到<code>*</code>的时候就是想看到这个指针的值</p><p>总结：每当使用接收者作为参数传给函数的时候数据就会被复制，所以默认情况下都是再副本下完成的</p><p>而在数组切片中又有所不同：</p><div class="language-go line-numbers-mode" data-ext="go"><pre class="language-go"><code><span class="token keyword">import</span> <span class="token string">&quot;fmt&quot;</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	mySlice <span class="token operator">:=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">string</span><span class="token punctuation">{</span><span class="token string">&quot;Hi&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;There&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;How&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;Are&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;You&quot;</span><span class="token punctuation">}</span>

	<span class="token function">updateSlice</span><span class="token punctuation">(</span>mySlice<span class="token punctuation">)</span>

	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>mySlice<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">updateSlice</span><span class="token punctuation">(</span>s <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	s<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">&quot;Bye&quot;</span>
<span class="token punctuation">}</span>
<span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span>
<span class="token punctuation">[</span>Bye There How Are You<span class="token punctuation">]</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="/java-tips/assets/image-20220529141540704-415c73f2.webp" alt="image-20220529141540704" tabindex="0" loading="lazy"><figcaption>image-20220529141540704</figcaption></figure><p>每个数组都会分配这样的属性值（length, cap, ptr to head)，然后如果要进行切片操作的话就会进行一层复制，但是这个复制只是对其属性的复制，底层还是操作着同一个数组</p><figure><img src="/java-tips/assets/image-20220530203334648-d218784c.webp" alt="image-20220530203334648" tabindex="0" loading="lazy"><figcaption>image-20220530203334648</figcaption></figure><h3 id="map的形容介绍" tabindex="-1"><a class="header-anchor" href="#map的形容介绍" aria-hidden="true">#</a> Map的形容介绍</h3><figure><img src="/java-tips/assets/image-20220529141826436-1bfb9db7.webp" alt="image-20220529141826436" tabindex="0" loading="lazy"><figcaption>image-20220529141826436</figcaption></figure><h3 id="go在创建map的时候有什么不同" tabindex="-1"><a class="header-anchor" href="#go在创建map的时候有什么不同" aria-hidden="true">#</a> Go在创建Map的时候有什么不同？</h3><p>在Go中一般有3种方法创建map</p><p>这两个是没有初始化值的</p><div class="language-go line-numbers-mode" data-ext="go"><pre class="language-go"><code><span class="token keyword">var</span> colors <span class="token keyword">map</span><span class="token punctuation">[</span><span class="token builtin">string</span><span class="token punctuation">]</span><span class="token builtin">string</span>

colors <span class="token punctuation">;</span><span class="token operator">=</span> <span class="token function">make</span><span class="token punctuation">(</span><span class="token keyword">map</span><span class="token punctuation">[</span><span class="token builtin">string</span><span class="token punctuation">]</span><span class="token builtin">string</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>如果有值的话：</p><div class="language-go line-numbers-mode" data-ext="go"><pre class="language-go"><code>colors <span class="token operator">:=</span> <span class="token keyword">map</span><span class="token punctuation">[</span><span class="token builtin">string</span><span class="token punctuation">]</span><span class="token builtin">string</span><span class="token punctuation">{</span>
		<span class="token string">&quot;red&quot;</span><span class="token punctuation">:</span>   <span class="token string">&quot;#ff0000&quot;</span><span class="token punctuation">,</span>
		<span class="token string">&quot;green&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;#4bf745&quot;</span><span class="token punctuation">,</span>
		<span class="token string">&quot;white&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;#ffffff&quot;</span><span class="token punctuation">,</span>
	<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>而在Java中一般创建hashmap都是这样：</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> map <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
or
<span class="token keyword">new</span> <span class="token class-name">HashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
<span class="token punctuation">{</span>
        <span class="token function">put</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">&quot;one&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">put</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token string">&quot;two&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
or
<span class="token class-name">Map</span><span class="token punctuation">.</span><span class="token function">ofEntries</span><span class="token punctuation">(</span>
        <span class="token function">entry</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">&quot;one&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token function">entry</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token string">&quot;two&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token function">entry</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token string">&quot;three&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">)</span>
or
<span class="token class-name">Stream</span><span class="token punctuation">.</span><span class="token function">of</span><span class="token punctuation">(</span>
            <span class="token keyword">new</span> <span class="token class-name">SimpleEntry</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">&quot;one&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token keyword">new</span> <span class="token class-name">SimpleEntry</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token string">&quot;two&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token keyword">new</span> <span class="token class-name">SimpleEntry</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token string">&quot;three&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">collect</span><span class="token punctuation">(</span><span class="token class-name">Collectors</span><span class="token punctuation">.</span><span class="token function">toMap</span><span class="token punctuation">(</span><span class="token class-name">SimpleEntry</span><span class="token operator">::</span><span class="token function">getKey</span><span class="token punctuation">,</span> <span class="token class-name">SimpleEntry</span><span class="token operator">::</span><span class="token function">getValue</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>而这个map的删除元素的函数也是有所不同，使用<code>delete</code>进行删除</p><h3 id="和-的区别" tabindex="-1"><a class="header-anchor" href="#和-的区别" aria-hidden="true">#</a> <code>=</code> 和 <code>:=</code> 的区别？</h3><p>=是赋值变量，:=是定义变量。</p><h3 id="指针的作用" tabindex="-1"><a class="header-anchor" href="#指针的作用" aria-hidden="true">#</a> 指针的作用</h3><p>一个指针可以指向任意变量的地址，它所指向的地址在32位或64位机器上分别<strong>固定</strong>占4或8个字节。指针的作用有：</p><ul><li>获取变量的值</li></ul><div class="language-go line-numbers-mode" data-ext="go"><pre class="language-go"><code> <span class="token keyword">import</span> fmt
 
 <span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  a <span class="token operator">:=</span> <span class="token number">1</span>
  p <span class="token operator">:=</span> <span class="token operator">&amp;</span>a<span class="token comment">//取址&amp;</span>
  fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">&quot;%d\n&quot;</span><span class="token punctuation">,</span> <span class="token operator">*</span>p<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//取值*</span>
 <span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>改变变量的值</li></ul><div class="language-go line-numbers-mode" data-ext="go"><pre class="language-go"><code> <span class="token comment">// 交换函数</span>
 <span class="token keyword">func</span> <span class="token function">swap</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b <span class="token operator">*</span><span class="token builtin">int</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
     <span class="token operator">*</span>a<span class="token punctuation">,</span> <span class="token operator">*</span>b <span class="token operator">=</span> <span class="token operator">*</span>b<span class="token punctuation">,</span> <span class="token operator">*</span>a
 <span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>用指针替代值传入函数，比如类的接收器就是这样的。</li></ul><div class="language-go line-numbers-mode" data-ext="go"><pre class="language-go"><code> <span class="token keyword">type</span> A <span class="token keyword">struct</span><span class="token punctuation">{</span><span class="token punctuation">}</span>
 
 <span class="token keyword">func</span> <span class="token punctuation">(</span>a <span class="token operator">*</span>A<span class="token punctuation">)</span> <span class="token function">fun</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="go-允许多个返回值吗" tabindex="-1"><a class="header-anchor" href="#go-允许多个返回值吗" aria-hidden="true">#</a> Go 允许多个返回值吗？</h3><p>可以。通常函数除了一般返回值还会返回一个error。</p><h3 id="go-有异常类型吗" tabindex="-1"><a class="header-anchor" href="#go-有异常类型吗" aria-hidden="true">#</a> Go 有异常类型吗？</h3><p>有。Go用error类型代替try...catch语句，这样可以节省资源。同时增加代码可读性：</p><div class="language-go line-numbers-mode" data-ext="go"><pre class="language-go"><code> <span class="token boolean">_</span><span class="token punctuation">,</span>err <span class="token operator">:=</span> <span class="token function">errorDemo</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token keyword">if</span> err<span class="token operator">!=</span><span class="token boolean">nil</span><span class="token punctuation">{</span>
   fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span>
   <span class="token keyword">return</span>
  <span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>也可以用errors.New()来定义自己的异常。errors.Error()会返回异常的字符串表示。只要实现error接口就可以定义自己的异常，</p><div class="language-go line-numbers-mode" data-ext="go"><pre class="language-go"><code> <span class="token keyword">type</span> errorString <span class="token keyword">struct</span> <span class="token punctuation">{</span>
  s <span class="token builtin">string</span>
 <span class="token punctuation">}</span>
 
 <span class="token keyword">func</span> <span class="token punctuation">(</span>e <span class="token operator">*</span>errorString<span class="token punctuation">)</span> <span class="token function">Error</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token builtin">string</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> e<span class="token punctuation">.</span>s
 <span class="token punctuation">}</span>
 
 <span class="token comment">// 多一个函数当作构造函数</span>
 <span class="token keyword">func</span> <span class="token function">New</span><span class="token punctuation">(</span>text <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token builtin">error</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token operator">&amp;</span>errorString<span class="token punctuation">{</span>text<span class="token punctuation">}</span>
 <span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="什么是协程-goroutine" tabindex="-1"><a class="header-anchor" href="#什么是协程-goroutine" aria-hidden="true">#</a> 什么是协程（Goroutine）</h3><p>协程是<strong>用户态轻量级线程</strong>，它是<strong>线程调度的基本单位</strong>。通常在函数前加上go关键字就能实现并发。一个Goroutine会以一个很小的栈启动2KB或4KB，当遇到栈空间不足时，栈会<strong>自动伸缩</strong>， 因此可以轻易实现成千上万个goroutine同时启动。</p><h3 id="如何高效地拼接字符串" tabindex="-1"><a class="header-anchor" href="#如何高效地拼接字符串" aria-hidden="true">#</a> 如何高效地拼接字符串</h3><p>拼接字符串的方式有：&quot;+&quot;, fmt.Sprintf, strings.Builder, bytes.Buffer, strings.Join</p><ol><li>&quot;+&quot;</li></ol><p>使用<code>+</code>操作符进行拼接时，会对字符串进行遍历，计算并开辟一个新的空间来存储原来的两个字符串。</p><ol start="2"><li>fmt.Sprintf</li></ol><p>由于采用了接口参数，必须要用反射获取值，因此有性能损耗。</p><ol start="3"><li>strings.Builder：</li></ol><p>用WriteString()进行拼接，内部实现是指针+切片，同时String()返回拼接后的字符串，它是直接把[]byte转换为string，从而避免变量拷贝。</p><p><code>strings.builder</code>的实现原理很简单，结构如下：</p><div class="language-go line-numbers-mode" data-ext="go"><pre class="language-go"><code> <span class="token keyword">type</span> Builder <span class="token keyword">struct</span> <span class="token punctuation">{</span>
     addr <span class="token operator">*</span>Builder <span class="token comment">// of receiver, to detect copies by value</span>
     buf  <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">byte</span> <span class="token comment">// 1</span>
 <span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><code>addr</code>字段主要是做<code>copycheck</code>，<code>buf</code>字段是一个<code>byte</code>类型的切片，这个就是用来存放字符串内容的，提供的<code>writeString()</code>方法就是像切片<code>buf</code>中追加数据：</p><div class="language-go line-numbers-mode" data-ext="go"><pre class="language-go"><code> <span class="token keyword">func</span> <span class="token punctuation">(</span>b <span class="token operator">*</span>Builder<span class="token punctuation">)</span> <span class="token function">WriteString</span><span class="token punctuation">(</span>s <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">,</span> <span class="token builtin">error</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
     b<span class="token punctuation">.</span><span class="token function">copyCheck</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
     b<span class="token punctuation">.</span>buf <span class="token operator">=</span> <span class="token function">append</span><span class="token punctuation">(</span>b<span class="token punctuation">.</span>buf<span class="token punctuation">,</span> s<span class="token operator">...</span><span class="token punctuation">)</span>
     <span class="token keyword">return</span> <span class="token function">len</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token boolean">nil</span>
 <span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>提供的<code>String</code>方法就是将<code>[]byte</code>转换为<code>string</code>类型，这里为了避免内存拷贝的问题，使用了强制转换来避免内存拷贝：</p><div class="language-go line-numbers-mode" data-ext="go"><pre class="language-go"><code> <span class="token keyword">func</span> <span class="token punctuation">(</span>b <span class="token operator">*</span>Builder<span class="token punctuation">)</span> <span class="token function">String</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token builtin">string</span> <span class="token punctuation">{</span>
     <span class="token keyword">return</span> <span class="token operator">*</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token builtin">string</span><span class="token punctuation">)</span><span class="token punctuation">(</span>unsafe<span class="token punctuation">.</span><span class="token function">Pointer</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>b<span class="token punctuation">.</span>buf<span class="token punctuation">)</span><span class="token punctuation">)</span>
 <span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol start="4"><li>bytes.Buffer</li></ol><p><code>bytes.Buffer</code>是一个一个缓冲<code>byte</code>类型的缓冲器，这个缓冲器里存放着都是<code>byte</code>。使用方式如下：</p><p><code>bytes.buffer</code>底层也是一个<code>[]byte</code>切片，结构体如下：</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>type Buffer struct {
    buf      []byte // contents are the bytes buf[off : len(buf)]
    off      int    // read at &amp;buf[off], write at &amp;buf[len(buf)]
    lastRead readOp // last read operation, so that Unread* can work correctly.
}
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>因为<code>bytes.Buffer</code>可以持续向<code>Buffer</code>尾部写入数据，从<code>Buffer</code>头部读取数据，所以<code>off</code>字段用来记录读取位置，再利用切片的<code>cap</code>特性来知道写入位置，这个不是本次的重点，重点看一下<code>WriteString</code>方法是如何拼接字符串的：</p><div class="language-go line-numbers-mode" data-ext="go"><pre class="language-go"><code><span class="token keyword">func</span> <span class="token punctuation">(</span>b <span class="token operator">*</span>Buffer<span class="token punctuation">)</span> <span class="token function">WriteString</span><span class="token punctuation">(</span>s <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>n <span class="token builtin">int</span><span class="token punctuation">,</span> err <span class="token builtin">error</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    b<span class="token punctuation">.</span>lastRead <span class="token operator">=</span> opInvalid
    m<span class="token punctuation">,</span> ok <span class="token operator">:=</span> b<span class="token punctuation">.</span><span class="token function">tryGrowByReslice</span><span class="token punctuation">(</span><span class="token function">len</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">if</span> <span class="token operator">!</span>ok <span class="token punctuation">{</span>
        m <span class="token operator">=</span> b<span class="token punctuation">.</span><span class="token function">grow</span><span class="token punctuation">(</span><span class="token function">len</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> <span class="token function">copy</span><span class="token punctuation">(</span>b<span class="token punctuation">.</span>buf<span class="token punctuation">[</span>m<span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">,</span> s<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token boolean">nil</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>切片在创建时并不会申请内存块，只有在往里写数据时才会申请，首次申请的大小即为写入数据的大小。如果写入的数据小于64字节，则按64字节申请。采用动态扩展<code>slice</code>的机制，字符串追加采用<code>copy</code>的方式将追加的部分拷贝到尾部，<code>copy</code>是内置的拷贝函数，可以减少内存分配。</p><p>但是在将<code>[]byte</code>转换为<code>string</code>类型依旧使用了标准类型，所以会发生内存分配：</p><div class="language-go line-numbers-mode" data-ext="go"><pre class="language-go"><code><span class="token keyword">func</span> <span class="token punctuation">(</span>b <span class="token operator">*</span>Buffer<span class="token punctuation">)</span> <span class="token function">String</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token builtin">string</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> b <span class="token operator">==</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
        <span class="token comment">// Special case, useful in debugging.</span>
        <span class="token keyword">return</span> <span class="token string">&quot;&lt;nil&gt;&quot;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> <span class="token function">string</span><span class="token punctuation">(</span>b<span class="token punctuation">.</span>buf<span class="token punctuation">[</span>b<span class="token punctuation">.</span>off<span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol start="5"><li>strings.join</li></ol><p><code>strings.join</code>也是基于<code>strings.builder</code>来实现的,并且可以自定义分隔符，代码如下：</p><div class="language-go line-numbers-mode" data-ext="go"><pre class="language-go"><code><span class="token keyword">func</span> <span class="token function">Join</span><span class="token punctuation">(</span>elems <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">string</span><span class="token punctuation">,</span> sep <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token builtin">string</span> <span class="token punctuation">{</span>
    <span class="token keyword">switch</span> <span class="token function">len</span><span class="token punctuation">(</span>elems<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">case</span> <span class="token number">0</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> <span class="token string">&quot;&quot;</span>
    <span class="token keyword">case</span> <span class="token number">1</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> elems<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
    <span class="token punctuation">}</span>
    n <span class="token operator">:=</span> <span class="token function">len</span><span class="token punctuation">(</span>sep<span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token function">len</span><span class="token punctuation">(</span>elems<span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span>
    <span class="token keyword">for</span> i <span class="token operator">:=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token function">len</span><span class="token punctuation">(</span>elems<span class="token punctuation">)</span><span class="token punctuation">;</span> i<span class="token operator">++</span> <span class="token punctuation">{</span>
        n <span class="token operator">+=</span> <span class="token function">len</span><span class="token punctuation">(</span>elems<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">var</span> b Builder
    b<span class="token punctuation">.</span><span class="token function">Grow</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span>
    b<span class="token punctuation">.</span><span class="token function">WriteString</span><span class="token punctuation">(</span>elems<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token keyword">for</span> <span class="token boolean">_</span><span class="token punctuation">,</span> s <span class="token operator">:=</span> <span class="token keyword">range</span> elems<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token punctuation">]</span> <span class="token punctuation">{</span>
        b<span class="token punctuation">.</span><span class="token function">WriteString</span><span class="token punctuation">(</span>sep<span class="token punctuation">)</span>
        b<span class="token punctuation">.</span><span class="token function">WriteString</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> b<span class="token punctuation">.</span><span class="token function">String</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>唯一不同在于在<code>join</code>方法内调用了<code>b.Grow(n)</code>方法，这个是进行初步的容量分配，而前面计算的n的长度就是我们要拼接的slice的长度，因为我们传入切片长度固定，所以提前进行容量分配可以减少内存分配，很高效。</p><div class="language-go line-numbers-mode" data-ext="go"><pre class="language-go"><code><span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	a <span class="token operator">:=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">string</span><span class="token punctuation">{</span><span class="token string">&quot;a&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;b&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;c&quot;</span><span class="token punctuation">}</span>
	<span class="token comment">//方式1：</span>
	ret <span class="token operator">:=</span> a<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">+</span> a<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">+</span> a<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span>
	<span class="token comment">//方式2：</span>
	ret <span class="token operator">:=</span> fmt<span class="token punctuation">.</span><span class="token function">Sprintf</span><span class="token punctuation">(</span>a<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span>a<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span>a<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
	<span class="token comment">//方式3：</span>
	<span class="token keyword">var</span> sb strings<span class="token punctuation">.</span>Builder
	sb<span class="token punctuation">.</span><span class="token function">WriteString</span><span class="token punctuation">(</span>a<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
	sb<span class="token punctuation">.</span><span class="token function">WriteString</span><span class="token punctuation">(</span>a<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
	sb<span class="token punctuation">.</span><span class="token function">WriteString</span><span class="token punctuation">(</span>a<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
	ret <span class="token operator">:=</span> sb<span class="token punctuation">.</span><span class="token function">String</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token comment">//方式4：</span>
	buf <span class="token operator">:=</span> <span class="token function">new</span><span class="token punctuation">(</span>bytes<span class="token punctuation">.</span>Buffer<span class="token punctuation">)</span>
	buf<span class="token punctuation">.</span><span class="token function">Write</span><span class="token punctuation">(</span>a<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
	buf<span class="token punctuation">.</span><span class="token function">Write</span><span class="token punctuation">(</span>a<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
	buf<span class="token punctuation">.</span><span class="token function">Write</span><span class="token punctuation">(</span>a<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
	ret <span class="token operator">:=</span> buf<span class="token punctuation">.</span><span class="token function">String</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token comment">//方式5：</span>
	ret <span class="token operator">:=</span> strings<span class="token punctuation">.</span><span class="token function">Join</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span><span class="token string">&quot;&quot;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>总结：</p><p>strings.Join ≈ strings.Builder &gt; bytes.Buffer &gt; &quot;+&quot; &gt; fmt.Sprintf</p><blockquote><p>参考资料：<a href="https://geektutu.com/post/hpg-string-concat.html" target="_blank" rel="noopener noreferrer">字符串拼接性能及原理 | Go 语言高性能编程 | 极客兔兔<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p></blockquote><h3 id="什么是-rune-类型" tabindex="-1"><a class="header-anchor" href="#什么是-rune-类型" aria-hidden="true">#</a> 什么是 rune 类型</h3><p>rune是int32的别名，用来区分字符值和整数值。比如utf-8汉字占3个字节，按照一般方法遍历汉字字符串得到的是乱码，这个时候要将字符串转换为rune:</p><div class="language-go line-numbers-mode" data-ext="go"><pre class="language-go"><code>	sample <span class="token operator">:=</span> <span class="token string">&quot;我爱GO&quot;</span>
	runeSamp <span class="token operator">:=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token function">rune</span><span class="token punctuation">(</span>sample<span class="token punctuation">)</span>
	runeSamp<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token char">&#39;你&#39;</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token function">string</span><span class="token punctuation">(</span>runeSamp<span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="如何判断-map-中是否包含某个-key" tabindex="-1"><a class="header-anchor" href="#如何判断-map-中是否包含某个-key" aria-hidden="true">#</a> 如何判断 map 中是否包含某个 key ？</h3><div class="language-go line-numbers-mode" data-ext="go"><pre class="language-go"><code><span class="token keyword">var</span> sample <span class="token keyword">map</span><span class="token punctuation">[</span><span class="token builtin">int</span><span class="token punctuation">]</span><span class="token builtin">int</span>
<span class="token keyword">if</span> <span class="token boolean">_</span><span class="token punctuation">,</span> ok <span class="token operator">:=</span> sample<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">;</span>ok<span class="token punctuation">{</span>

<span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>

<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="go-支持默认参数或可选参数吗" tabindex="-1"><a class="header-anchor" href="#go-支持默认参数或可选参数吗" aria-hidden="true">#</a> Go 支持默认参数或可选参数吗？</h3><p>不支持。但是可以利用结构体参数，或者...传入参数切片。</p><h3 id="defer-的执行顺序" tabindex="-1"><a class="header-anchor" href="#defer-的执行顺序" aria-hidden="true">#</a> defer 的执行顺序</h3><p>defer执行顺序和调用顺序相反，类似于栈先进后出。</p><h3 id="如何交换-2-个变量的值" tabindex="-1"><a class="header-anchor" href="#如何交换-2-个变量的值" aria-hidden="true">#</a> 如何交换 2 个变量的值？</h3><p>对于变量而言<code>a,b = b,a</code>； 对于指针而言<code>*a,*b = *b, *a</code></p><h3 id="go-语言-tag-的用处" tabindex="-1"><a class="header-anchor" href="#go-语言-tag-的用处" aria-hidden="true">#</a> Go 语言 tag 的用处？</h3><p>tag可以为结构体成员提供属性。常见的：</p><ol><li>json序列化或反序列化时字段的名称</li><li>db: sqlx模块中对应的数据库字段名</li><li>form: gin框架中对应的前端的数据字段名</li><li>binding: 搭配 form 使用, 默认如果没查找到结构体中的某个字段则不报错值为空, binding为 required 代表没找到返回错误给前端</li></ol><h3 id="如何判断-2-个字符串切片-slice-是相等的" tabindex="-1"><a class="header-anchor" href="#如何判断-2-个字符串切片-slice-是相等的" aria-hidden="true">#</a> 如何判断 2 个字符串切片（slice) 是相等的？</h3><p>利用反射：</p><div class="language-go line-numbers-mode" data-ext="go"><pre class="language-go"><code><span class="token keyword">type</span> Author <span class="token keyword">struct</span> <span class="token punctuation">{</span>
	Name         <span class="token builtin">int</span>      <span class="token string">`json:Name`</span>
	Publications <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">string</span> <span class="token string">`json:Publication,omitempty`</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	t <span class="token operator">:=</span> reflect<span class="token punctuation">.</span><span class="token function">TypeOf</span><span class="token punctuation">(</span>Author<span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
	<span class="token keyword">for</span> i <span class="token operator">:=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> t<span class="token punctuation">.</span><span class="token function">NumField</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> i<span class="token operator">++</span> <span class="token punctuation">{</span>
		name <span class="token operator">:=</span> t<span class="token punctuation">.</span><span class="token function">Field</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">.</span>Name
		s<span class="token punctuation">,</span> <span class="token boolean">_</span> <span class="token operator">:=</span> t<span class="token punctuation">.</span><span class="token function">FieldByName</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span>
		fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>s<span class="token punctuation">.</span>Tag<span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="字符串打印时-v-和-v-的区别" tabindex="-1"><a class="header-anchor" href="#字符串打印时-v-和-v-的区别" aria-hidden="true">#</a> 字符串打印时，<code>%v</code> 和 <code>%+v</code> 的区别</h3><p><code>%v</code>输出结构体各成员的值；</p><p><code>%+v</code>输出结构体各成员的名称和值；</p><p><code>%#v</code>输出结构体名称和结构体各成员的名称和值</p><h3 id="go-语言中如何表示枚举值-enums" tabindex="-1"><a class="header-anchor" href="#go-语言中如何表示枚举值-enums" aria-hidden="true">#</a> Go 语言中如何表示枚举值(enums)？</h3><p>在常量中用iota可以表示枚举。iota从0开始。</p><div class="language-go line-numbers-mode" data-ext="go"><pre class="language-go"><code><span class="token keyword">const</span> <span class="token punctuation">(</span>
	B <span class="token operator">=</span> <span class="token number">1</span> <span class="token operator">&lt;&lt;</span> <span class="token punctuation">(</span><span class="token number">10</span> <span class="token operator">*</span> <span class="token boolean">iota</span><span class="token punctuation">)</span>
	KiB 
	MiB
	GiB
	TiB
	PiB
	EiB
<span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="空-struct-的用途" tabindex="-1"><a class="header-anchor" href="#空-struct-的用途" aria-hidden="true">#</a> 空 struct{} 的用途</h3><ol><li>用map模拟一个set，那么就要把值置为struct{}，struct{}本身不占任何空间，可以避免任何多余的内存分配。</li><li>有时候给通道发送一个空结构体,channel&lt;-struct{}{}，也是节省了空间。</li><li>仅有方法的结构体</li></ol><h3 id="go里面的int和int32是同一个概念吗" tabindex="-1"><a class="header-anchor" href="#go里面的int和int32是同一个概念吗" aria-hidden="true">#</a> go里面的int和int32是同一个概念吗？</h3><p>不是一个概念！千万不能混淆。go语言中的int的大小是和操作系统位数相关的，如果是32位操作系统，int类型的大小就是4字节。如果是64位操作系统，int类型的大小就是8个字节。除此之外uint也与操作系统有关。</p><p>int8占1个字节，int16占2个字节，int32占4个字节，int64占8个字节。</p><h2 id="java过渡go的第一个项目-todolist" tabindex="-1"><a class="header-anchor" href="#java过渡go的第一个项目-todolist" aria-hidden="true">#</a> Java过渡Go的第一个项目：TodoList</h2><p>这个章节主要是学习Gin的项目架构搭建，如果以后要搭建web项目直接起一个脚手架项目很快就能搭建起来，如果项目架构都不熟悉，那么怎么使用脚手架呢？</p><h3 id="前言-1" tabindex="-1"><a class="header-anchor" href="#前言-1" aria-hidden="true">#</a> 前言</h3><p>感谢以下仓库对我学习的帮助：</p><ul><li><a href="https://github.com/swaggo/swag" target="_blank" rel="noopener noreferrer">Automatically generate RESTful API documentation with Swagger 2.0 for Go. <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li><li><a href="https://github.com/CocaineCong/TodoList" target="_blank" rel="noopener noreferrer">Gin+Gorm+Redis+Swagger 基于 RESTful API 规范搭建备忘录<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li><li><a href="https://github.com/gourouting/singo" target="_blank" rel="noopener noreferrer">Gin+Gorm开发Golang API快速开发脚手架 <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li></ul><blockquote><p>注：备忘录的架构是在Singo的基础上搭建的。</p></blockquote><h3 id="搭建外设" tabindex="-1"><a class="header-anchor" href="#搭建外设" aria-hidden="true">#</a> 搭建外设</h3><p>首先搭建脚手架，按照Singo的结构先学习Golang在Gin上的基本架构：</p><figure><img src="/java-tips/assets/image-20220609131536632-e704c9a9.webp" alt="image-20220609131536632" tabindex="0" loading="lazy"><figcaption>image-20220609131536632</figcaption></figure><p>把文件搭建起来后可以开始先给<code>main.go</code>，可以看到TodoList仓库中主要分三步走：</p><div class="language-go line-numbers-mode" data-ext="go"><pre class="language-go"><code><span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// http://localhost:3000/swagger/index.html</span>
	<span class="token comment">//从配置文件读入配置</span>
	conf<span class="token punctuation">.</span><span class="token function">Init</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token comment">//转载路由 swag init -g common.go</span>
	r <span class="token operator">:=</span> routes<span class="token punctuation">.</span><span class="token function">NewRouter</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token boolean">_</span> <span class="token operator">=</span> r<span class="token punctuation">.</span><span class="token function">Run</span><span class="token punctuation">(</span>conf<span class="token punctuation">.</span>HttpPort<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>那么首先把init先写上，说明我们第一步要做的就是初始化配置（本次教程放弃了读取ini，改用yaml文件）：</p><ol><li>创建YAML配置文件（放弃redis，根本用不到）</li></ol><div class="language-yaml line-numbers-mode" data-ext="yml"><pre class="language-yaml"><code><span class="token key atrule">service</span><span class="token punctuation">:</span>
  <span class="token key atrule">mode</span><span class="token punctuation">:</span> debug
  <span class="token key atrule">port</span><span class="token punctuation">:</span> <span class="token punctuation">:</span><span class="token number">8080</span>

<span class="token comment">#redis:</span>
<span class="token comment">#  addr: 127.0.0.1:6379</span>

<span class="token key atrule">mysql</span><span class="token punctuation">:</span>
  <span class="token key atrule">host</span><span class="token punctuation">:</span> 用户名<span class="token punctuation">:</span>密码@tcp(地址<span class="token punctuation">:</span>端口号)/数据库<span class="token punctuation">?</span>charset=utf8<span class="token important">&amp;parseTime=True&amp;loc=Local</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol start="2"><li>然后再conf文件下创建一个<code>init.go</code>，读取yaml，然后分别丢给数据库（mysql），Gin（service）</li></ol><div class="language-go line-numbers-mode" data-ext="go"><pre class="language-go"><code><span class="token keyword">import</span> <span class="token punctuation">(</span>
	<span class="token string">&quot;TodoList/model&quot;</span>
	<span class="token string">&quot;TodoList/util&quot;</span>
	<span class="token string">&quot;gopkg.in/yaml.v3&quot;</span>
	<span class="token string">&quot;io/ioutil&quot;</span>
<span class="token punctuation">)</span>

<span class="token keyword">type</span> Config <span class="token keyword">struct</span> <span class="token punctuation">{</span>
	Service <span class="token operator">*</span>Service <span class="token string">`yaml:&quot;service&quot;`</span>
	DB      <span class="token operator">*</span>DB      <span class="token string">`yaml:&quot;mysql&quot;`</span>
<span class="token punctuation">}</span>
<span class="token keyword">type</span> Service <span class="token keyword">struct</span> <span class="token punctuation">{</span>
	AppMode  <span class="token builtin">string</span> <span class="token string">`yaml:&quot;mode&quot;`</span>
	HttpPort <span class="token builtin">string</span> <span class="token string">`yaml:&quot;port&quot;`</span>
	<span class="token comment">//RedisAddr string `yaml:&quot;redis.addr&quot;`</span>
<span class="token punctuation">}</span>
<span class="token keyword">type</span> DB <span class="token keyword">struct</span> <span class="token punctuation">{</span>
	DbHost <span class="token builtin">string</span> <span class="token string">`yaml:&quot;host&quot;`</span>
<span class="token punctuation">}</span>

<span class="token keyword">var</span> Port <span class="token builtin">string</span>

<span class="token comment">// Init 初始化配置项</span>
<span class="token keyword">func</span> <span class="token function">Init</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

	<span class="token keyword">var</span> ginProperties Config

	file<span class="token punctuation">,</span> err <span class="token operator">:=</span> ioutil<span class="token punctuation">.</span><span class="token function">ReadFile</span><span class="token punctuation">(</span><span class="token string">&quot;./conf.yaml&quot;</span><span class="token punctuation">)</span>

	<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
		util<span class="token punctuation">.</span><span class="token function">Log</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Error</span><span class="token punctuation">(</span><span class="token string">&quot;配置文件读取错误，请检查文件路径:&quot;</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">if</span> err <span class="token operator">:=</span> <span class="token function">LoadLocales</span><span class="token punctuation">(</span><span class="token string">&quot;conf/locales/zh-cn.yaml&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
		util<span class="token punctuation">.</span><span class="token function">Log</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Error</span><span class="token punctuation">(</span><span class="token string">&quot;i18n配置文件读取错误，请检查文件路径:&quot;</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span> <span class="token comment">//日志内容</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">if</span> err <span class="token operator">=</span> yaml<span class="token punctuation">.</span><span class="token function">Unmarshal</span><span class="token punctuation">(</span>file<span class="token punctuation">,</span> <span class="token operator">&amp;</span>ginProperties<span class="token punctuation">)</span><span class="token punctuation">;</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
		util<span class="token punctuation">.</span><span class="token function">Log</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Error</span><span class="token punctuation">(</span><span class="token string">&quot;YAML文件解析失败&quot;</span><span class="token punctuation">)</span> <span class="token comment">//日志内容</span>
	<span class="token punctuation">}</span>

	model<span class="token punctuation">.</span><span class="token function">Database</span><span class="token punctuation">(</span>ginProperties<span class="token punctuation">.</span>DB<span class="token punctuation">.</span>DbHost<span class="token punctuation">)</span>
	Port <span class="token operator">=</span> ginProperties<span class="token punctuation">.</span>Service<span class="token punctuation">.</span>HttpPort
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol start="3"><li>然后把Singo的日志文件给复制过来，放到util文件夹下（忽略jwt，这是后面才会用到）：</li></ol><figure><img src="data:image/webp;base64,UklGRmAIAABXRUJQVlA4IFQIAADwLwCdASr8AGEAPm0wlUgkIqIhJBErqIANiWNu3V3kvfmX8AxTjwmjDfpeJD/Vepz/w7tPzAfsV6yvn/9Ld/rfYX/a/2AP1V9cD1bf9P6buo5+Ov7x2vf6To6fUftLyo+d/9h3JP3Hlp/gPBv4FagXpz/Sb0qAD8q/m/+x8F79q+yX4K+u/mf+hXfo0A/5l/ff9D9sH0n/zn7KebL83/zP/q/0PwF/rV1ifRm/cotE+7D/3EI4XST3biMf1p4yWPcfa91znrqd/3bhfL5fL5RwQp6331EWrA+CM7ld8oduui5yyWSyWOLhPHaLhw65yegwSxv8TKETz3uXy+Xy+WmcCw8ZoFINJISTYTfJThUlhX0xLwEp6uIrFYrEzYAWUhRvVDv7Sd1qkdz++1xRSLJs4R2gJ/qZvSxo84JBUVxOV0LLwMRvLNHp3dFfESJXYFcx2gPXTvkAmqHmG7f2q4aLQjwxARBE8IO2zjhZ61AND3Eg6nkyi3D+xCYI73oFd0h8s+QSCQREAAD++iG+0z3/HPMa4IG8VZdU4Fcpci5uA5MaeFblqhs/sBpxfjlxfyCh517IkZP8tyUY4LzRDFhKa614q3QTmsXbZ5H/zE06+8uGYl9p+dF8NnhXCmY81X7L8HFI+8ktoGMaL5ovjmHwrNG8t3q8FavWXWQxLGJQJZ+sEaxzjkSrmeiPZnPQdlYj9cha41ajkYNYYElAZpZ3E41nnfC41p6bTQiEjDwUFwU+nptatliF7NmlXxFdUxbVENKNhviCCpEm3LhXI20k39MRGqTyujKYTjgvCUmy3Qyv0XgdhuJYPLhOMhfz8Un2l72F1xHjniL/CRYfw3nNX3iY1btkUyAEgkMWAAEWE3uEP3qMjIug+Id6VYYLxj7so9l9CHUXpralbFFWhgdpQexgC5bfKwOCYcnIM4qNpRl7s795jA4opLRq8ZUORRv79Na+pSqszJxQOysbSFOaw7RxF46+/yIN3XhFgR/Y5y941jxypUfku4NPbx0E+wUxzqQGrg5SASc1+y5jaXGOmkFuC/bUPdwStFHDJP2bMYiZhhgugZhebGbPVwAACOhSHZINjO56LrOjg2JTnd/l1xZxroqDy2pbL3iJNMiX09c7P9xWbnW/dT+WbmR94ECDmFSEDdBLTzH6ajPDL+1cL1aq0z8vVjh5a2xS87ck/B4dzHLRUTSVxFGxGOJ2EDfLgDa94Sxdy8Gu4TX2aqllMRsP4s0vKnA9uspPgtkSojIFVAAAm6TLzLRBq+PZwjDr62Pjh5dG4j29CmKYDQwa40zDrLVnz/KjRXH1ILIGyNAYIwqbbHfFXWMAsDK9rKfXywY9IeuIFkDm1FN2Kq88W0exIDoiE3aGvLQ4s1N5+snj9DLKTek1lEuqHx5x1miBPAtys/dNIlQcMEAFGOvvbrS85KaeAZdg9EKO3aKT5Iu9xEVo4j+L87BhrIQYz+X4kjDvuxsXJMK0ztIV3nBzC4uVs6KHDpcQihaLtg2Kbz5bKrKjYQOvjg3evspR9j6voXxbGvorOznZ7DyP18NExUytUGmKINhzc7S/GeE/9QRNjj2noaHPUljUKHrB5hWIENQ2D+NCoWfuyQ9FeZ7SPJ2n5Pmy4U59xvfnvNf2qcJiI8UByEi2wKlYKJ/HgBqMr/6/rto4ZJS/UdAi/r1ecjrIF+OABMeb7c7dTv/+S/gkn30c9P9Tv1Ef/dEhrX55UcR7dS21AIoBREit4oDqcdPF74l8gIWk62866YbsC6l2o23r+clfcMoXopdT5rv475xWIMUiMn/ScictXbvtHf8e39unBKyQhiFarw1KW1/KdRnCFPGA6viP8zHgJOeaJeQeE8gNfWwb9/5dCe1Oz6uO1zaR6LQ3GvuGAJaM6ld/xWOdArrS7nOCbyjJZnx+cGT3ZDcu55SJyqZDgU4uGc9qOMTvqxLrNdP2rcTZ+OP0zDx7LiROcl4Xy/CSOdfvOV6fX6f2PFbfML/5fOLVYNeGh9++1zkEF/lWW9Zbc2wM5ez6VYAt+bkrpnyEhSSrtp1z91rqBzIL+TnCtECe68FyzyPPyFSKtah4nKRykHUdtpjh7EroWN5NHCQzWs7K61OHB1Z3hvoCmRuZ536J86NgA58Yp7f7DSngPHvCv7SSkdn4atClSnEORtSwScklKmK3frUNAZCf5LFQskN/qHltorVtzLEVa/m0yngtN2OpU0PvyuIfKgRt5hmvlQIq14Xfg08fhAcG4fr/s0G5urLmp2fRm9qFsiuH8xwoLMVtKdVVjjK54g0mLHocshMZbBBb73NvJIwyUnP1UweddU5xVTyRD0jPR9dkWC0QNY4PxCaO3If1DpK/c2Kh+3cmxpS6yvKzzpdeDcjP7k1eUMidw3tfEacXMzLaw9lakVx29CLDrlIqNKbHRCyxAlAbgu8goe/XEqGgsn3cC7GmNGKyaJ+COQNxNTIF/sUdyziH05e/NwpRXo0jg56ldMhUPCh/Nr00WSRKVMJ8Nk7JXhsvlEbZ6ewy2Mbv/v7ER9vKN88Hx+l4rgMQW3Kb0FUPyye4o44gGjKI/y90/P+aI5E3FyetZv4uO7Gy1Cj0oMq43CBLezcNpqbGHV30LrJvZ3QJmdpeP4/qrYctNuumI/cYo4Icj6foinVkuW/IvlbmD2ME7gj/xV6poPS0eDIxNxynCxzzz/M4fSfmdOB88Rcz+1UuxV7vCyZ1lV5hJ++LEKUhcpLFJsCDTLOKonKS9cXK8Qewdknej0emVyQyPcN8MXGAJcqyviXsdhDZSt5ZXxmk66r9uSlmCPPYEZjvkg9SX9C3ilTuBZ40egtacAAAAA==" alt="image-20220609132254221" tabindex="0" loading="lazy"><figcaption>image-20220609132254221</figcaption></figure><ol start="4"><li>还可以复制的有conf下的i18n文件，locales和i18n.go都可以复制到conf文件下：</li></ol><figure><img src="data:image/webp;base64,UklGRhQHAABXRUJQVlA4IAgHAADQKgCdASoMAWIAPm00l0ekIyIhI9gLMIANiWNu4MAAZZgR9nkK98j/yvqA243mA8570RdEj6l37b9V56uf+yyavxT/YO0z/H9Er61P8v0H9N89f8V4F/A3I5uhIAPyr+Td9NqL3pXnJ3t9AD+Tf1r/qeyp/K/+r/HecT6Y9gT+V/1P/rdf79qPZT/bgqcxEr64SgFkBQa4KdMDinbPXRILZSl1kmXrFchNpxILZSmOPDGCAKN5mu9iY8fof89Ot+Yx2UUeskF2IXYhdB0j1JBpGUm0TC55D1Bp8a8uI2tsrcaUQvJciidDEBiAwnBrFvx8spsZWeiVJJvdPmoqLB/U/G1rhhGndWQ3IUOs6Zr1RC++huCUIUPCANF9bJ30DUZJ7RDrPPqeHPCwYJx8843cgbM9flDuLO+jGjLj5lJZjd8hqv9p5kySEBVBrKXdYxcz1vQrIcQtWrVq1atWpuAA/qopEjrisvoh9e3+ElL4pdbA2vVGE9wgmIZiqqtMzgOKiOltccO0UUNnNtfs38S6GYuHf89KD2XkaiDCP7EVOCim0El9ka44ZhD+D6cCYElZCH0GX4Ju/RyVRYfOsBfD6WHwFP09sSL3Gy8rD1MllNCAC879A+Xe7SD+6naZBxfF2wo+W5PpPxiz4ZARZJmMVtDf4L3tKVouBVqf/X35J3M4/aiTiAAAWtu0wYO7G+QLileWdRC+MGKna++ZY8eV5X8DOckqnhDmO4w0AK932iNXlwicECLwE0bGPQijTPi7rQ8nlp3qGmn5Z+R99oEBSPj4Hc/2aSt2YnZd1VWyPqYsk1rhM7XHnrf7r4mFDPL/n+zevRGmp5P5saq9dki+8lqyG3EiGrT2vOJgPjtwUWikNUaD7KZ8U0c/xQfmDCAAAzpZfAWuuv8kVaRPqluanwv+mVqCg6kXjRv+wgTo35gv0ig2OJIYQ6Jszm39tL60FcRdkpGA4Ap6j5ROUyY2YjiWl8nyeC4S+0rIA/KcdQSFv3DD6+8Z3BgWYVEgnwso9mWrdkjj08ixfy4BfBVlHZ4SAfAZJoDKc3+nYV1peK4RB7rVV6fGxhNHq3A8tnN1fH95lQEeN8oP+Z1PeVLPlfMSdZejH/6o6eSjv7LtwxqYUvGjXu8w4qnqnn3OkPfEtAQIByPXkOGkFBDUgCoLbFd4XKSi/C+L2CjJ+AhNi3ytDuDRBnNPb8jJPBfM+gfiauElGylwn8PTq1o66GEypYUhn5hjEAfpsWAL35QzhkVp84G+jJmoXVjmT26fHcBykRRlOBRy1LqxvOSTzeYga3kWXFwAAAcFaxYZVCAi9Te38R3Dq1IfKJl6lNt/mb138N4JwanotJKO49bAuiLp8UoQCQxsaI4FTVn8sY3VwK/J3/dMqF+m7+tsjXcV6z7I2YE97uTarOSEuHXK5HHCfBgwA13Uzf6iXqDXUxcHOFSlx18r3j51WLysnZ4/fD4tVJiIvQjs0zIbt8Tm+0lAG6flKl2XT9G2Lt6wo2VcI9TyaesUpeTR/fsNxSkMoDvDHn5B8khsPAHEMbyWVekJW2aY1ImWEvBjtAj5bHsTIApWJDCOfybfmBlSKSQh8Wq+Bd2z+rP85jPnKwET4T+ASiIUcf+W/auwvnquFxVYhKncKTmt2wvH8JpTfZuHYvBtXLHbRZ5/LtU2egYZ9W5HLIZAFjeSl0N9oh2FosqVNABGfMw6evbG0EUQ8E9sWoW902kPh21fnpSaKTeC28jVEIppYRn5MYuw2GrDhVqXdD+LYVxBF/mPn+FEOxLDM1/IDsg9v/Jk3gnksnVKizGyMdZ+er/Fyw+/quDXLLjF0bpYjYhTRBXWk3KRVpf2UcPJR0V5+0JApQ0vr16s5L8bsMWXtSvEoFYvbPL0uB88w6zE4L5qV/8gnKDrH9UmiiEbHD1NrTQ0V/5CDhxzVzJttT2ND7ldvo9e/cZBKaUnVoQaSGmwXv+hnAr5o78b8U2sWMriGTKgxbdc4YDLOBOGYx0zmCzKz1pABzN67vGr6Rck7Hco+YvhqVbiEim/lTIg/f4jGn61lL+RAcl8vVDPorr6mZJq4Wi3lw2ir3NV3eF+7EVHIXwcpx3MWql5AFVAoebS1goJJFNu75Gl/9sMBNQuk1SJEncbwkmCmaDLQbyvEHOLn2/eI523ctPIVJai+00XicoiUz77mutmvcJH5lMCqgWQ/Hk5SNjDZ5Oqo5PHngs/Du41vp5iBMTuEBylIG3dBIRIX1qMfgjdv11kp6g9uQsU6L/fb2t+wEF2CG11+98xkuZbTJCN1wFdmR7rRdKeP77291nIHaBH+yWwd6FzVHuXYjZnUqEZtZ5XwZJUIzazyvg85WO27e1SIwWPDk37Vn7bjia/JxXyrTyUKAAAAAAAAAA=" alt="image-20220609133024879" tabindex="0" loading="lazy"><figcaption>image-20220609133024879</figcaption></figure><h3 id="建立数据库" tabindex="-1"><a class="header-anchor" href="#建立数据库" aria-hidden="true">#</a> 建立数据库</h3><ol><li>在搭建外设的章节可以顺着思路下来，已经把配置文件的sql连接地址转交给了gorm（model/init.go），这里singo也把连接数据库封装好了，直接拿过来用：</li></ol><div class="language-go line-numbers-mode" data-ext="go"><pre class="language-go"><code><span class="token comment">// DB 数据库链接单例</span>
<span class="token keyword">var</span> DB <span class="token operator">*</span>gorm<span class="token punctuation">.</span>DB

<span class="token comment">// Database 在中间件中初始化mysql链接</span>
<span class="token keyword">func</span> <span class="token function">Database</span><span class="token punctuation">(</span>connString <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

	<span class="token comment">// 初始化GORM日志配置</span>
	newLogger <span class="token operator">:=</span> logger<span class="token punctuation">.</span><span class="token function">New</span><span class="token punctuation">(</span>
		log<span class="token punctuation">.</span><span class="token function">New</span><span class="token punctuation">(</span>os<span class="token punctuation">.</span>Stdout<span class="token punctuation">,</span> <span class="token string">&quot;\r\n&quot;</span><span class="token punctuation">,</span> log<span class="token punctuation">.</span>LstdFlags<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment">// io writer</span>
		logger<span class="token punctuation">.</span>Config<span class="token punctuation">{</span>
			SlowThreshold<span class="token punctuation">:</span>             time<span class="token punctuation">.</span>Second<span class="token punctuation">,</span> <span class="token comment">// Slow SQL threshold</span>
			LogLevel<span class="token punctuation">:</span>                  logger<span class="token punctuation">.</span>Info<span class="token punctuation">,</span> <span class="token comment">// Log level(这里记得根据需求改一下)</span>
			IgnoreRecordNotFoundError<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>        <span class="token comment">// Ignore ErrRecordNotFound error for logger</span>
			Colorful<span class="token punctuation">:</span>                  <span class="token boolean">false</span><span class="token punctuation">,</span>       <span class="token comment">// Disable color</span>
		<span class="token punctuation">}</span><span class="token punctuation">,</span>
	<span class="token punctuation">)</span>

	db<span class="token punctuation">,</span> err <span class="token operator">:=</span> gorm<span class="token punctuation">.</span><span class="token function">Open</span><span class="token punctuation">(</span>mysql<span class="token punctuation">.</span><span class="token function">Open</span><span class="token punctuation">(</span>connString<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>gorm<span class="token punctuation">.</span>Config<span class="token punctuation">{</span>
		Logger<span class="token punctuation">:</span> newLogger<span class="token punctuation">,</span>
	<span class="token punctuation">}</span><span class="token punctuation">)</span>
	<span class="token comment">// Error</span>
	<span class="token keyword">if</span> connString <span class="token operator">==</span> <span class="token string">&quot;&quot;</span> <span class="token operator">||</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
		util<span class="token punctuation">.</span><span class="token function">Log</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Error</span><span class="token punctuation">(</span><span class="token string">&quot;mysql lost: %v&quot;</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span>
		<span class="token function">panic</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
	sqlDB<span class="token punctuation">,</span> err <span class="token operator">:=</span> db<span class="token punctuation">.</span><span class="token function">DB</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
		util<span class="token punctuation">.</span><span class="token function">Log</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Error</span><span class="token punctuation">(</span><span class="token string">&quot;mysql lost: %v&quot;</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span>
		<span class="token function">panic</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span>
	<span class="token punctuation">}</span>

	<span class="token comment">//设置连接池</span>
	<span class="token comment">//空闲</span>
	sqlDB<span class="token punctuation">.</span><span class="token function">SetMaxIdleConns</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span>
	<span class="token comment">//打开</span>
	sqlDB<span class="token punctuation">.</span><span class="token function">SetMaxOpenConns</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span>
	DB <span class="token operator">=</span> db

	<span class="token function">migration</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol start="2"><li>但是此时的运行不起来的，要完成migration，这属于GORM的范畴了，具体学习可以到：<a href="https://gorm.io/zh_CN/docs/migration.html" target="_blank" rel="noopener noreferrer">https://gorm.io/zh_CN/docs/migration.html<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li></ol><blockquote><p>这边目前只起搭建项目目的，所以只建了一个user，后续的顺序是：创建一个user.go -》 migration.go 运行</p></blockquote><p>user.go</p><div class="language-go line-numbers-mode" data-ext="go"><pre class="language-go"><code><span class="token keyword">type</span> User <span class="token keyword">struct</span> <span class="token punctuation">{</span>
	gorm<span class="token punctuation">.</span>Model
	UserName       <span class="token builtin">string</span> <span class="token string">`gorm:&quot;unique&quot;`</span>
	PasswordDigest <span class="token builtin">string</span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> <span class="token punctuation">(</span>
	<span class="token comment">// PassWordCost 密码加密难度</span>
	PassWordCost <span class="token operator">=</span> <span class="token number">12</span>
<span class="token punctuation">)</span>

<span class="token keyword">func</span> <span class="token punctuation">(</span>user <span class="token operator">*</span>User<span class="token punctuation">)</span> <span class="token function">SetPassword</span><span class="token punctuation">(</span>password <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token builtin">error</span> <span class="token punctuation">{</span>
	bytes<span class="token punctuation">,</span> err <span class="token operator">:=</span> bcrypt<span class="token punctuation">.</span><span class="token function">GenerateFromPassword</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token function">byte</span><span class="token punctuation">(</span>password<span class="token punctuation">)</span><span class="token punctuation">,</span> PassWordCost<span class="token punctuation">)</span>
	<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
		<span class="token keyword">return</span> err
	<span class="token punctuation">}</span>
	user<span class="token punctuation">.</span>PasswordDigest <span class="token operator">=</span> <span class="token function">string</span><span class="token punctuation">(</span>bytes<span class="token punctuation">)</span>
	<span class="token keyword">return</span> <span class="token boolean">nil</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token punctuation">(</span>user <span class="token operator">*</span>User<span class="token punctuation">)</span> <span class="token function">CheckPassword</span><span class="token punctuation">(</span>password <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token builtin">bool</span> <span class="token punctuation">{</span>
	err <span class="token operator">:=</span> bcrypt<span class="token punctuation">.</span><span class="token function">CompareHashAndPassword</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token function">byte</span><span class="token punctuation">(</span>user<span class="token punctuation">.</span>PasswordDigest<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token function">byte</span><span class="token punctuation">(</span>password<span class="token punctuation">)</span><span class="token punctuation">)</span>
	<span class="token keyword">return</span> err <span class="token operator">==</span> <span class="token boolean">nil</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>migration.go</p><div class="language-go line-numbers-mode" data-ext="go"><pre class="language-go"><code><span class="token comment">//执行数据迁移</span>
<span class="token keyword">func</span> <span class="token function">migration</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token comment">// 自动迁移模式</span>
	<span class="token boolean">_</span> <span class="token operator">=</span> DB<span class="token punctuation">.</span><span class="token function">AutoMigrate</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>User<span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>此时运行main函数就可以看到底层数据库已经创建了user的数据表</p><figure><img src="data:image/webp;base64,UklGRt4FAABXRUJQVlA4INIFAADwIQCdASr8AEcAPm02l0gkIyIhJNapaIANiWVu3Tu7ugeAwA7UXlX0nehf/b7oDnivQB0PPqM8+97IP+lwSX+gdsv9a6BD0d7SZNT8F5Mf2zwVlBNdf874Hv9D9r3o24N9ZM8H9gD+Jfzn/n+kp/tf4zzy/RX/Q9wr+R/0r/lesh6+/2d9ib9YR1lLeSZ5SLDGnU3I2rKhmZU7/mVEg0Gzqb45wyE7mzeASAGh/6HhcBncHP998y0z5kCguTvKxvIx2VHJSVTsRTlVDqY/x4Mma6kNWSdSKMiSYVRvl/vFpPWb4JhnbI62u1sOQhvX8dP3VvtotO7ewn9VeoDMj0fCmavo8sqEAyawNvx74VWyPzGT1m/qry0AAP75TEUvofbpPKyTUVOpzTanBGYJ0H4NPHdoZCb3skSs/b9BXuwSXodfSecSRmWYH6IPxUfNqDau27P/+ujlickAShR///8olwmhzO/LqPPa9qBeNANRyE7oqDCR1Kb8ixaoOD7gvxArI1fEm1roOmV4x0h7zE3ouqmyEzB+iCs4Wp7STUnKpur6qLusgiBnZaD1eHp1zrSL4bjVlj9nWtF8Cc4vfJeKCOzibHDduVmrFMOGk3tUwRHLs1TyWhxU4sKK9u49VLD3SADQv0FUT+nJsz4zOxBthUo/bdC9jIfyRzBFwGrttX7793f1sBx4V2bYhu2vaFQORoh+6Ni9mo6Vrij6Sf2pgzwpi6xRuXR+W6MS0apy4Hkj/qxVMhwF+wVaGxllvz33tSbxJ4qev3Opt2t6x5OVpUjABqnpLStYup68ZtfD+0E6O8P1baInCtXbFRJaYo4CdM+Cx+5BG8/Vk2PcwNOfXwq3tEnm0X2rUlf23ck/APZH3up3tHQjNsrAOXpp4Pt8GNy3ZEkzXQsgN4y0ZAbi0A5MMEBsgEqcIagI4YjXxtwTsVhl/rnTAL+dCyfJ6vV5AaRtmQTGlvnFe961BJ02dEERSc7nYtoicngMEn0qxFvue2gevgv+Jo0PnAkmyAB+spA6QY6ztKid7NJr8wy06ZV2xar+mEW/p2HUQ9tOF3gcJuX0bQTPOJ7HG6q+8utcDZ/NpC+ztTsUjvlAbjljsWjtjI/A6/a3eDyE4t9nwP36zQNfSdz9M1cFmLtMRuj2Z2bm6jBCR4mC3wE/+6gHAn0ddS+jMGcXFlsq4OU6rAoeP7oO7OqN8hhIY0gk1AOBkJlOL8Trsge3FizuPHNrhV+OolVSN+7AaM/Mt+ZVTXHtSITQnHel3M9b1P1ulAZc45OJO2qFE4F+vrlhPiDbXE9NZRGpkxxVnyrvs/lwPp1Un3PkzeaIfLtzlxMuehXHa9ooSn7VRt8eJbp+xniSCMPkCnfaYNdxeYA830TjlzCPz7frfaPfNf+jSNCwQV+ektsrOTl6qbi/+FJBRgsODRp41SikOYrVy9xokMtUacnu6Lt6o1n9seoHoUzWgPoyi3vWMMgYAfxaPhTPWdVFbtEnTSOm1IXvLayeZPwbk9AS/++j0xZNNvB19j0OvJqoRwuwXjbf941CMksOrzJBw89Q3BWw1MYbI2RPo5IHJxFdJvmgK8lOXxzwxa3dwb3qa2GFCpANGq4y1HdUIzUHyALlJykWScFKXtjbtTEkzhQ4t7QUxF8djHzF/IKstLpYrp3tS/pw72DbVQjZ+0IqHsgzFVAWJuDSqX1eP1DYQbK+5kcJgg3IU8NeTg8XLj6u6R7uXC8z2ohL9Ou/WsB+EBV/lo9XulHshKJ8t3mVUbR3P4GfH33ahVrRIeIeC6LknNIRCOuyxNOkzFiXLJm8QJuBWc0PAzLxbF7RS74Jltm9fDCKoZy2duo+BBRzM4cl2k+NSR7oumtf5YrCUdXHqA36BSsphAk9CiU4z///O60F9sSf6x88Lx8NbRHdkC14+6VdZx2tg/T/8g0efgcQcDYYv86rh7YiU8S+4tsyD2jifUxxFRUBoMrSTKr4AAAAAA==" alt="image-20220609133451231" tabindex="0" loading="lazy"><figcaption>image-20220609133451231</figcaption></figure><p>此时的<code>user.go</code>也就是Java中的<code>DO</code>对象</p><h3 id="搭建vo对象" tabindex="-1"><a class="header-anchor" href="#搭建vo对象" aria-hidden="true">#</a> 搭建VO对象</h3><p>这时我们只要创建两个文件即可：</p><ul><li>common.go 专门返回给前端的response二次封装</li><li>user.go 这里是返回给前端哪些需要的用户数据</li></ul><p>common.go，直接复制脚手架的文件，然后再加点自己的状态码，返回类型就有以下内容：</p><p>下面的内容主要都是包含状态码和返回内容（Java中对json的二次封装，比如返回要返回状态码200还是500，返回什么内容）</p><div class="language-go line-numbers-mode" data-ext="go"><pre class="language-go"><code><span class="token comment">// Response 基础序列化器</span>
<span class="token keyword">type</span> Response <span class="token keyword">struct</span> <span class="token punctuation">{</span>
	Code  <span class="token builtin">int</span>         <span class="token string">`json:&quot;code&quot;`</span>
	Data  <span class="token keyword">interface</span><span class="token punctuation">{</span><span class="token punctuation">}</span> <span class="token string">`json:&quot;data,omitempty&quot;`</span>
	Msg   <span class="token builtin">string</span>      <span class="token string">`json:&quot;msg&quot;`</span>
	Error <span class="token builtin">string</span>      <span class="token string">`json:&quot;error,omitempty&quot;`</span>
<span class="token punctuation">}</span>

<span class="token comment">// TrackedErrorResponse 有追踪信息的错误响应</span>
<span class="token keyword">type</span> TrackedErrorResponse <span class="token keyword">struct</span> <span class="token punctuation">{</span>
	Response
	TrackID <span class="token builtin">string</span> <span class="token string">`json:&quot;track_id&quot;`</span>
<span class="token punctuation">}</span>

<span class="token comment">//TokenData 带有token的Data结构</span>
<span class="token keyword">type</span> TokenData <span class="token keyword">struct</span> <span class="token punctuation">{</span>
	User  <span class="token keyword">interface</span><span class="token punctuation">{</span><span class="token punctuation">}</span> <span class="token string">`json:&quot;user&quot;`</span>
	Token <span class="token builtin">string</span>      <span class="token string">`json:&quot;token&quot;`</span>
<span class="token punctuation">}</span>

<span class="token keyword">type</span> ResponseUser <span class="token keyword">struct</span> <span class="token punctuation">{</span>
	Status <span class="token builtin">int</span>    <span class="token string">`json:&quot;status&quot; example:&quot;200&quot;`</span>
	Data   User   <span class="token string">`json:&quot;data&quot;`</span>
	Msg    <span class="token builtin">string</span> <span class="token string">`json:&quot;msg&quot; example:&quot;ok&quot;`</span>
	Error  <span class="token builtin">string</span> <span class="token string">`json:&quot;error&quot; example:&quot;&quot;`</span>
<span class="token punctuation">}</span>

<span class="token comment">// 三位数错误编码为复用http原本含义</span>
<span class="token comment">// 五位数错误编码为应用自定义错误</span>
<span class="token comment">// 五开头的五位数错误编码为服务器端错误，比如数据库操作失败</span>
<span class="token comment">// 四开头的五位数错误编码为客户端错误，有时候是客户端代码写错了，有时候是用户操作错误</span>
<span class="token keyword">const</span> <span class="token punctuation">(</span>
	<span class="token comment">// CodeCheckLogin 未登录</span>
	CodeCheckLogin <span class="token operator">=</span> <span class="token number">401</span>
	<span class="token comment">// CodeNoRightErr 未授权访问</span>
	CodeNoRightErr <span class="token operator">=</span> <span class="token number">403</span>
	<span class="token comment">// CodeDBError 数据库操作失败</span>
	CodeDBError <span class="token operator">=</span> <span class="token number">50001</span>
	<span class="token comment">// CodeEncryptError 加密失败</span>
	CodeEncryptError <span class="token operator">=</span> <span class="token number">50002</span>
	<span class="token comment">//CodeParamErr 各种奇奇怪怪的参数错误</span>
	CodeParamErr               <span class="token operator">=</span> <span class="token number">40001</span>
	ErrorExistUser             <span class="token operator">=</span> <span class="token number">10002</span> <span class="token comment">//成员错误</span>
	ErrorNotExistUser          <span class="token operator">=</span> <span class="token number">10003</span>
	ErrorFailEncryption        <span class="token operator">=</span> <span class="token number">10006</span>
	ErrorNotCompare            <span class="token operator">=</span> <span class="token number">10007</span>
	ErrorAuthCheckTokenFail    <span class="token operator">=</span> <span class="token number">30001</span> <span class="token comment">//token 错误</span>
	ErrorAuthCheckTokenTimeout <span class="token operator">=</span> <span class="token number">30002</span> <span class="token comment">//token 过期</span>
	ErrorAuthToken             <span class="token operator">=</span> <span class="token number">30003</span>
	ErrorAuth                  <span class="token operator">=</span> <span class="token number">30004</span>
	ErrorDatabase              <span class="token operator">=</span> <span class="token number">40001</span>
<span class="token punctuation">)</span>

<span class="token comment">// CheckLogin 检查登录</span>
<span class="token keyword">func</span> <span class="token function">CheckLogin</span><span class="token punctuation">(</span><span class="token punctuation">)</span> Response <span class="token punctuation">{</span>
	<span class="token keyword">return</span> Response<span class="token punctuation">{</span>
		Code<span class="token punctuation">:</span> CodeCheckLogin<span class="token punctuation">,</span>
		Msg<span class="token punctuation">:</span>  <span class="token string">&quot;未登录&quot;</span><span class="token punctuation">,</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">// Err 通用错误处理</span>
<span class="token keyword">func</span> <span class="token function">Err</span><span class="token punctuation">(</span>errCode <span class="token builtin">int</span><span class="token punctuation">,</span> msg <span class="token builtin">string</span><span class="token punctuation">,</span> err <span class="token builtin">error</span><span class="token punctuation">)</span> Response <span class="token punctuation">{</span>
	res <span class="token operator">:=</span> Response<span class="token punctuation">{</span>
		Code<span class="token punctuation">:</span> errCode<span class="token punctuation">,</span>
		Msg<span class="token punctuation">:</span>  msg<span class="token punctuation">,</span>
	<span class="token punctuation">}</span>
	<span class="token comment">// 生产环境隐藏底层报错</span>
	<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token operator">&amp;&amp;</span> gin<span class="token punctuation">.</span><span class="token function">Mode</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">!=</span> gin<span class="token punctuation">.</span>ReleaseMode <span class="token punctuation">{</span>
		res<span class="token punctuation">.</span>Error <span class="token operator">=</span> err<span class="token punctuation">.</span><span class="token function">Error</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">return</span> res
<span class="token punctuation">}</span>

<span class="token comment">// DBErr 数据库操作失败</span>
<span class="token keyword">func</span> <span class="token function">DBErr</span><span class="token punctuation">(</span>msg <span class="token builtin">string</span><span class="token punctuation">,</span> err <span class="token builtin">error</span><span class="token punctuation">)</span> Response <span class="token punctuation">{</span>
	<span class="token keyword">if</span> msg <span class="token operator">==</span> <span class="token string">&quot;&quot;</span> <span class="token punctuation">{</span>
		msg <span class="token operator">=</span> <span class="token string">&quot;数据库操作失败&quot;</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">return</span> <span class="token function">Err</span><span class="token punctuation">(</span>CodeDBError<span class="token punctuation">,</span> msg<span class="token punctuation">,</span> err<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token comment">// ParamErr 各种参数错误</span>
<span class="token keyword">func</span> <span class="token function">ParamErr</span><span class="token punctuation">(</span>msg <span class="token builtin">string</span><span class="token punctuation">,</span> err <span class="token builtin">error</span><span class="token punctuation">)</span> Response <span class="token punctuation">{</span>
	<span class="token keyword">if</span> msg <span class="token operator">==</span> <span class="token string">&quot;&quot;</span> <span class="token punctuation">{</span>
		msg <span class="token operator">=</span> <span class="token string">&quot;参数错误&quot;</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">return</span> <span class="token function">Err</span><span class="token punctuation">(</span>CodeParamErr<span class="token punctuation">,</span> msg<span class="token punctuation">,</span> err<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>user.go</p><p>主要是封装返回给前端的字段，一开始看也很懵，为什么这个字段感觉和model里的User一样还要写一遍？而且下面的BuildUser是个什么鬼？</p><ul><li>这里解答：BuildUser是在等下的service层会用到，是用来给jwt的</li></ul><div class="language-go line-numbers-mode" data-ext="go"><pre class="language-go"><code><span class="token keyword">type</span> User <span class="token keyword">struct</span> <span class="token punctuation">{</span>
	ID       <span class="token builtin">uint</span>   <span class="token string">`json:&quot;id&quot; form:&quot;id&quot; example:&quot;1&quot;`</span>                    <span class="token comment">// 用户ID</span>
	UserName <span class="token builtin">string</span> <span class="token string">`json:&quot;user_name&quot; form:&quot;user_name&quot; example:&quot;FanOne&quot;`</span> <span class="token comment">// 用户名</span>
	CreateAt <span class="token builtin">int64</span>  <span class="token string">`json:&quot;create_at&quot; form:&quot;create_at&quot;`</span>                  <span class="token comment">// 创建</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">BuildUser</span><span class="token punctuation">(</span>user model<span class="token punctuation">.</span>User<span class="token punctuation">)</span> User <span class="token punctuation">{</span>
	<span class="token keyword">return</span> User<span class="token punctuation">{</span>
		ID<span class="token punctuation">:</span>       user<span class="token punctuation">.</span>ID<span class="token punctuation">,</span>
		UserName<span class="token punctuation">:</span> user<span class="token punctuation">.</span>UserName<span class="token punctuation">,</span>
		CreateAt<span class="token punctuation">:</span> user<span class="token punctuation">.</span>CreatedAt<span class="token punctuation">.</span><span class="token function">Unix</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="搭建service层" tabindex="-1"><a class="header-anchor" href="#搭建service层" aria-hidden="true">#</a> 搭建Service层</h3><p>有了上述的基础，就可以搭建service层了，在TodoList项目中的日志框架用了第三方的框架，本次教程则采用原生在util文件下封装的框架作为日志框架。</p><p>下面的这段代码实在理解不了可以直接照着抄一下：</p><div class="language-go line-numbers-mode" data-ext="go"><pre class="language-go"><code><span class="token keyword">type</span> UserService <span class="token keyword">struct</span> <span class="token punctuation">{</span>
	UserName <span class="token builtin">string</span> <span class="token string">`form:&quot;user_name&quot; json:&quot;user_name&quot; binding:&quot;required,min=3,max=15&quot; example:&quot;FanOne&quot;`</span>
	Password <span class="token builtin">string</span> <span class="token string">`form:&quot;password&quot; json:&quot;password&quot; binding:&quot;required,min=5,max=16&quot; example:&quot;FanOne666&quot;`</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token punctuation">(</span>service <span class="token operator">*</span>UserService<span class="token punctuation">)</span> <span class="token function">Register</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">*</span>serializer<span class="token punctuation">.</span>Response <span class="token punctuation">{</span>
	<span class="token keyword">var</span> user model<span class="token punctuation">.</span>User
	<span class="token keyword">var</span> count <span class="token builtin">int64</span>
	model<span class="token punctuation">.</span>DB<span class="token punctuation">.</span><span class="token function">Model</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>model<span class="token punctuation">.</span>User<span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Where</span><span class="token punctuation">(</span><span class="token string">&quot;user_name=?&quot;</span><span class="token punctuation">,</span> service<span class="token punctuation">.</span>UserName<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">First</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>user<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Count</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>count<span class="token punctuation">)</span>
	<span class="token keyword">if</span> count <span class="token operator">==</span> <span class="token number">1</span> <span class="token punctuation">{</span>
		code <span class="token operator">:=</span> serializer<span class="token punctuation">.</span>ErrorExistUser
		<span class="token keyword">return</span> <span class="token operator">&amp;</span>serializer<span class="token punctuation">.</span>Response<span class="token punctuation">{</span>
			Code<span class="token punctuation">:</span> code<span class="token punctuation">,</span>
			Msg<span class="token punctuation">:</span>  <span class="token string">&quot;成员错误&quot;</span><span class="token punctuation">,</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
	user<span class="token punctuation">.</span>UserName <span class="token operator">=</span> service<span class="token punctuation">.</span>UserName
	<span class="token comment">//加密密码</span>
	<span class="token keyword">if</span> err <span class="token operator">:=</span> user<span class="token punctuation">.</span><span class="token function">SetPassword</span><span class="token punctuation">(</span>service<span class="token punctuation">.</span>Password<span class="token punctuation">)</span><span class="token punctuation">;</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
		util<span class="token punctuation">.</span><span class="token function">Log</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Error</span><span class="token punctuation">(</span>err<span class="token punctuation">.</span><span class="token function">Error</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
		code <span class="token operator">:=</span> serializer<span class="token punctuation">.</span>ErrorFailEncryption
		<span class="token keyword">return</span> <span class="token operator">&amp;</span>serializer<span class="token punctuation">.</span>Response<span class="token punctuation">{</span>
			Code<span class="token punctuation">:</span> code<span class="token punctuation">,</span>
			Msg<span class="token punctuation">:</span>  <span class="token string">&quot;加密失败&quot;</span><span class="token punctuation">,</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
	<span class="token comment">//创建用户</span>
	<span class="token keyword">if</span> err <span class="token operator">:=</span> model<span class="token punctuation">.</span>DB<span class="token punctuation">.</span><span class="token function">Create</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>user<span class="token punctuation">)</span><span class="token punctuation">.</span>Error<span class="token punctuation">;</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
		util<span class="token punctuation">.</span><span class="token function">Log</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Error</span><span class="token punctuation">(</span>err<span class="token punctuation">.</span><span class="token function">Error</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
		code <span class="token operator">:=</span> serializer<span class="token punctuation">.</span>ErrorDatabase
		<span class="token keyword">return</span> <span class="token operator">&amp;</span>serializer<span class="token punctuation">.</span>Response<span class="token punctuation">{</span>
			Code<span class="token punctuation">:</span> code<span class="token punctuation">,</span>
			Msg<span class="token punctuation">:</span>  <span class="token string">&quot;创建用户失败&quot;</span><span class="token punctuation">,</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">return</span> <span class="token operator">&amp;</span>serializer<span class="token punctuation">.</span>Response<span class="token punctuation">{</span>
		Code<span class="token punctuation">:</span> http<span class="token punctuation">.</span>StatusOK<span class="token punctuation">,</span>
		Msg<span class="token punctuation">:</span>  <span class="token string">&quot;成功创建&quot;</span><span class="token punctuation">,</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token punctuation">(</span>service <span class="token operator">*</span>UserService<span class="token punctuation">)</span> <span class="token function">Login</span><span class="token punctuation">(</span><span class="token punctuation">)</span> serializer<span class="token punctuation">.</span>Response <span class="token punctuation">{</span>
	<span class="token keyword">var</span> user model<span class="token punctuation">.</span>User
	code <span class="token operator">:=</span> http<span class="token punctuation">.</span>StatusOK

	<span class="token keyword">if</span> err <span class="token operator">:=</span> model<span class="token punctuation">.</span>DB<span class="token punctuation">.</span><span class="token function">Where</span><span class="token punctuation">(</span><span class="token string">&quot;user_name=?&quot;</span><span class="token punctuation">,</span> service<span class="token punctuation">.</span>UserName<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">First</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>user<span class="token punctuation">)</span><span class="token punctuation">.</span>Error<span class="token punctuation">;</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
		<span class="token comment">// 查询不到，返回错误</span>
		<span class="token keyword">if</span> errors<span class="token punctuation">.</span><span class="token function">Is</span><span class="token punctuation">(</span>err<span class="token punctuation">,</span> gorm<span class="token punctuation">.</span>ErrRecordNotFound<span class="token punctuation">)</span> <span class="token punctuation">{</span>
			util<span class="token punctuation">.</span><span class="token function">Log</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Error</span><span class="token punctuation">(</span>err<span class="token punctuation">.</span><span class="token function">Error</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
			code <span class="token operator">=</span> serializer<span class="token punctuation">.</span>ErrorExistUser
			<span class="token keyword">return</span> serializer<span class="token punctuation">.</span>Response<span class="token punctuation">{</span>
				Code<span class="token punctuation">:</span> code<span class="token punctuation">,</span>
				Msg<span class="token punctuation">:</span>  <span class="token string">&quot;用户不存在！&quot;</span><span class="token punctuation">,</span>
			<span class="token punctuation">}</span>
		<span class="token punctuation">}</span>
		util<span class="token punctuation">.</span><span class="token function">Log</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Info</span><span class="token punctuation">(</span>err<span class="token punctuation">.</span><span class="token function">Error</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
		<span class="token keyword">return</span> serializer<span class="token punctuation">.</span><span class="token function">DBErr</span><span class="token punctuation">(</span><span class="token string">&quot;&quot;</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span>
	<span class="token punctuation">}</span>

	<span class="token keyword">if</span> user<span class="token punctuation">.</span><span class="token function">CheckPassword</span><span class="token punctuation">(</span>service<span class="token punctuation">.</span>Password<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token boolean">false</span> <span class="token punctuation">{</span>
		code <span class="token operator">:=</span> serializer<span class="token punctuation">.</span>ErrorNotCompare
		<span class="token keyword">return</span> serializer<span class="token punctuation">.</span>Response<span class="token punctuation">{</span>
			Code<span class="token punctuation">:</span> code<span class="token punctuation">,</span>
			Msg<span class="token punctuation">:</span>  <span class="token string">&quot;密码错误&quot;</span><span class="token punctuation">,</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>

	token<span class="token punctuation">,</span> err <span class="token operator">:=</span> util<span class="token punctuation">.</span><span class="token function">GenerateToken</span><span class="token punctuation">(</span>user<span class="token punctuation">.</span>ID<span class="token punctuation">,</span> service<span class="token punctuation">.</span>UserName<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>
	<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
		util<span class="token punctuation">.</span><span class="token function">Log</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Error</span><span class="token punctuation">(</span>err<span class="token punctuation">.</span><span class="token function">Error</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
		code <span class="token operator">=</span> serializer<span class="token punctuation">.</span>ErrorAuthToken
		<span class="token keyword">return</span> serializer<span class="token punctuation">.</span>Response<span class="token punctuation">{</span>
			Code<span class="token punctuation">:</span> code<span class="token punctuation">,</span>
			Msg<span class="token punctuation">:</span>  <span class="token string">&quot;Token授权失败&quot;</span><span class="token punctuation">,</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>

	<span class="token keyword">return</span> serializer<span class="token punctuation">.</span>Response<span class="token punctuation">{</span>
		Code<span class="token punctuation">:</span> code<span class="token punctuation">,</span>
		Data<span class="token punctuation">:</span> serializer<span class="token punctuation">.</span>TokenData<span class="token punctuation">{</span>User<span class="token punctuation">:</span> serializer<span class="token punctuation">.</span><span class="token function">BuildUser</span><span class="token punctuation">(</span>user<span class="token punctuation">)</span><span class="token punctuation">,</span> Token<span class="token punctuation">:</span> token<span class="token punctuation">}</span><span class="token punctuation">,</span>
		Msg<span class="token punctuation">:</span>  <span class="token string">&quot;登录成功！&quot;</span><span class="token punctuation">,</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>唯一要注意的就是，在登录用户的模块中，需要使用到JWT框架，如下所示：</p><div class="language-go line-numbers-mode" data-ext="go"><pre class="language-go"><code>token<span class="token punctuation">,</span> err <span class="token operator">:=</span> util<span class="token punctuation">.</span><span class="token function">GenerateToken</span><span class="token punctuation">(</span>user<span class="token punctuation">.</span>ID<span class="token punctuation">,</span> service<span class="token punctuation">.</span>UserName<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>
	<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
		util<span class="token punctuation">.</span><span class="token function">Log</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Error</span><span class="token punctuation">(</span>err<span class="token punctuation">.</span><span class="token function">Error</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
		code <span class="token operator">=</span> serializer<span class="token punctuation">.</span>ErrorAuthToken
		<span class="token keyword">return</span> serializer<span class="token punctuation">.</span>Response<span class="token punctuation">{</span>
			Code<span class="token punctuation">:</span> code<span class="token punctuation">,</span>
			Msg<span class="token punctuation">:</span>  <span class="token string">&quot;Token授权失败&quot;</span><span class="token punctuation">,</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>go-jwt好像换维护者了，地址：<a href="https://github.com/golang-jwt/jwt%EF%BC%8C%E7%94%A8%E6%B3%95%E4%B9%9F%E7%A8%8D%E6%9C%89%E4%B8%8D%E5%90%8C%E3%80%82" target="_blank" rel="noopener noreferrer">https://github.com/golang-jwt/jwt，用法也稍有不同。<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><blockquote><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>go get -u github.com/golang-jwt/jwt/v4
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div></blockquote><p>下面这段代码是对TodoList util 中的<code>jwt.go</code>进行一些修改：</p><div class="language-go line-numbers-mode" data-ext="go"><pre class="language-go"><code><span class="token keyword">var</span> jwtSecret <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token function">byte</span><span class="token punctuation">(</span>os<span class="token punctuation">.</span><span class="token function">Getenv</span><span class="token punctuation">(</span><span class="token string">&quot;JWT_SECRET&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token keyword">type</span> Claims <span class="token keyword">struct</span> <span class="token punctuation">{</span>
	Id        <span class="token builtin">uint</span>   <span class="token string">`json:&quot;id&quot;`</span>
	Username  <span class="token builtin">string</span> <span class="token string">`json:&quot;username&quot;`</span>
	Authority <span class="token builtin">int</span>    <span class="token string">`json:&quot;authority&quot;`</span>
	jwt<span class="token punctuation">.</span>RegisteredClaims
<span class="token punctuation">}</span>

<span class="token comment">//GenerateToken 签发用户Token</span>
<span class="token keyword">func</span> <span class="token function">GenerateToken</span><span class="token punctuation">(</span>id <span class="token builtin">uint</span><span class="token punctuation">,</span> username <span class="token builtin">string</span><span class="token punctuation">,</span> authority <span class="token builtin">int</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token builtin">string</span><span class="token punctuation">,</span> <span class="token builtin">error</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	nowTime <span class="token operator">:=</span> time<span class="token punctuation">.</span><span class="token function">Now</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	expireTime <span class="token operator">:=</span> nowTime<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span><span class="token number">24</span> <span class="token operator">*</span> time<span class="token punctuation">.</span>Hour<span class="token punctuation">)</span>
	claims <span class="token operator">:=</span> Claims<span class="token punctuation">{</span>
		Id<span class="token punctuation">:</span>        id<span class="token punctuation">,</span>
		Username<span class="token punctuation">:</span>  username<span class="token punctuation">,</span>
		Authority<span class="token punctuation">:</span> authority<span class="token punctuation">,</span>
		RegisteredClaims<span class="token punctuation">:</span> jwt<span class="token punctuation">.</span>RegisteredClaims<span class="token punctuation">{</span>
			ExpiresAt<span class="token punctuation">:</span> jwt<span class="token punctuation">.</span><span class="token function">NewNumericDate</span><span class="token punctuation">(</span>expireTime<span class="token punctuation">)</span><span class="token punctuation">,</span>
			Issuer<span class="token punctuation">:</span>    <span class="token string">&quot;to-do-list&quot;</span><span class="token punctuation">,</span>
		<span class="token punctuation">}</span><span class="token punctuation">,</span>
	<span class="token punctuation">}</span>
	tokenClaims <span class="token operator">:=</span> jwt<span class="token punctuation">.</span><span class="token function">NewWithClaims</span><span class="token punctuation">(</span>jwt<span class="token punctuation">.</span>SigningMethodHS256<span class="token punctuation">,</span> claims<span class="token punctuation">)</span>
	token<span class="token punctuation">,</span> err <span class="token operator">:=</span> tokenClaims<span class="token punctuation">.</span><span class="token function">SignedString</span><span class="token punctuation">(</span>jwtSecret<span class="token punctuation">)</span>
	<span class="token keyword">return</span> token<span class="token punctuation">,</span> err
<span class="token punctuation">}</span>

<span class="token comment">//ParseToken 验证用户token</span>
<span class="token keyword">func</span> <span class="token function">ParseToken</span><span class="token punctuation">(</span>token <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token operator">*</span>Claims<span class="token punctuation">,</span> <span class="token builtin">error</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	tokenClaims<span class="token punctuation">,</span> err <span class="token operator">:=</span> jwt<span class="token punctuation">.</span><span class="token function">ParseWithClaims</span><span class="token punctuation">(</span>token<span class="token punctuation">,</span> <span class="token operator">&amp;</span>Claims<span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token keyword">func</span><span class="token punctuation">(</span>token <span class="token operator">*</span>jwt<span class="token punctuation">.</span>Token<span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token keyword">interface</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token builtin">error</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">return</span> jwtSecret<span class="token punctuation">,</span> <span class="token boolean">nil</span>
	<span class="token punctuation">}</span><span class="token punctuation">)</span>
	<span class="token keyword">if</span> tokenClaims <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
		<span class="token keyword">if</span> claims<span class="token punctuation">,</span> ok <span class="token operator">:=</span> tokenClaims<span class="token punctuation">.</span>Claims<span class="token punctuation">.</span><span class="token punctuation">(</span><span class="token operator">*</span>Claims<span class="token punctuation">)</span><span class="token punctuation">;</span> ok <span class="token operator">&amp;&amp;</span> tokenClaims<span class="token punctuation">.</span>Valid <span class="token punctuation">{</span>
			<span class="token keyword">return</span> claims<span class="token punctuation">,</span> <span class="token boolean">nil</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">return</span> <span class="token boolean">nil</span><span class="token punctuation">,</span> err
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>封装了之后，在登录用户模块就可以使用JWT了。</p><p>登录模块的最后可以看到：</p><div class="language-go line-numbers-mode" data-ext="go"><pre class="language-go"><code><span class="token keyword">return</span> serializer<span class="token punctuation">.</span>Response<span class="token punctuation">{</span>
		Code<span class="token punctuation">:</span> code<span class="token punctuation">,</span>
		Data<span class="token punctuation">:</span> serializer<span class="token punctuation">.</span>TokenData<span class="token punctuation">{</span>User<span class="token punctuation">:</span> serializer<span class="token punctuation">.</span><span class="token function">BuildUser</span><span class="token punctuation">(</span>user<span class="token punctuation">)</span><span class="token punctuation">,</span> Token<span class="token punctuation">:</span> token<span class="token punctuation">}</span><span class="token punctuation">,</span>
		Msg<span class="token punctuation">:</span>  <span class="token string">&quot;登录成功！&quot;</span><span class="token punctuation">,</span>
	<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>里面就用到：</p><blockquote><p>serializer.BuildUser(user)</p></blockquote><p>这就是刚刚在封装的BuildUser</p><h3 id="controller层" tabindex="-1"><a class="header-anchor" href="#controller层" aria-hidden="true">#</a> Controller层</h3><p>最后，你可以直接复制Todo List项目中的api下的user.go，因为你已经从实体类层一直搭建到这里，肯定知道里面的原理，当然，你也可以直接复制下面我写的代码：</p><div class="language-go line-numbers-mode" data-ext="go"><pre class="language-go"><code><span class="token keyword">var</span> userRegisterService service<span class="token punctuation">.</span>UserService

<span class="token keyword">func</span> <span class="token function">UserRegister</span><span class="token punctuation">(</span>c <span class="token operator">*</span>gin<span class="token punctuation">.</span>Context<span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">if</span> err <span class="token operator">:=</span> c<span class="token punctuation">.</span><span class="token function">ShouldBind</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>userRegisterService<span class="token punctuation">)</span><span class="token punctuation">;</span> err <span class="token operator">==</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
		res <span class="token operator">:=</span> userRegisterService<span class="token punctuation">.</span><span class="token function">Register</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
		c<span class="token punctuation">.</span><span class="token function">JSON</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">,</span> res<span class="token punctuation">)</span>
	<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
		c<span class="token punctuation">.</span><span class="token function">JSON</span><span class="token punctuation">(</span><span class="token number">400</span><span class="token punctuation">,</span> <span class="token function">ErrorResponse</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span><span class="token punctuation">)</span>
		util<span class="token punctuation">.</span><span class="token function">Log</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Error</span><span class="token punctuation">(</span>err<span class="token punctuation">.</span><span class="token function">Error</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">UserLogin</span><span class="token punctuation">(</span>c <span class="token operator">*</span>gin<span class="token punctuation">.</span>Context<span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">var</span> userLoginService service<span class="token punctuation">.</span>UserService
	<span class="token keyword">if</span> err <span class="token operator">:=</span> c<span class="token punctuation">.</span><span class="token function">ShouldBind</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>userLoginService<span class="token punctuation">)</span><span class="token punctuation">;</span> err <span class="token operator">==</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
		res <span class="token operator">:=</span> userLoginService<span class="token punctuation">.</span><span class="token function">Login</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
		c<span class="token punctuation">.</span><span class="token function">JSON</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">,</span> res<span class="token punctuation">)</span>
	<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
		c<span class="token punctuation">.</span><span class="token function">JSON</span><span class="token punctuation">(</span><span class="token number">400</span><span class="token punctuation">,</span> <span class="token function">ErrorResponse</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span><span class="token punctuation">)</span>
		util<span class="token punctuation">.</span><span class="token function">Log</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Error</span><span class="token punctuation">(</span>err<span class="token punctuation">.</span><span class="token function">Error</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><blockquote><p>注：如果你是复制TodoList项目中的代码话，请忽略注释里面的内容，因为那个是swagger必须要写的</p></blockquote><p>同时，api/common还有一个文件是<code>common.go</code>，这个在本次项目中是封装返回错误信息的controller，直接复制也可以</p><div class="language-go line-numbers-mode" data-ext="go"><pre class="language-go"><code><span class="token comment">//返回错误信息 ErrorResponse</span>
<span class="token keyword">func</span> <span class="token function">ErrorResponse</span><span class="token punctuation">(</span>err <span class="token builtin">error</span><span class="token punctuation">)</span> serializer<span class="token punctuation">.</span>Response <span class="token punctuation">{</span>
	<span class="token keyword">if</span> ve<span class="token punctuation">,</span> ok <span class="token operator">:=</span> err<span class="token punctuation">.</span><span class="token punctuation">(</span>validator<span class="token punctuation">.</span>ValidationErrors<span class="token punctuation">)</span><span class="token punctuation">;</span> ok <span class="token punctuation">{</span>
		<span class="token keyword">for</span> <span class="token boolean">_</span><span class="token punctuation">,</span> e <span class="token operator">:=</span> <span class="token keyword">range</span> ve <span class="token punctuation">{</span>
			field <span class="token operator">:=</span> conf<span class="token punctuation">.</span><span class="token function">T</span><span class="token punctuation">(</span>fmt<span class="token punctuation">.</span><span class="token function">Sprintf</span><span class="token punctuation">(</span><span class="token string">&quot;Field.%s&quot;</span><span class="token punctuation">,</span> e<span class="token punctuation">.</span>Field<span class="token punctuation">)</span><span class="token punctuation">)</span>
			tag <span class="token operator">:=</span> conf<span class="token punctuation">.</span><span class="token function">T</span><span class="token punctuation">(</span>fmt<span class="token punctuation">.</span><span class="token function">Sprintf</span><span class="token punctuation">(</span><span class="token string">&quot;Tag.Valid.%s&quot;</span><span class="token punctuation">,</span> e<span class="token punctuation">.</span>Tag<span class="token punctuation">)</span><span class="token punctuation">)</span>
			<span class="token keyword">return</span> serializer<span class="token punctuation">.</span>Response<span class="token punctuation">{</span>
				Code<span class="token punctuation">:</span>  <span class="token number">40001</span><span class="token punctuation">,</span>
				Msg<span class="token punctuation">:</span>   fmt<span class="token punctuation">.</span><span class="token function">Sprintf</span><span class="token punctuation">(</span><span class="token string">&quot;%s%s&quot;</span><span class="token punctuation">,</span> field<span class="token punctuation">,</span> tag<span class="token punctuation">)</span><span class="token punctuation">,</span>
				Error<span class="token punctuation">:</span> fmt<span class="token punctuation">.</span><span class="token function">Sprint</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span><span class="token punctuation">,</span>
			<span class="token punctuation">}</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">if</span> <span class="token boolean">_</span><span class="token punctuation">,</span> ok <span class="token operator">:=</span> err<span class="token punctuation">.</span><span class="token punctuation">(</span><span class="token operator">*</span>json<span class="token punctuation">.</span>UnmarshalTypeError<span class="token punctuation">)</span><span class="token punctuation">;</span> ok <span class="token punctuation">{</span>
		<span class="token keyword">return</span> serializer<span class="token punctuation">.</span>Response<span class="token punctuation">{</span>
			Code<span class="token punctuation">:</span>  <span class="token number">40001</span><span class="token punctuation">,</span>
			Msg<span class="token punctuation">:</span>   <span class="token string">&quot;JSON类型不匹配&quot;</span><span class="token punctuation">,</span>
			Error<span class="token punctuation">:</span> fmt<span class="token punctuation">.</span><span class="token function">Sprint</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span><span class="token punctuation">,</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">return</span> serializer<span class="token punctuation">.</span>Response<span class="token punctuation">{</span>
		Code<span class="token punctuation">:</span>  <span class="token number">40001</span><span class="token punctuation">,</span>
		Msg<span class="token punctuation">:</span>   <span class="token string">&quot;参数错误&quot;</span><span class="token punctuation">,</span>
		Error<span class="token punctuation">:</span> fmt<span class="token punctuation">.</span><span class="token function">Sprint</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span><span class="token punctuation">,</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="搭建路由" tabindex="-1"><a class="header-anchor" href="#搭建路由" aria-hidden="true">#</a> 搭建路由</h3><p>当你搭建完上述的项目，肯定还启动不起来，gin不知道你访问的地址是个什么东西，所以用gin.engine搭建路由：</p><p>这里先把swagger的写上去，等下要用到</p><div class="language-go line-numbers-mode" data-ext="go"><pre class="language-go"><code><span class="token keyword">func</span> <span class="token function">NewRouter</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">*</span>gin<span class="token punctuation">.</span>Engine <span class="token punctuation">{</span>
	r <span class="token operator">:=</span> gin<span class="token punctuation">.</span><span class="token function">Default</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	r<span class="token punctuation">.</span><span class="token function">GET</span><span class="token punctuation">(</span><span class="token string">&quot;/swagger/*any&quot;</span><span class="token punctuation">,</span> ginSwagger<span class="token punctuation">.</span><span class="token function">WrapHandler</span><span class="token punctuation">(</span>swaggerFiles<span class="token punctuation">.</span>Handler<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// 开启swag</span>

	<span class="token comment">// 路由</span>
	v1 <span class="token operator">:=</span> r<span class="token punctuation">.</span><span class="token function">Group</span><span class="token punctuation">(</span><span class="token string">&quot;/api/v1&quot;</span><span class="token punctuation">)</span>
	<span class="token punctuation">{</span>
		v1<span class="token punctuation">.</span><span class="token function">GET</span><span class="token punctuation">(</span><span class="token string">&quot;ping&quot;</span><span class="token punctuation">,</span> <span class="token keyword">func</span><span class="token punctuation">(</span>c <span class="token operator">*</span>gin<span class="token punctuation">.</span>Context<span class="token punctuation">)</span> <span class="token punctuation">{</span>
			c<span class="token punctuation">.</span><span class="token function">JSON</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">,</span> <span class="token string">&quot;success&quot;</span><span class="token punctuation">)</span>
		<span class="token punctuation">}</span><span class="token punctuation">)</span>
		<span class="token comment">// 用户操作</span>
		v1<span class="token punctuation">.</span><span class="token function">POST</span><span class="token punctuation">(</span><span class="token string">&quot;user/register&quot;</span><span class="token punctuation">,</span> api<span class="token punctuation">.</span>UserRegister<span class="token punctuation">)</span>
		v1<span class="token punctuation">.</span><span class="token function">POST</span><span class="token punctuation">(</span><span class="token string">&quot;user/login&quot;</span><span class="token punctuation">,</span> api<span class="token punctuation">.</span>UserLogin<span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">return</span> r
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="临时测试" tabindex="-1"><a class="header-anchor" href="#临时测试" aria-hidden="true">#</a> 临时测试</h3><p>当搭建好路由以后，就可以在main函数上告诉gin你的url，你就可以访问到地址了</p><div class="language-go line-numbers-mode" data-ext="go"><pre class="language-go"><code><span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	conf<span class="token punctuation">.</span><span class="token function">Init</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	r <span class="token operator">:=</span> routes<span class="token punctuation">.</span><span class="token function">NewRouter</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token boolean">_</span> <span class="token operator">=</span> r<span class="token punctuation">.</span><span class="token function">Run</span><span class="token punctuation">(</span>conf<span class="token punctuation">.</span>Port<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="搭建swagger进行测试" tabindex="-1"><a class="header-anchor" href="#搭建swagger进行测试" aria-hidden="true">#</a> 搭建swagger进行测试</h3><p>完全可以按照：<a href="https://github.com/swaggo/swag/blob/master/README_zh-CN.md%EF%BC%8C%E8%BF%9B%E8%A1%8C%E6%93%8D%E4%BD%9C%E3%80%82" target="_blank" rel="noopener noreferrer">https://github.com/swaggo/swag/blob/master/README_zh-CN.md，进行操作。<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><p>当然有几个坑要注意：</p><ol><li>在main函数中你可能会写到：</li></ol><div class="language-go line-numbers-mode" data-ext="go"><pre class="language-go"><code><span class="token comment">// programatically set swagger info</span>
docs<span class="token punctuation">.</span>SwaggerInfo<span class="token punctuation">.</span>Title <span class="token operator">=</span> <span class="token string">&quot;Todo List&quot;</span>
docs<span class="token punctuation">.</span>SwaggerInfo<span class="token punctuation">.</span>Description <span class="token operator">=</span> <span class="token string">&quot;This is a simple ToDoList App.&quot;</span>
docs<span class="token punctuation">.</span>SwaggerInfo<span class="token punctuation">.</span>Version <span class="token operator">=</span> <span class="token string">&quot;1.0&quot;</span>
docs<span class="token punctuation">.</span>SwaggerInfo<span class="token punctuation">.</span>Host <span class="token operator">=</span> <span class="token string">&quot;localhost:8080&quot;</span>
docs<span class="token punctuation">.</span>SwaggerInfo<span class="token punctuation">.</span>BasePath <span class="token operator">=</span> <span class="token string">&quot;/api/v1&quot;</span>
docs<span class="token punctuation">.</span>SwaggerInfo<span class="token punctuation">.</span>Schemes <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">string</span><span class="token punctuation">{</span><span class="token string">&quot;http&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;https&quot;</span><span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>请组合以把导入的docs改一下，比如我初始化go项目的时候是：go mod init TodoList，那么我这里导入的docs</p><blockquote><div class="language-go line-numbers-mode" data-ext="go"><pre class="language-go"><code><span class="token keyword">import</span> <span class="token punctuation">(</span>
   <span class="token string">&quot;TodoList/conf&quot;</span>
   <span class="token string">&quot;TodoList/docs&quot;</span>
   <span class="token string">&quot;TodoList/routes&quot;</span>
<span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></blockquote><ol start="2"><li>在controller层写go doc的时候是函数的名字！</li></ol><div class="language-go line-numbers-mode" data-ext="go"><pre class="language-go"><code><span class="token comment">// UserRegister godoc</span>
<span class="token comment">// @Summary      用户注册</span>
<span class="token comment">// @Description  用户注册</span>
<span class="token comment">// @Tags         USER</span>
<span class="token comment">// @Accept       json</span>
<span class="token comment">// @Produce      json</span>
<span class="token comment">// @Param        data  body      service.UserService      true  &quot;用户名, 密码&quot;</span>
<span class="token comment">// @Success      200  {object}  serializer.ResponseUser  &quot;{&quot;status&quot;:200,&quot;data&quot;:{},&quot;msg&quot;:&quot;ok&quot;}&quot;</span>
<span class="token comment">// @Failure      500  {object}  serializer.ResponseUser  &quot;{&quot;status&quot;:500,&quot;data&quot;:{},&quot;Msg&quot;:{},&quot;Error&quot;:&quot;error&quot;}&quot;</span>
<span class="token comment">// @Router       /user/register [post]</span>
<span class="token keyword">func</span> <span class="token function">UserRegister</span><span class="token punctuation">(</span>c <span class="token operator">*</span>gin<span class="token punctuation">.</span>Context<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token operator">...</span><span class="token punctuation">.</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>然后后续测试就可以看到成功的标志，也可以继续学习完TodoList这个项目了：</p><figure><img src="/java-tips/assets/image-20220609140443914-4cb9d46e.webp" alt="image-20220609140443914" tabindex="0" loading="lazy"><figcaption>image-20220609140443914</figcaption></figure><h3 id="后记" tabindex="-1"><a class="header-anchor" href="#后记" aria-hidden="true">#</a> 后记</h3><p>一开始做这个项目的时候十分艰难，Java架构思想根深蒂固（一开始看到那个logger整个人都不好，又不会用依赖注入，又想用zap替代，最后搞来搞去还是回归到了原生logger），看到Gin这个架构满身的细胞都在抗拒，后面又做了几天又感觉自己又行了，整个过程像在做过山车一样！</p><h2 id="外传-项目实践-单例爬虫、协程并发爬虫" tabindex="-1"><a class="header-anchor" href="#外传-项目实践-单例爬虫、协程并发爬虫" aria-hidden="true">#</a> 外传：项目实践：单例爬虫、协程并发爬虫</h2><h3 id="使用说明" tabindex="-1"><a class="header-anchor" href="#使用说明" aria-hidden="true">#</a> 使用说明</h3><p>文件名称：Spiders</p><p>初始化mod</p><blockquote><p>go mod init xxx</p></blockquote><p>安装goquery库（仅微博使用）</p><h3 id="新浪微博" tabindex="-1"><a class="header-anchor" href="#新浪微博" aria-hidden="true">#</a> 新浪微博</h3><p>单例爬虫（需要cookie）</p><h3 id="美之图" tabindex="-1"><a class="header-anchor" href="#美之图" aria-hidden="true">#</a> 美之图</h3><p>高并发协程爬虫</p><h2 id="问题汇总" tabindex="-1"><a class="header-anchor" href="#问题汇总" aria-hidden="true">#</a> 问题汇总</h2><p><a href="https://blog.csdn.net/qq_26041727/article/details/121728316?spm=1001.2014.3001.5501" target="_blank" rel="noopener noreferrer">go语言/golang protobuf windows解决方案<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p></div><!----><footer class="page-meta"><div class="meta-item edit-link"><a href="https://github.com/zeanzai/java-tips/edit/main/demo/theme-docs/src/golang/learnInProblem.md" rel="noopener noreferrer" target="_blank" aria-label="在 GitHub 上编辑此页" class="nav-link label"><!--[--><svg xmlns="http://www.w3.org/2000/svg" class="icon edit-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="edit icon"><path d="M430.818 653.65a60.46 60.46 0 0 1-50.96-93.281l71.69-114.012 7.773-10.365L816.038 80.138A60.46 60.46 0 0 1 859.225 62a60.46 60.46 0 0 1 43.186 18.138l43.186 43.186a60.46 60.46 0 0 1 0 86.373L588.879 565.55l-8.637 8.637-117.466 68.234a60.46 60.46 0 0 1-31.958 11.229z"></path><path d="M728.802 962H252.891A190.883 190.883 0 0 1 62.008 771.98V296.934a190.883 190.883 0 0 1 190.883-192.61h267.754a60.46 60.46 0 0 1 0 120.92H252.891a69.962 69.962 0 0 0-69.098 69.099V771.98a69.962 69.962 0 0 0 69.098 69.098h475.911A69.962 69.962 0 0 0 797.9 771.98V503.363a60.46 60.46 0 1 1 120.922 0V771.98A190.883 190.883 0 0 1 728.802 962z"></path></svg><!--]-->在 GitHub 上编辑此页<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!----></a></div><div class="meta-item git-info"><div class="update-time"><span class="label">上次编辑于: </span><!----></div><div class="contributors"><span class="label">贡献者: </span><!--[--><!--[--><span class="contributor" title="email: zeanzai.me@gmail.com">zeanzai</span><!--]--><!--]--></div></div></footer><nav class="page-nav"><!----><a href="/java-tips/golang/eightPart.html" class="nav-link next" aria-label="Golang八股文收集"><div class="hint">下一页<span class="arrow end"></span></div><div class="link">Golang八股文收集<!----></div></a></nav><!----><!----><!--]--></main><!--]--><footer class="footer-wrapper"><div class="footer">浪漫骑士的二流键盘</div><div class="copyright">Copyright © 2024 zeanzai</div></footer></div><!--]--><!----><!----><!----><!--]--></div>
    <script type="module" src="/java-tips/assets/app-cd152169.js" defer></script>
  </body>
</html>
